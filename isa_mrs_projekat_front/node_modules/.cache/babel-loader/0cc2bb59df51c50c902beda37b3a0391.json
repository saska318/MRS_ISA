{"ast":null,"code":"import { FontAwesomeIcon } from \"@fortawesome/vue-fontawesome\";\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\nimport { faPlus, faMinus, faX, faPlusCircle, faHouse } from \"@fortawesome/free-solid-svg-icons\";\nimport axios from \"axios\";\nimport { toggleLoading, toggleProcessing } from \"@/components/state\";\nimport store from \"@/store\";\nlibrary.add(faPlus, faMinus, faX, faPlusCircle, faHouse);\nexport default {\n  name: \"AdventureCreationPage\",\n  components: {\n    FontAwesomeIcon\n  },\n\n  data() {\n    return {\n      vacationRental: {\n        id: null,\n        name: null,\n        description: null,\n        capacity: null,\n        price: null,\n        additionalServices: [],\n        conductRules: [],\n        cancellationFee: null,\n        address: {\n          country: null,\n          city: null,\n          street: null,\n          number: null,\n          longitude: null,\n          latitude: null\n        },\n        rooms: []\n      },\n      photo: null,\n      primaryPhotos: [],\n      photos: [],\n      imageUrls: [],\n      bedPerRoom: {\n        bed: \"\"\n      },\n      additionalService: \"\",\n      additionalServicePrice: null,\n      ruleType: \"Do\",\n      ruleText: \"\",\n      ruleIsValid: true,\n      ruleAlreadyExists: false,\n      serviceAlreadyExists: false,\n      nameIsEntered: true,\n      descriptionIsEntered: true,\n      countryIsEntered: true,\n      cityIsEntered: true,\n      streetIsEntered: true,\n      numberIsEntered: true,\n      priceIsEntered: true,\n      capacityIsEntered: true,\n      cancellationFeeIsEntered: true,\n      photoIsEntered: true,\n      addressIsValid: true\n    };\n  },\n\n  mounted() {\n    toggleLoading();\n\n    if (this.$route.params.id !== undefined) {\n      axios.get(\"/RentalObjects/getVacationRentalOwner\", {\n        headers: {\n          Authorization: \"Bearer \" + store.getters.access_token\n        },\n        params: {\n          id: this.$route.params.id\n        }\n      }).then(response => {\n        let vacationRental = response.data;\n        this.vacationRental.name = vacationRental.name;\n        this.vacationRental.description = vacationRental.description;\n        this.vacationRental.address = vacationRental.address;\n        this.vacationRental.price = vacationRental.price;\n        this.vacationRental.capacity = vacationRental.capacity;\n        this.vacationRental.additionalServices = vacationRental.additionalServices;\n        this.vacationRental.conductRules = vacationRental.conductRules;\n        this.vacationRental.cancellationFee = vacationRental.cancellationFee;\n        vacationRental.photos.forEach(photo => {\n          this.photos.push(photo.photo);\n          this.primaryPhotos.push(photo.photo);\n          this.loadImage(photo.photo, this.photos.indexOf(photo.photo));\n        });\n        this.vacationRental.id = vacationRental.id;\n        toggleLoading();\n      }).catch(() => {\n        this.$notify({\n          title: \"Server error\",\n          text: \"Server is currently off. Please try again later...\",\n          type: \"error\"\n        });\n        toggleLoading();\n      });\n    } else {\n      toggleLoading();\n    }\n  },\n\n  computed: {\n    rulesOfConduct() {\n      let pairsOfRules = [];\n      let positiveRules = this.positiveRules(this.vacationRental.conductRules);\n      let negativeRules = this.negativeRules(this.vacationRental.conductRules);\n      let size = Math.max(positiveRules.length, negativeRules.length);\n\n      for (let i = 0; i < size; i++) {\n        pairsOfRules.push({\n          \"Do\": i + 1 <= positiveRules.length ? positiveRules[i] : \"\",\n          \"DoNot\": i + 1 <= negativeRules.length ? negativeRules[i] : \"\"\n        });\n      }\n\n      return pairsOfRules;\n    },\n\n    isNameEntered() {\n      return Boolean(this.vacationRental.name);\n    },\n\n    isDescriptionEntered() {\n      return Boolean(this.vacationRental.description);\n    },\n\n    isCountryEntered() {\n      return Boolean(this.vacationRental.address.country);\n    },\n\n    isCityEntered() {\n      return Boolean(this.vacationRental.address.city);\n    },\n\n    isStreetEntered() {\n      return Boolean(this.vacationRental.address.street);\n    },\n\n    isNumberEntered() {\n      return Boolean(this.vacationRental.address.number);\n    },\n\n    isPriceEntered() {\n      return Boolean(this.vacationRental.price);\n    },\n\n    isCapacityEntered() {\n      return Boolean(this.vacationRental.capacity);\n    },\n\n    isCancellationFeeEntered() {\n      return Boolean(this.vacationRental.cancellationFee);\n    },\n\n    isPhotoEntered() {\n      return this.photos.length > 0;\n    }\n\n  },\n  methods: {\n    submit() {\n      if (this.isDataEntered()) {\n        this.isDataCorrect();\n      }\n    },\n\n    makeRequest() {\n      let vacationRental = this.vacationRental;\n      axios.post(\"/RentalObjects/addVacationRental\", vacationRental, {\n        headers: {\n          Authorization: \"Bearer \" + this.$store.getters.access_token\n        }\n      }).then(vacationRental => {\n        for (let i = 0; i < this.photos.length; i++) {\n          let formData = new FormData();\n          formData.append(\"file\", this.photos[i]);\n          axios.post(\"/Photos/upload\", formData, {\n            headers: {\n              Authorization: \"Bearer \" + this.$store.getters.access_token,\n              \"Content-type\": \"multipart/form-data\"\n            }\n          }).then(response => {\n            let body = {\n              id: vacationRental.data.id,\n              photos: [response.data]\n            };\n            console.log(body);\n            axios.post(\"/RentalObjects/connectPhotosToVacationRental\", body, {\n              headers: {\n                Authorization: \"Bearer \" + this.$store.getters.access_token\n              }\n            }).then(() => {\n              this.$notify({\n                title: \"Successful adding\",\n                text: \"You have successfully added a new vacation rental.\",\n                position: \"bottom right\",\n                type: \"success\"\n              });\n            });\n          });\n        }\n\n        toggleProcessing();\n      }).catch(error => {\n        if (!error.response) {\n          this.$notify({\n            title: \"Server error\",\n            text: \"Server is currently off. Please try again later...\",\n            type: \"error\"\n          });\n        } else if (error.response.status === 500) {\n          this.$notify({\n            title: \"Internal Server Error\",\n            text: \"Something went wrong on the server! Please try again later...\",\n            position: \"bottom right\",\n            type: \"error\"\n          });\n        }\n\n        toggleProcessing();\n      });\n    },\n\n    updateVacationRental() {\n      let vacationRental = this.vacationRental;\n      axios.put(\"/RentalObjects/updateVacationRental\", vacationRental, {\n        headers: {\n          Authorization: \"Bearer \" + this.$store.getters.access_token\n        }\n      }).then(id => {\n        for (let i = 0; i < this.photos.length; i++) {\n          if (!this.photoExisted(this.photos[i])) {\n            let formData = new formData();\n            formData.append(\"file\", this.photos[i]);\n            axios.post(\"/Photos/upload\", formData, {\n              headers: {\n                Authorization: \"Bearer \" + this.$store.getters.access_token,\n                \"Content-type\": \"multipart/form-data\"\n              }\n            }).then(response => {\n              let body = {\n                id: id.data,\n                photos: [response.data]\n              };\n              axios.post(\"/RentalObjects/connectPhotosToVacationRental\", body, {\n                headers: {\n                  Authorization: \"Bearer \" + this.$store.getters.access_token\n                }\n              }).then(() => {\n                this.$notify({\n                  title: \"Successful update\",\n                  text: \"You have successfully updated the vacation rental.\",\n                  position: \"bottom right\",\n                  type: \"success\"\n                });\n              });\n            });\n          }\n        }\n\n        toggleProcessing();\n      }).catch(error => {\n        if (!error.response) {\n          this.$notify({\n            title: \"Server error\",\n            text: \"Server is currently off. Please try again later...\",\n            type: \"error\"\n          });\n        } else if (error.response.status === 500) {\n          this.$notify({\n            title: \"Internal Server Error\",\n            text: \"Something went wrong on the server! Please try again later...\",\n            position: \"bottom right\",\n            type: \"error\"\n          });\n        }\n\n        toggleProcessing();\n      });\n    },\n\n    isDataEntered() {\n      if (!this.isNameEntered) {\n        this.nameIsEntered = false;\n        return false;\n      }\n\n      if (!this.isDescriptionEntered) {\n        this.descriptionIsEntered = false;\n        return false;\n      }\n\n      if (!this.isCountryEntered) {\n        this.countryIsEntered = false;\n        return false;\n      }\n\n      if (!this.isCityEntered) {\n        this.cityIsEntered = false;\n        return false;\n      }\n\n      if (!this.isStreetEntered) {\n        this.streetIsEntered = false;\n        return false;\n      }\n\n      if (!this.isNumberEntered) {\n        this.numberIsEntered = false;\n        return false;\n      }\n\n      if (!this.isPriceEntered) {\n        this.priceIsEntered = false;\n        return false;\n      }\n\n      if (!this.isCapacityEntered) {\n        this.capacityIsEntered = false;\n        return false;\n      }\n\n      if (!this.isCancellationFeeEntered) {\n        this.cancellationFeeIsEntered = false;\n        return false;\n      }\n\n      if (!this.isPhotoEntered) {\n        this.photoIsEntered = false;\n        return false;\n      }\n\n      return true;\n    },\n\n    async isDataCorrect() {\n      this.addressIsValid = false;\n      this.validateAddress();\n    },\n\n    loadImage(name, index) {\n      axios.get(\"/Photos/\", {\n        headers: {\n          Authorization: \"Bearer \" + this.$store.getters.access_token\n        },\n        params: {\n          path: name\n        },\n        responseType: \"blob\"\n      }).then(response => {\n        this.imageUrls[index] = URL.createObjectURL(response.data);\n      }).catch(error => {\n        console.log(error);\n      });\n    },\n\n    validateAddress() {\n      const apiKey = 'VrDrl5BjEA0Whvb-chHbFz96HV4qlCXB-yoiTRRLKno';\n      const url = 'https://geocoder.ls.hereapi.com/6.2/geocode.json' + '?apiKey=' + apiKey + '&housenumber=' + this.vacationRental.address.number + '&street=' + this.vacationRental.address.street + '&city=' + this.vacationRental.address.city + '&country=' + this.vacationRental.address.country;\n      fetch(url).then(response => response.json()).then(data => {\n        const responseView = data.Response.View;\n\n        if (responseView.length === 0) {\n          this.addressIsValid = false;\n        } else {\n          const location = responseView[0].Result[0].Location.DisplayPosition;\n          const address = responseView[0].Result[0].Location.Address;\n          this.vacationRental.address.city = this.transliterate(address.City);\n          this.vacationRental.address.country = this.transliterate(address.AdditionalData[0].value);\n          this.vacationRental.address.street = this.transliterate(address.Street);\n          this.vacationRental.address.longitude = location.Longitude;\n          this.vacationRental.address.latitude = location.Latitude;\n          this.addressIsValid = true;\n\n          if (this.vacationRental.id === null) {\n            this.makeRequest();\n          } else {\n            this.updateVacationRental();\n          }\n        }\n      }).catch(() => {\n        this.addressIsValid = false;\n      });\n    },\n\n    transliterate(word) {\n      let letters = {\n        \"Б\": \"B\",\n        \"В\": \"V\",\n        \"Г\": \"G\",\n        \"Д\": \"D\",\n        \"Ђ\": \"Đ\",\n        \"Ж\": \"Ž\",\n        \"З\": \"Z\",\n        \"И\": \"I\",\n        \"К\": \"K\",\n        \"Л\": \"L\",\n        \"Љ\": \"Lj\",\n        \"М\": \"M\",\n        \"Н\": \"N\",\n        \"Њ\": \"Nj\",\n        \"П\": \"P\",\n        \"Р\": \"R\",\n        \"С\": \"S\",\n        \"Ћ\": \"Ć\",\n        \"У\": \"U\",\n        \"Ф\": \"F\",\n        \"Х\": \"H\",\n        \"Ц\": \"C\",\n        \"Ч\": \"Č\",\n        \"Џ\": \"Dž\",\n        \"Ш\": \"Š\",\n        \"б\": \"b\",\n        \"в\": \"v\",\n        \"г\": \"g\",\n        \"д\": \"d\",\n        \"ђ\": \"đ\",\n        \"ж\": \"ž\",\n        \"з\": \"z\",\n        \"и\": \"i\",\n        \"к\": \"k\",\n        \"л\": \"l\",\n        \"љ\": \"lj\",\n        \"м\": \"m\",\n        \"н\": \"n\",\n        \"њ\": \"nj\",\n        \"п\": \"p\",\n        \"р\": \"r\",\n        \"с\": \"s\",\n        \"т\": \"t\",\n        \"ћ\": \"ć\",\n        \"у\": \"u\",\n        \"ф\": \"f\",\n        \"х\": \"h\",\n        \"ц\": \"c\",\n        \"ч\": \"č\",\n        \"џ\": \"dž\",\n        \"ш\": \"š\"\n      };\n      return word.split('').map(function (char) {\n        return letters[char] || char;\n      }).join(\"\");\n    },\n\n    addPhoto(e) {\n      e.target.files.forEach(photo => {\n        this.photos.push(photo);\n        this.imageUrls.push(URL.createObjectURL(photo));\n        this.photoIsEntered = true;\n      });\n    },\n\n    removePhoto(index) {\n      this.photos.splice(index, 1);\n      this.imageUrls.splice(index, 1);\n    },\n\n    addRoom() {\n      if (this.bedPerRoom.bed.trim() !== \"\") {\n        if (this.vacationRental.rooms.indexOf(this.bedPerRoom.bed.trim()) === -1) {\n          this.vacationRental.rooms.push(this.bedPerRoom);\n          this.bedPerRoom = {\n            bed: \"\"\n          };\n        }\n      }\n    },\n\n    removeRoom(bedPerRoom) {\n      this.vacationRental.rooms.splice(this.vacationRental.rooms.indexOf(bedPerRoom), 1);\n    },\n\n    addService() {\n      if (this.additionalService.trim() !== \"\") {\n        let newService = {};\n        newService[\"name\"] = this.additionalService.trim();\n        newService[\"price\"] = this.additionalServicePrice === null ? 0 : this.additionalServicePrice;\n\n        if (this.vacationRental.additionalServices.indexOf(newService) === -1) {\n          this.vacationRental.additionalServices.push(newService);\n          this.additionalService = \"\";\n          this.additionalServicePrice = null;\n          this.serviceAlreadyExists = false;\n        } else {\n          this.serviceAlreadyExists = true;\n        }\n      }\n    },\n\n    removeService(service) {\n      this.vacationRental.additionalServices.splice(this.vacationRental.additionalServices.indexOf(service), 1);\n    },\n\n    addRule() {\n      if (this.ruleText.trim() !== \"\" && this.ruleType.trim() !== \"\") {\n        if (!this.ruleExists(this.ruleText.trim())) {\n          let newRule = {};\n          newRule[\"type\"] = this.ruleType;\n          newRule[\"rule\"] = this.ruleText;\n          this.vacationRental.conductRules.push(newRule);\n          this.ruleType = \"\";\n          this.ruleText = \"\";\n          this.ruleIsValid = true;\n          this.ruleAlreadyExists = false;\n        } else {\n          this.ruleAlreadyExists = true;\n        }\n      } else {\n        this.ruleIsValid = false;\n      }\n    },\n\n    removeRule(rule) {\n      this.vacationRental.conductRules.splice(this.getRuleIndex(rule), 1);\n    },\n\n    getRuleIndex(rule) {\n      let index = -1;\n      this.vacationRental.conductRules.forEach(conductRule => {\n        if (conductRule.rule === rule) {\n          index = this.vacationRental.conductRules.indexOf(conductRule);\n        }\n      });\n      return index;\n    },\n\n    positiveRules(rulesOfConduct) {\n      let positiveRules = [];\n      rulesOfConduct.forEach(rule => {\n        if (rule.type === \"Do\") {\n          positiveRules.push(rule.rule);\n        }\n      });\n      return positiveRules;\n    },\n\n    negativeRules(rulesOfConduct) {\n      let negativeRules = [];\n      rulesOfConduct.forEach(rule => {\n        if (rule.type === \"DoNot\") {\n          negativeRules.push(rule.rule);\n        }\n      });\n      return negativeRules;\n    },\n\n    ruleExists(rule) {\n      return this.getRuleIndex(rule) !== -1;\n    },\n\n    photoExisted(photo) {\n      for (let i = 0; i < this.primaryPhotos.length; i++) {\n        if (this.primaryPhotos[i] === photo) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["FontAwesomeIcon","library","faPlus","faMinus","faX","faPlusCircle","faHouse","axios","toggleLoading","toggleProcessing","store","add","name","components","data","vacationRental","id","description","capacity","price","additionalServices","conductRules","cancellationFee","address","country","city","street","number","longitude","latitude","rooms","photo","primaryPhotos","photos","imageUrls","bedPerRoom","bed","additionalService","additionalServicePrice","ruleType","ruleText","ruleIsValid","ruleAlreadyExists","serviceAlreadyExists","nameIsEntered","descriptionIsEntered","countryIsEntered","cityIsEntered","streetIsEntered","numberIsEntered","priceIsEntered","capacityIsEntered","cancellationFeeIsEntered","photoIsEntered","addressIsValid","mounted","$route","params","undefined","get","headers","Authorization","getters","access_token","then","response","forEach","push","loadImage","indexOf","catch","$notify","title","text","type","computed","rulesOfConduct","pairsOfRules","positiveRules","negativeRules","size","Math","max","length","i","isNameEntered","Boolean","isDescriptionEntered","isCountryEntered","isCityEntered","isStreetEntered","isNumberEntered","isPriceEntered","isCapacityEntered","isCancellationFeeEntered","isPhotoEntered","methods","submit","isDataEntered","isDataCorrect","makeRequest","post","$store","formData","FormData","append","body","console","log","position","error","status","updateVacationRental","put","photoExisted","validateAddress","index","path","responseType","URL","createObjectURL","apiKey","url","fetch","json","responseView","Response","View","location","Result","Location","DisplayPosition","Address","transliterate","City","AdditionalData","value","Street","Longitude","Latitude","word","letters","split","map","char","join","addPhoto","e","target","files","removePhoto","splice","addRoom","trim","removeRoom","addService","newService","removeService","service","addRule","ruleExists","newRule","removeRule","rule","getRuleIndex","conductRule"],"sourceRoot":"","sources":["C:\\Users\\Saška\\Downloads\\MRS_ISA\\isa_mrs_projekat_front\\src\\components\\VacationRentalOwner\\VacationRentalOwnerPage\\components\\VacationRentalAdditionForm.vue"],"sourcesContent":["<template>\r\n  <div class=\"row\" :key=\"vacationRental.id\">\r\n    <div class=\"col-12 pt-5 mb-5\">\r\n      <div class=\"container px-4 py-3 rounded form\" spellcheck=\"false\" >\r\n        <div class=\"container-fluid\">\r\n          <h3 v-if=\"vacationRental.id === null\">\r\n            <font-awesome-icon class=\"me-1\" icon=\"house\"></font-awesome-icon>\r\n            New Vacation Rental\r\n          </h3>\r\n          <h3 v-else>\r\n            <font-awesome-icon class=\"me-1\" icon=\"house\"></font-awesome-icon>\r\n            Edit Vacation Rental\r\n          </h3>\r\n          <div class=\"row main justify-content-center\">\r\n            <div class=\"row main\">\r\n              <div class=\"col main\">\r\n                <div class=\"row main\">\r\n                  <div class=\"col-1\"></div>\r\n                  <div class=\"col-10\">\r\n\r\n                    <div class=\"row justify-content-center\">\r\n                      <div class=\"row justify-content-center\">\r\n                        <label for=\"name\">Name</label>\r\n                      </div>\r\n                      <input class=\"form-control\" v-model=\"vacationRental.name\" type=\"text\" id=\"name\" placeholder=\"E.g. Vacation rental\" @input=\"nameIsEntered=true\">\r\n                      <p v-if='!nameIsEntered'>'Name' is a mandatory field.</p>\r\n                    </div>\r\n                    <div class=\"row justify-content-center\">\r\n                      <div class=\"row justify-content-center\">\r\n                        <label for=\"description\">Description</label>\r\n                      </div>\r\n                      <textarea  class=\"form-control\" v-model=\"vacationRental.description\" rows=\"10\" maxlength=\"500\" placeholder=\"Please describe why you want to join our community in 50-500 characters.\" id=\"description\" @input=\"descriptionIsEntered=true\"></textarea>\r\n                      <p v-if='!descriptionIsEntered'>'Description' is a mandatory field.</p>\r\n                    </div>\r\n\r\n                    <div class=\"row mt-4 justify-content-center\">\r\n                      <div class=\"row justify-content-center\">\r\n                        <label for=\"country\">Country</label>\r\n                      </div>\r\n                      <input  v-model=\"vacationRental.address.country\" class=\"form-control\" type=\"text\" id=\"country\" placeholder=\"Country\" @input=\"countryIsEntered=true\">\r\n                      <p v-if='!countryIsEntered'>'Country' is a mandatory field.</p>\r\n                      <p v-if='!addressIsValid'>Invalid address data.</p>\r\n                    </div>\r\n                    <div class=\"row justify-content-center\">\r\n                      <div class=\"row justify-content-center\">\r\n                        <label for=\"city\">City</label>\r\n                      </div>\r\n                      <input v-model=\"vacationRental.address.city\" class=\"form-control\" type=\"text\" id=\"city\" placeholder=\"City\" @input=\"cityIsEntered=true\">\r\n                      <p v-if='!cityIsEntered'>'City' is a mandatory field.</p>\r\n                      <p v-if='!addressIsValid'>Invalid address data.</p>\r\n                    </div>\r\n                    <div class=\"row justify-content-center\">\r\n                      <div class=\"row justify-content-center\">\r\n                        <label for=\"street\">Street</label>\r\n                      </div>\r\n                      <input v-model=\"vacationRental.address.street\" class=\"form-control\" type=\"text\" id=\"street\" placeholder=\"Street\" @input=\"streetIsEntered=true\">\r\n                      <p v-if='!streetIsEntered'>'Street' is a mandatory field.</p>\r\n                      <p v-if='!addressIsValid'>Invalid address data.</p>\r\n                    </div>\r\n                    <div class=\"row justify-content-center\">\r\n                      <div class=\"row justify-content-center\">\r\n                        <label for=\"number\">Number</label>\r\n                      </div>\r\n                      <input v-model=\"vacationRental.address.number\" class=\"form-control\"  type=\"number\" min=\"1\" id=\"number\" placeholder=\"House Number\" @input=\"numberIsEntered=true\">\r\n                      <p v-if='!numberIsEntered'>'Number' is a mandatory field.</p>\r\n                      <p v-if='!addressIsValid'>Invalid address data.</p>\r\n                    </div>\r\n\r\n                    <div class=\"row justify-content-center\">\r\n                      <div class=\"row justify-content-center\">\r\n                        <label for=\"price\">Price</label>\r\n                      </div>\r\n                      <input v-model=\"vacationRental.price\" type=\"number\" step=\"any\" min=\"0\"  id=\"price\" class=\"form-control\" placeholder=\"Price in $\" @input=\"priceIsEntered=true\">\r\n                      <p v-if='!priceIsEntered'>'Price' is a mandatory field.</p>\r\n                    </div>\r\n                    <div class=\"row justify-content-center\">\r\n                      <div class=\"row justify-content-center\">\r\n                        <label for=\"capacity\">Capacity</label>\r\n                      </div>\r\n                      <input v-model=\"vacationRental.capacity\" type=\"number\" step=\"any\" min=\"0\"  id=\"capacity\" class=\"form-control\" placeholder=\"Max people\" @input=\"capacityIsEntered=true\">\r\n                      <p v-if='!capacityIsEntered'>'Capacity' is a mandatory field.</p>\r\n                    </div>\r\n                    <div class=\"row justify-content-center\">\r\n                      <div class=\"row justify-content-center\">\r\n                        <label for=\"cancellation\">Cancellation fee</label>\r\n                      </div>\r\n                      <input v-model=\"vacationRental.cancellationFee\" type=\"number\" step=\"any\" min=\"0\" max=\"100\"  id=\"cancellation\" class=\"form-control\" placeholder=\"Cancellation fee in %\" @input=\"cancellationFeeIsEntered=true\">\r\n                      <p v-if='!cancellationFeeIsEntered'>'Cancellation fee' is a mandatory field.</p>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"col-1\"></div>\r\n                </div>\r\n              </div>\r\n              <div class=\"col main\">\r\n                <div class=\"row main\">\r\n                  <div class=\"col-1\"></div>\r\n                  <div class=\"col-10\">\r\n\r\n                    <div class=\"row justify-content-center\">\r\n                      <div class=\"row justify-content-center\">\r\n                        <label for=\"equipment\">Beds per room</label>\r\n                      </div>\r\n                      <input class=\"form-control\" v-model=\"bedPerRoom.bed\" type=\"text\" id=\"equipment\" placeholder=\"E.g. 3\" @keyup.enter=\"addRoom\">\r\n                      <div class=\"row justify-content-center\">\r\n                        <small class=\"form-text text-muted\">\r\n                          Press Enter to add room\r\n                        </small>\r\n                      </div>\r\n                      <div class=\"row tag-container\">\r\n                        <div class=\"equipment-tag rounded-pill mt-1 ms-1 p-1\" v-for=\"(bedsPerRoom, index) in vacationRental.rooms\" :key=\"index\">\r\n                          {{bedsPerRoom.bed}}\r\n                          <button class=\"tag-button text-center\" @click=\"removeRoom(bedsPerRoom)\"><font-awesome-icon icon=\"x\" style=\"width: 9px; height: 9px\"></font-awesome-icon></button>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div class=\"row mt-4 justify-content-center\">\r\n                      <div class=\"justify-content-center p-0\" style=\"max-width: 400px;\">\r\n                        <div class=\"d-flex d-inline-flex justify-content-between p-0 w-100\">\r\n                          <label for=\"additionalServices\" class=\"ms-3\">Additional Services</label>\r\n                          <div class=\"dropdown\">\r\n                            <button class=\"btn dropdown\" type=\"button\" id=\"servicesDropdown\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\r\n                              <font-awesome-icon icon=\"plus\"></font-awesome-icon>\r\n                            </button>\r\n                            <form class=\"dropdown-menu dropdown-menu-end form p-4 m-0\" aria-labelledby=\"servicesDropdown\">\r\n                              <h4>New Service</h4>\r\n                              <label for=\"service\" class=\"ms-2\">Name</label>\r\n                              <input v-model=\"additionalService\" class=\"form-control m-0\" type=\"text\" placeholder=\"E.g. Spa\" id=\"service\">\r\n                              <label for=\"servicePrice\" class=\"ms-2\">Price</label>\r\n                              <input v-model=\"additionalServicePrice\" type=\"number\" step=\"any\" min=\"0\"  id=\"servicePrice\" class=\"form-control\" placeholder=\"Price in $\">\r\n                              <div class=\"text-center\">\r\n                                <button class=\"btn mt-2\" type=\"button\" @click.prevent=\"addService\">Add</button>\r\n                              </div>\r\n                            </form>\r\n                          </div>\r\n                        </div>\r\n                        <div class=\"row tag-container\" id=\"additionalServices\">\r\n                          <p v-if='serviceAlreadyExists'>Additional service already exists.</p>\r\n                          <div class=\"equipment-tag rounded-pill mt-1 ms-1 p-1\" v-for=\"(additionalService, index) in vacationRental.additionalServices\" :key=\"index\">\r\n                            {{additionalService.name + \" \" + (additionalService.price===null?\"Free\":additionalService.price + \"$\")}}\r\n                            <button class=\"tag-button text-center\" @click=\"removeService(additionalService)\"><font-awesome-icon icon=\"x\" style=\"width: 9px; height: 9px\"></font-awesome-icon></button>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div class=\"row mt-4 justify-content-center\">\r\n                      <div class=\"justify-content-center p-0\" style=\"max-width: 400px;\">\r\n                        <div class=\"d-flex d-inline-flex justify-content-between p-0 w-100\">\r\n                          <label for=\"rulesTable\" class=\"ms-3\">Rules of Conduct</label>\r\n                          <div class=\"dropdown\">\r\n                            <button class=\"btn dropdown\" type=\"button\" id=\"rulesDropdown\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\r\n                              <font-awesome-icon icon=\"plus\"></font-awesome-icon>\r\n                            </button>\r\n                            <form class=\"dropdown-menu dropdown-menu-end form p-4 m-0\" aria-labelledby=\"rulesDropdown\">\r\n                              <h4>New Rule</h4>\r\n                              <label for=\"conductRule\" class=\"ms-2\">Rule</label>\r\n                              <input v-model=\"ruleText\" class=\"form-control m-0\" type=\"text\" id=\"conductRule\">\r\n                              <label for=\"ruleType\" class=\"ms-2\">Rule Type</label>\r\n                              <select v-model=\"ruleType\" class=\"form-control m-0\" id=\"ruleType\">\r\n                                <option value=\"Do\">Do</option>\r\n                                <option value=\"DoNot\" selected=\"selected\">Don't</option>\r\n                              </select>\r\n                              <div class=\"text-center\">\r\n                                <button class=\"btn mt-2\" type=\"button\" @click.prevent=\"addRule\">Add</button>\r\n                              </div>\r\n                            </form>\r\n                          </div>\r\n                        </div>\r\n                        <div class=\" row justify-content-center p-0\">\r\n                          <p v-if='ruleAlreadyExists'>Rule already exists.</p>\r\n                          <table class=\"mt-1 tag-container\" id=\"rulesTable\" style=\"max-width: 400px\">\r\n                            <thead v-if=\"rulesOfConduct.length > 0\" style=\"background-color: transparent\">\r\n                            <tr>\r\n                              <th style=\"background-color: #008970; color: #f7f7f2; ; border-bottom: #008970 1px solid\">Do</th>\r\n                              <th style=\"background-color: #e23c52; color: #f7f7f2; border-left: #008970 1px solid; border-bottom: #e23c52 1px solid\">Don't</th>\r\n                            </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                            <tr v-for=\"(rule, index) in rulesOfConduct\" :key=\"index\" :class=\"index%2!==0?'odd':'even'\">\r\n                              <td style=\"border-right: #008970 1px solid;word-wrap: break-word;\">\r\n                                <div class=\"d-flex d-inline-flex justify-content-between p-0\">\r\n                                  <div>{{rule.Do}}</div><button v-if=\"rule.Do\" class=\"button\" style=\"border: none; background-color: transparent; color: #e23c52\" @click=\"removeRule(rule.Do)\"><font-awesome-icon icon=\"minus\"></font-awesome-icon></button>\r\n                                </div>\r\n                              </td>\r\n                              <td style=\"word-wrap: break-word;\">\r\n                                <div class=\"d-flex d-inline-flex justify-content-between p-0\">\r\n                                  <div>{{rule.DoNot}}</div><button v-if=\"rule.DoNot\" class=\"button\" style=\"border: none; background-color: transparent; color: #e23c52\" @click=\"removeRule(rule.DoNot)\"><font-awesome-icon icon=\"minus\"></font-awesome-icon></button>                            </div>\r\n                              </td>\r\n                            </tr>\r\n                            </tbody>\r\n                          </table>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div class=\"row justify-content-center mt-4\">\r\n                      <div class=\"row justify-content-center\">\r\n                        <label for=\"imageInput\">Images</label>\r\n                        <p v-if='!photoIsEntered'>One image is mandatory.</p>\r\n                      </div>\r\n                      <div class=\"row p-0 justify-content-center\" id=\"imageInput\" style=\"max-width: 400px;min-width: 120px\">\r\n                        <label class=\"imageUploadLabel text-center rounded m-1\" style=\"background-color:white;display: table;width: 180px;height: 100px;border: 1px solid #008970;cursor: pointer\">\r\n                          <span style=\"display:table-cell; vertical-align: middle\">\r\n                            <font-awesome-icon class=\"rounded-circle\" icon=\"plus-circle\" style=\"color: #008970; background-color: transparent;height: 50px\"></font-awesome-icon>\r\n                            <input class=\"upload-button\" multiple type=\"file\" accept=\"image/jpeg\" ref=\"photo\" @change=\"addPhoto\">\r\n                          </span>\r\n                        </label>\r\n                        <div v-for=\"(url, index) in imageUrls\" class=\"m-1 rounded\" :key=\"index\" style=\"width:180px;height:100px;border: 1px solid #008970;background-color: lightgray;position: relative;text-align: center\">\r\n                          <img :src=\"url\" alt=\"\" style=\"width:100%; height:100%; object-fit: contain;\">\r\n                          <button style=\"background-color: transparent;color: #e23c52;border:none;position: absolute;top: 0;right: 0;cursor: pointer\" @click=\"removePhoto(index)\"><font-awesome-icon icon=\"x\"></font-awesome-icon></button>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div class=\"col-1\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"d-flex pt-3 justify-content-center\">\r\n            <router-link to=\"/vacationRentalOwner/cottages\" class=\"btn btn-red mt-3 me-1\">Cancel</router-link>\r\n            <button type=\"button\" class=\"btn mt-3\" @click=\"submit\">Submit</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"col-2\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {FontAwesomeIcon} from \"@fortawesome/vue-fontawesome\";\r\nimport {library} from \"@fortawesome/fontawesome-svg-core\";\r\nimport {faPlus, faMinus, faX, faPlusCircle, faHouse} from \"@fortawesome/free-solid-svg-icons\";\r\nimport axios from \"axios\";\r\nimport {toggleLoading, toggleProcessing} from \"@/components/state\";\r\nimport store from \"@/store\";\r\n\r\nlibrary.add(faPlus, faMinus, faX, faPlusCircle, faHouse);\r\n\r\nexport default {\r\n  name: \"AdventureCreationPage\",\r\n  components: {FontAwesomeIcon},\r\n  data() {\r\n    return {\r\n      vacationRental: {\r\n        id: null,\r\n        name: null,\r\n        description: null,\r\n        capacity: null,\r\n        price: null,\r\n        additionalServices: [],\r\n        conductRules: [],\r\n        cancellationFee: null,\r\n        address: {\r\n          country: null,\r\n          city: null,\r\n          street: null,\r\n          number: null,\r\n          longitude: null,\r\n          latitude: null\r\n        },\r\n        rooms: [],\r\n      },\r\n      photo: null,\r\n      primaryPhotos: [],\r\n      photos: [],\r\n      imageUrls: [],\r\n      bedPerRoom: {bed: \"\"},\r\n      additionalService: \"\",\r\n      additionalServicePrice: null,\r\n      ruleType: \"Do\",\r\n      ruleText: \"\",\r\n      ruleIsValid: true,\r\n      ruleAlreadyExists: false,\r\n      serviceAlreadyExists: false,\r\n      nameIsEntered: true,\r\n      descriptionIsEntered: true,\r\n      countryIsEntered: true,\r\n      cityIsEntered: true,\r\n      streetIsEntered: true,\r\n      numberIsEntered: true,\r\n      priceIsEntered: true,\r\n      capacityIsEntered: true,\r\n      cancellationFeeIsEntered: true,\r\n      photoIsEntered: true,\r\n      addressIsValid: true\r\n    }\r\n  },\r\n  mounted(){\r\n    toggleLoading();\r\n    if(this.$route.params.id !== undefined){\r\n      axios.get(\"/RentalObjects/getVacationRentalOwner\",{\r\n        headers:{\r\n          Authorization: \"Bearer \" + store.getters.access_token,\r\n        },\r\n        params: {\r\n          id: this.$route.params.id\r\n        }\r\n      })\r\n      .then((response) => {\r\n        let vacationRental = response.data;\r\n        this.vacationRental.name = vacationRental.name;\r\n        this.vacationRental.description = vacationRental.description;\r\n        this.vacationRental.address = vacationRental.address;\r\n        this.vacationRental.price = vacationRental.price;\r\n        this.vacationRental.capacity = vacationRental.capacity;\r\n        this.vacationRental.additionalServices = vacationRental.additionalServices;\r\n        this.vacationRental.conductRules = vacationRental.conductRules;\r\n        this.vacationRental.cancellationFee = vacationRental.cancellationFee;\r\n        vacationRental.photos.forEach(photo => {\r\n          this.photos.push(photo.photo);\r\n          this.primaryPhotos.push(photo.photo);\r\n          this.loadImage(photo.photo, this.photos.indexOf(photo.photo));\r\n        });\r\n        this.vacationRental.id = vacationRental.id;\r\n        toggleLoading();\r\n      })\r\n      .catch(() => {\r\n        this.$notify({\r\n          title: \"Server error\",\r\n          text: \"Server is currently off. Please try again later...\",\r\n          type: \"error\"\r\n        });\r\n        toggleLoading();\r\n      })\r\n    }\r\n    else{\r\n      toggleLoading();\r\n    }\r\n  },\r\n  computed: {\r\n    rulesOfConduct() {\r\n      let pairsOfRules = [];\r\n      let positiveRules = this.positiveRules(this.vacationRental.conductRules);\r\n      let negativeRules = this.negativeRules(this.vacationRental.conductRules);\r\n      let size = Math.max(positiveRules.length, negativeRules.length);\r\n      for (let i = 0; i < size; i++) {\r\n        pairsOfRules.push({\r\n          \"Do\": i + 1 <= positiveRules.length ? positiveRules[i] : \"\",\r\n          \"DoNot\": i + 1 <= negativeRules.length ? negativeRules[i] : \"\"\r\n        });\r\n      }\r\n      return pairsOfRules;\r\n    },\r\n    isNameEntered() {\r\n      return Boolean(this.vacationRental.name);\r\n    },\r\n    isDescriptionEntered() {\r\n      return Boolean(this.vacationRental.description);\r\n    },\r\n    isCountryEntered() {\r\n      return Boolean(this.vacationRental.address.country);\r\n    },\r\n    isCityEntered() {\r\n      return Boolean(this.vacationRental.address.city);\r\n    },\r\n    isStreetEntered() {\r\n      return Boolean(this.vacationRental.address.street);\r\n    },\r\n    isNumberEntered() {\r\n      return Boolean(this.vacationRental.address.number);\r\n    },\r\n    isPriceEntered() {\r\n      return Boolean(this.vacationRental.price);\r\n    },\r\n    isCapacityEntered() {\r\n      return Boolean(this.vacationRental.capacity);\r\n    },\r\n    isCancellationFeeEntered() {\r\n      return Boolean(this.vacationRental.cancellationFee);\r\n    },\r\n    isPhotoEntered() {\r\n      return this.photos.length > 0;\r\n    }\r\n  },\r\n  methods: {\r\n    submit() {\r\n      if (this.isDataEntered()) {\r\n        this.isDataCorrect();\r\n      }\r\n    },\r\n    makeRequest() {\r\n      let vacationRental = this.vacationRental;\r\n      axios.post(\"/RentalObjects/addVacationRental\", vacationRental, {\r\n        headers: {\r\n          Authorization: \"Bearer \" + this.$store.getters.access_token,\r\n        }\r\n      })\r\n      .then((vacationRental) => {\r\n        for (let i = 0; i < this.photos.length; i++) {\r\n          let formData = new FormData();\r\n          formData.append(\"file\", this.photos[i]);\r\n          axios.post(\"/Photos/upload\", formData, {\r\n            headers: {\r\n              Authorization: \"Bearer \" + this.$store.getters.access_token,\r\n              \"Content-type\": \"multipart/form-data\"\r\n            },\r\n          })\r\n          .then((response) => {\r\n            let body = {id: vacationRental.data.id, photos: [response.data]}\r\n            console.log(body);\r\n            axios.post(\"/RentalObjects/connectPhotosToVacationRental\", body,{\r\n              headers: {\r\n                Authorization: \"Bearer \" + this.$store.getters.access_token,\r\n              },\r\n            }).then(() =>{\r\n              this.$notify( {\r\n                title: \"Successful adding\",\r\n                text: \"You have successfully added a new vacation rental.\",\r\n                position: \"bottom right\",\r\n                type: \"success\"\r\n              });\r\n            })\r\n          })\r\n        }\r\n        toggleProcessing();\r\n      })\r\n      .catch(error => {\r\n        if (!error.response) {\r\n          this.$notify({\r\n            title: \"Server error\",\r\n            text: \"Server is currently off. Please try again later...\",\r\n            type: \"error\"\r\n          });\r\n        } else if (error.response.status === 500) {\r\n          this.$notify({\r\n            title: \"Internal Server Error\",\r\n            text: \"Something went wrong on the server! Please try again later...\",\r\n            position: \"bottom right\",\r\n            type: \"error\"\r\n          });\r\n        }\r\n        toggleProcessing();\r\n      })\r\n    },\r\n    updateVacationRental() {\r\n      let vacationRental = this.vacationRental;\r\n      axios.put(\"/RentalObjects/updateVacationRental\", vacationRental, {\r\n        headers: {\r\n          Authorization: \"Bearer \" + this.$store.getters.access_token,\r\n        }\r\n      })\r\n      .then((id) => {\r\n        for(let i = 0; i < this.photos.length; i++) {\r\n          if(!this.photoExisted(this.photos[i])) {\r\n            let formData = new formData();\r\n            formData.append(\"file\", this.photos[i]);\r\n            axios.post(\"/Photos/upload\", formData, {\r\n              headers: {\r\n                Authorization: \"Bearer \" + this.$store.getters.access_token,\r\n                \"Content-type\": \"multipart/form-data\"\r\n              }\r\n            })\r\n            .then((response) => {\r\n              let body = {id:  id.data, photos: [response.data]}\r\n              axios.post(\"/RentalObjects/connectPhotosToVacationRental\", body, {\r\n                headers: {\r\n                  Authorization: \"Bearer \" + this.$store.getters.access_token,\r\n                }\r\n              }).then(() => {\r\n                this.$notify({\r\n                  title: \"Successful update\",\r\n                  text: \"You have successfully updated the vacation rental.\",\r\n                  position: \"bottom right\",\r\n                  type: \"success\"\r\n                });\r\n              })\r\n            })\r\n          }\r\n        }\r\n        toggleProcessing();\r\n      })\r\n      .catch(error => {\r\n        if (!error.response) {\r\n          this.$notify({\r\n            title: \"Server error\",\r\n            text: \"Server is currently off. Please try again later...\",\r\n            type: \"error\"\r\n          });\r\n        } else if (error.response.status === 500) {\r\n          this.$notify({\r\n            title: \"Internal Server Error\",\r\n            text: \"Something went wrong on the server! Please try again later...\",\r\n            position: \"bottom right\",\r\n            type: \"error\"\r\n          })\r\n        }\r\n        toggleProcessing();\r\n      })\r\n    },\r\n    isDataEntered() {\r\n      if (!this.isNameEntered) {\r\n        this.nameIsEntered = false;\r\n        return false;\r\n      }\r\n      if (!this.isDescriptionEntered) {\r\n        this.descriptionIsEntered = false;\r\n        return false;\r\n      }\r\n      if (!this.isCountryEntered) {\r\n        this.countryIsEntered = false;\r\n        return false;\r\n      }\r\n      if (!this.isCityEntered) {\r\n        this.cityIsEntered = false;\r\n        return false;\r\n      }\r\n      if (!this.isStreetEntered) {\r\n        this.streetIsEntered = false;\r\n        return false;\r\n      }\r\n      if (!this.isNumberEntered) {\r\n        this.numberIsEntered = false;\r\n        return false;\r\n      }\r\n      if (!this.isPriceEntered) {\r\n        this.priceIsEntered = false;\r\n        return false;\r\n      }\r\n      if (!this.isCapacityEntered) {\r\n        this.capacityIsEntered = false;\r\n        return false;\r\n      }\r\n      if (!this.isCancellationFeeEntered) {\r\n        this.cancellationFeeIsEntered = false;\r\n        return false;\r\n      }\r\n      if (!this.isPhotoEntered) {\r\n        this.photoIsEntered = false;\r\n        return false;\r\n      }\r\n      return true;\r\n    },\r\n    async isDataCorrect() {\r\n      this.addressIsValid = false;\r\n      this.validateAddress();\r\n    },\r\n    loadImage(name, index){\r\n      axios.get(\"/Photos/\", {\r\n        headers: {\r\n          Authorization: \"Bearer \" + this.$store.getters.access_token,\r\n        },\r\n        params: {\r\n          path: name\r\n        },\r\n        responseType: \"blob\"\r\n      })\r\n      .then(response => {\r\n        this.imageUrls[index] = URL.createObjectURL(response.data);\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n    },\r\n    validateAddress() {\r\n      const apiKey = 'VrDrl5BjEA0Whvb-chHbFz96HV4qlCXB-yoiTRRLKno';\r\n      const url = 'https://geocoder.ls.hereapi.com/6.2/geocode.json' +\r\n          '?apiKey=' + apiKey +\r\n          '&housenumber=' + this.vacationRental.address.number +\r\n          '&street=' + this.vacationRental.address.street +\r\n          '&city=' + this.vacationRental.address.city +\r\n          '&country=' + this.vacationRental.address.country;\r\n      fetch(url)\r\n          .then(response => response.json())\r\n          .then(data => {\r\n            const responseView = data.Response.View;\r\n            if (responseView.length === 0) {\r\n              this.addressIsValid = false;\r\n            }\r\n            else {\r\n              const location = responseView[0].Result[0].Location.DisplayPosition;\r\n              const address = responseView[0].Result[0].Location.Address;\r\n              this.vacationRental.address.city = this.transliterate(address.City);\r\n              this.vacationRental.address.country = this.transliterate(address.AdditionalData[0].value);\r\n              this.vacationRental.address.street = this.transliterate(address.Street);\r\n              this.vacationRental.address.longitude = location.Longitude;\r\n              this.vacationRental.address.latitude = location.Latitude;\r\n              this.addressIsValid = true;\r\n              if(this.vacationRental.id === null) {\r\n                this.makeRequest();\r\n              }\r\n              else {\r\n                this.updateVacationRental();\r\n              }\r\n            }\r\n          })\r\n          .catch(() => {\r\n            this.addressIsValid = false;\r\n          });\r\n    },\r\n    transliterate(word) {\r\n      let letters = {\"Б\":\"B\", \"В\":\"V\", \"Г\":\"G\", \"Д\":\"D\", \"Ђ\":\"Đ\", \"Ж\":\"Ž\", \"З\":\"Z\", \"И\":\"I\", \"К\":\"K\", \"Л\":\"L\", \"Љ\":\"Lj\", \"М\":\"M\", \"Н\":\"N\", \"Њ\":\"Nj\", \"П\":\"P\",\r\n        \"Р\":\"R\", \"С\":\"S\", \"Ћ\":\"Ć\", \"У\":\"U\", \"Ф\":\"F\", \"Х\":\"H\", \"Ц\":\"C\", \"Ч\":\"Č\", \"Џ\":\"Dž\", \"Ш\":\"Š\", \"б\":\"b\", \"в\":\"v\", \"г\":\"g\", \"д\":\"d\", \"ђ\":\"đ\", \"ж\":\"ž\", \"з\":\"z\", \"и\":\"i\", \"к\":\"k\", \"л\":\"l\", \"љ\":\"lj\", \"м\":\"m\", \"н\":\"n\", \"њ\":\"nj\", \"п\":\"p\",\r\n        \"р\":\"r\", \"с\":\"s\", \"т\":\"t\", \"ћ\":\"ć\", \"у\":\"u\", \"ф\":\"f\", \"х\":\"h\", \"ц\":\"c\", \"ч\":\"č\", \"џ\":\"dž\", \"ш\":\"š\"};\r\n      return word.split('').map(function (char) {\r\n        return letters[char] || char;\r\n      }).join(\"\");\r\n    },\r\n    addPhoto(e) {\r\n      e.target.files.forEach(photo => {\r\n        this.photos.push(photo);\r\n        this.imageUrls.push(URL.createObjectURL(photo));\r\n        this.photoIsEntered = true;\r\n      })\r\n    },\r\n    removePhoto(index) {\r\n      this.photos.splice(index, 1);\r\n      this.imageUrls.splice(index, 1);\r\n    },\r\n    addRoom() {\r\n      if (this.bedPerRoom.bed.trim() !== \"\") {\r\n        if (this.vacationRental.rooms.indexOf(this.bedPerRoom.bed.trim()) === -1) {\r\n          this.vacationRental.rooms.push(this.bedPerRoom);\r\n          this.bedPerRoom = {bed: \"\"};\r\n        }\r\n      }\r\n    },\r\n    removeRoom(bedPerRoom) {\r\n      this.vacationRental.rooms.splice(this.vacationRental.rooms.indexOf(bedPerRoom), 1);\r\n    },\r\n    addService() {\r\n      if (this.additionalService.trim() !== \"\") {\r\n        let newService = {};\r\n        newService[\"name\"] = this.additionalService.trim();\r\n        newService[\"price\"] = this.additionalServicePrice===null?0:this.additionalServicePrice;\r\n        if (this.vacationRental.additionalServices.indexOf(newService) === -1) {\r\n          this.vacationRental.additionalServices.push(newService);\r\n          this.additionalService = \"\";\r\n          this.additionalServicePrice = null;\r\n          this.serviceAlreadyExists = false;\r\n        } else {\r\n          this.serviceAlreadyExists = true;\r\n        }\r\n      }\r\n    },\r\n    removeService(service) {\r\n      this.vacationRental.additionalServices.splice(this.vacationRental.additionalServices.indexOf(service), 1);\r\n    },\r\n    addRule() {\r\n      if (this.ruleText.trim() !== \"\" && this.ruleType.trim() !== \"\") {\r\n        if (!this.ruleExists(this.ruleText.trim())) {\r\n          let newRule = {};\r\n          newRule[\"type\"] = this.ruleType;\r\n          newRule[\"rule\"] = this.ruleText;\r\n          this.vacationRental.conductRules.push(newRule);\r\n          this.ruleType = \"\";\r\n          this.ruleText = \"\";\r\n          this.ruleIsValid = true;\r\n          this.ruleAlreadyExists = false;\r\n        } else {\r\n          this.ruleAlreadyExists = true;\r\n        }\r\n      } else {\r\n        this.ruleIsValid = false;\r\n      }\r\n    },\r\n    removeRule(rule) {\r\n      this.vacationRental.conductRules.splice(this.getRuleIndex(rule), 1);\r\n    },\r\n    getRuleIndex(rule) {\r\n      let index = -1;\r\n      this.vacationRental.conductRules.forEach(conductRule => {\r\n        if (conductRule.rule === rule) {\r\n          index = this.vacationRental.conductRules.indexOf(conductRule);\r\n        }\r\n      })\r\n      return index;\r\n    },\r\n    positiveRules(rulesOfConduct) {\r\n      let positiveRules = [];\r\n      rulesOfConduct.forEach(rule => {\r\n        if (rule.type === \"Do\") {\r\n          positiveRules.push(rule.rule);\r\n        }\r\n      });\r\n      return positiveRules;\r\n    },\r\n    negativeRules(rulesOfConduct) {\r\n      let negativeRules = [];\r\n      rulesOfConduct.forEach(rule => {\r\n        if (rule.type === \"DoNot\") {\r\n          negativeRules.push(rule.rule);\r\n        }\r\n      });\r\n      return negativeRules;\r\n    },\r\n    ruleExists(rule) {\r\n      return this.getRuleIndex(rule) !== -1;\r\n    },\r\n    photoExisted(photo) {\r\n      for (let i = 0; i <this.primaryPhotos.length; i++) {\r\n        if (this.primaryPhotos[i] === photo) {\r\n          return true;\r\n        }\r\n      }\r\n      return false;\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.upload-button {\r\n  display: none;\r\n}\r\n\r\nlabel, .tag-container, small {\r\n  max-width: 400px;\r\n}\r\n\r\n.equipment-tag {\r\n  background-color: #008970;\r\n  color: #99EEDF;\r\n  width: fit-content;\r\n  font-size: 12px;\r\n}\r\n\r\n.equipment-tag:hover   {\r\n  background-color: #99EEDF;\r\n  color: #008970;\r\n  width: fit-content;\r\n  font-size: 12px;\r\n}\r\n\r\n.equipment-tag:hover .tag-button {\r\n  background-color: transparent;\r\n  color: #008970;\r\n  border: none;\r\n}\r\n\r\n.tag-button {\r\n  background-color: transparent;\r\n  color: #99EEDF;\r\n  border: none;\r\n}\r\n\r\ntextarea {\r\n  resize: none;\r\n  width: 100%;\r\n  text-align: justify;\r\n  max-width: 400px;\r\n}\r\n\r\ninput {\r\n  max-width: 400px;\r\n}\r\n\r\ninput::placeholder {\r\n  color: grey;\r\n}\r\n\r\nh3 {\r\n  text-align: center;\r\n}\r\n\r\nh4 {\r\n  text-align: center;\r\n}\r\n\r\np {\r\n  color: #e23c52;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}