{"ast":null,"code":"import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-6773a02f\"), n = n(), _popScopeId(), n);\n\nconst _hoisted_1 = {\n  class: \"row\"\n};\nconst _hoisted_2 = {\n  class: \"col-md-4\"\n};\nconst _hoisted_3 = [\"src\"];\nconst _hoisted_4 = {\n  class: \"col-md-4\"\n};\nconst _hoisted_5 = {\n  class: \"row\"\n};\nconst _hoisted_6 = {\n  class: \"rentalObjectName align-items-center text-start\",\n  style: {\n    \"display\": \"flex\"\n  }\n};\nconst _hoisted_7 = {\n  class: \"display-6 me-1 card-title cut-text\"\n};\n\nconst _hoisted_8 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"hr\", null, null, -1\n/* HOISTED */\n));\n\nconst _hoisted_9 = {\n  class: \"row\"\n};\nconst _hoisted_10 = {\n  class: \"h4\"\n};\n\nconst _hoisted_11 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"strong\", {\n  style: {\n    \"color\": \"#008970\"\n  }\n}, \"Date:\", -1\n/* HOISTED */\n));\n\nconst _hoisted_12 = {\n  class: \"row\"\n};\nconst _hoisted_13 = {\n  class: \"h4\"\n};\n\nconst _hoisted_14 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"strong\", {\n  style: {\n    \"color\": \"#008970\"\n  }\n}, \"Total:\", -1\n/* HOISTED */\n));\n\nconst _hoisted_15 = {\n  class: \"col-md-4 p-5 d-flex flex-grow-1 justify-content-center align-items-center\",\n  style: {\n    \"height\": \"20vh\"\n  }\n};\nconst _hoisted_16 = {\n  style: {\n    \"width\": \"100%\"\n  }\n};\nconst _hoisted_17 = {\n  class: \"row\"\n};\nconst _hoisted_18 = [\"data-bs-target\"];\nconst _hoisted_19 = {\n  class: \"row\"\n};\nconst _hoisted_20 = [\"data-bs-target\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n\n  const _component_ReservationPreview = _resolveComponent(\"ReservationPreview\");\n\n  const _component_ReservationCancellation = _resolveComponent(\"ReservationCancellation\");\n\n  return _openBlock(true), _createElementBlock(_Fragment, null, _renderList(this.sortedReservations, (reservation, i) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: i,\n      class: \"card reservation mb-3\"\n    }, [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_router_link, {\n      to: $options.getPath(reservation),\n      class: \"link\",\n      onClick: $event => $options.setRentalIdAndType(reservation)\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"img\", {\n        class: \"rentalPhoto\",\n        src: $data.images[i],\n        alt: \"\"\n      }, null, 8\n      /* PROPS */\n      , _hoisted_3)]),\n      _: 2\n      /* DYNAMIC */\n\n    }, 1032\n    /* PROPS, DYNAMIC_SLOTS */\n    , [\"to\", \"onClick\"])]), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"div\", null, [_createElementVNode(\"h1\", _hoisted_7, _toDisplayString(reservation.rentalObject.name), 1\n    /* TEXT */\n    )]), _hoisted_8])]), _createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"p\", _hoisted_10, [_hoisted_11, _createTextVNode(\" \" + _toDisplayString($options.getDateSpan(reservation)), 1\n    /* TEXT */\n    )])]), _createElementVNode(\"div\", _hoisted_12, [_createElementVNode(\"p\", _hoisted_13, [_hoisted_14, _createTextVNode(\" $\" + _toDisplayString($options.calculateTotal(reservation)), 1\n    /* TEXT */\n    )])])]), _createElementVNode(\"div\", _hoisted_15, [_createElementVNode(\"div\", _hoisted_16, [_createElementVNode(\"div\", _hoisted_17, [_createElementVNode(\"button\", {\n      class: \"w-100 btn mb-2\",\n      style: {\n        \"font-weight\": \"500\",\n        \"color\": \"white\"\n      },\n      \"data-bs-toggle\": \"modal\",\n      \"data-bs-target\": '#bill-' + reservation.id\n    }, \" Reservation Preview \", 8\n    /* PROPS */\n    , _hoisted_18), _createVNode(_component_ReservationPreview, {\n      services: reservation.additionalServices,\n      days: $options.getNumberOfDays(reservation),\n      price: reservation.price,\n      total: $options.calculateTotal(reservation),\n      id: reservation.id,\n      specialOffer: reservation.specialOffer\n    }, null, 8\n    /* PROPS */\n    , [\"services\", \"days\", \"price\", \"total\", \"id\", \"specialOffer\"])]), _createElementVNode(\"div\", _hoisted_19, [_createElementVNode(\"button\", {\n      class: \"w-100 btn\",\n      style: {\n        \"background-color\": \"#e23c52\",\n        \"font-weight\": \"500\",\n        \"color\": \"white\"\n      },\n      \"data-bs-toggle\": \"modal\",\n      \"data-bs-target\": '#cancel-' + reservation.id\n    }, \" Cancel Reservation \", 8\n    /* PROPS */\n    , _hoisted_20), _createVNode(_component_ReservationCancellation, {\n      id: reservation.id,\n      cancellationFee: reservation.rentalObject.cancellationFee,\n      reservationStartDate: reservation.initDate,\n      reservationId: reservation.id,\n      total: $options.calculateTotal(reservation)\n    }, null, 8\n    /* PROPS */\n    , [\"id\", \"cancellationFee\", \"reservationStartDate\", \"reservationId\", \"total\"])])])])])]);\n  }), 128\n  /* KEYED_FRAGMENT */\n  );\n}","map":{"version":3,"mappings":"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","names":["class","style","_createElementVNode","_createElementBlock","_Fragment","_renderList","sortedReservations","reservation","i","key","_createVNode","_component_router_link","to","$options","onClick","src","$data","alt","_toDisplayString","rentalObject","name","_hoisted_8","_hoisted_11","_hoisted_14","id","_hoisted_18","_component_ReservationPreview","services","additionalServices","days","price","total","specialOffer","_hoisted_20","_component_ReservationCancellation","cancellationFee","reservationStartDate","initDate","reservationId"],"sourceRoot":"","sources":["C:\\Users\\Sa≈°ka\\Downloads\\MRS_ISA\\isa_mrs_projekat_front\\src\\components\\Client\\ClientPage\\components\\ClientProfile\\ClientReservations\\ClientUpcomingReservations\\ClientReservations.vue"],"sourcesContent":["<template>\r\n  <div v-for=\"(reservation, i) in this.sortedReservations\" :key=\"i\" class=\"card reservation mb-3\">\r\n    <div class=\"row\">\r\n      <div class=\"col-md-4\" >\r\n        <router-link :to=\"getPath(reservation)\" class=\"link\" @click=\"setRentalIdAndType(reservation)\">\r\n          <img class=\"rentalPhoto\" :src=\"images[i]\" alt=\"\"/>\r\n        </router-link>\r\n      </div>\r\n      <div class=\"col-md-4\">\r\n        <div class=\"row\">\r\n          <div class=\"rentalObjectName align-items-center text-start\" style=\"display: flex;\">\r\n            <div>\r\n              <h1 class=\"display-6 me-1 card-title cut-text\">{{ reservation.rentalObject.name }}</h1>\r\n            </div>\r\n            <hr>\r\n          </div>\r\n        </div>\r\n        <div class=\"row\">\r\n          <p class=\"h4\" ><strong style=\"color:#008970;\">Date:</strong> {{  getDateSpan(reservation) }}</p>\r\n        </div>\r\n        <div class=\"row\">\r\n          <p class=\"h4\"><strong style=\"color:#008970;\">Total:</strong> ${{  calculateTotal(reservation) }}</p>\r\n        </div>\r\n      </div>\r\n      <div class=\"col-md-4 p-5 d-flex flex-grow-1 justify-content-center align-items-center\" style=\"height: 20vh;\">\r\n        <div style=\"width: 100%;\">\r\n          <div class=\"row\">\r\n            <button class=\"w-100 btn mb-2\" style=\"font-weight: 500; color: white;\" data-bs-toggle=\"modal\"\r\n                    :data-bs-target=\"'#bill-'+reservation.id\">\r\n              Reservation Preview\r\n            </button>\r\n            <ReservationPreview :services=\"reservation.additionalServices\"\r\n                                :days=\"getNumberOfDays(reservation)\"\r\n                                :price=\"reservation.price\"\r\n                                :total=\"calculateTotal(reservation)\"\r\n                                :id=\"reservation.id\"\r\n                                :specialOffer=\"reservation.specialOffer\"/>\r\n          </div>\r\n          <div class=\"row\">\r\n            <button class=\"w-100 btn\" style=\"background-color:#e23c52; font-weight: 500; color: white;\"\r\n                    data-bs-toggle=\"modal\" :data-bs-target=\"'#cancel-'+reservation.id\">\r\n              Cancel Reservation\r\n            </button>\r\n            <ReservationCancellation :id=\"reservation.id\"\r\n                                     :cancellationFee=\"reservation.rentalObject.cancellationFee\"\r\n                                     :reservationStartDate=\"reservation.initDate\"\r\n                                     :reservationId=\"reservation.id\"\r\n                                     :total=\"calculateTotal(reservation)\"/>\r\n          </div>\r\n        </div>\r\n\r\n\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\n\r\nimport axios from \"axios/index\";\r\nimport ReservationPreview\r\n  from \"@/components/Client/ClientPage/components/ClientProfile/ClientReservations/ReservationPreview\";\r\nimport ReservationCancellation\r\n  from \"@/components/Client/ClientPage/components/ClientProfile/ClientReservations/ReservationCancellation\";\r\n//import {useStore} from \"vuex\";\r\n\r\nexport default {\r\n  name: \"ClientReservations\",\r\n  props: [\"reservations\"],\r\n  components: {ReservationPreview, ReservationCancellation},\r\n  data() {\r\n    return {\r\n      images: [],\r\n      sortedReservations: [],\r\n    }\r\n  },\r\n  computed: {\r\n\r\n  },\r\n  methods: {\r\n    isFeeNull(reservation) {\r\n      return reservation.rentalObject.cancellationFee !== null;\r\n    },\r\n    calculateTotal(reservation) {\r\n      let days = this.getNumberOfDays(reservation);\r\n      let services = this.calculateAdditionalServices(reservation);\r\n      let price = reservation.price;\r\n      if(reservation.specialOffer !== null) {\r\n        return (days*price)/100 * (100-reservation.specialOffer.discount);\r\n      }\r\n      return days*price+services;\r\n    },\r\n    getNumberOfDays(reservation) {\r\n      let initDate = reservation.initDate, termDate = reservation.termDate;\r\n      let date1 = new Date(initDate), date2 = new Date(termDate);\r\n      date1.setHours(0, 0, 0);\r\n      date2.setHours(0, 0, 0);\r\n      let timeDiff = date2.getTime() - date1.getTime();\r\n      let daysDiff = timeDiff / (1000 * 3600 * 24);\r\n      return daysDiff + 1;\r\n    },\r\n    calculateAdditionalServices(reservation) {\r\n      let services = reservation.additionalServices, totalServices = 0;\r\n      for(let i=0; i<services.length; i++) totalServices += services[i].price;\r\n      return totalServices;\r\n    },\r\n    getDateSpan(reservation) {\r\n      let initDate = reservation.initDate, termDate = reservation.termDate;\r\n      let date1 = new Date(initDate), date2 = new Date(termDate);\r\n      // date1.setHours(0, 0, 0);\r\n      // date2.setHours(0, 0, 0);\r\n      let dateDisplay = date1.getDate() + '.' + (date1.getMonth() + 1) + '.' +  date1.getFullYear() + '.';\r\n      if(date1.getFullYear() !== date2.getFullYear() || date1.getMonth() !== date2.getMonth() || date1.getDate() !== date2.getDate())\r\n        dateDisplay += ' - ' + date2.getDate() + '.' + (date2.getMonth() + 1) + '.' +  date2.getFullYear() + '.';\r\n      return dateDisplay;\r\n    },\r\n    setRentalIdAndType(reservation) {\r\n      this.$store.dispatch(\"rentalId\", reservation.rentalObject.id);\r\n      this.$store.dispatch(\"rentalType\", reservation.rentalObject.rentalObjectType);\r\n    },\r\n    getPath(reservation) {\r\n      return \"/client/RentalProfile/\" + reservation.rentalObject.rentalObjectType + \"-\"\r\n          + reservation.rentalObject.id;\r\n    },\r\n  },\r\n  mounted() {\r\n    this.sortedReservations = this.reservations;\r\n    this.sortedReservations = this.sortedReservations.sort((a, b) => new Date(b.initDate) < new Date(a.initDate) ? 1: -1);\r\n    //if(!this.reservations) return;\r\n    for (let i=0; i < this.reservations.length; i++) {\r\n      if(!this.reservations[i].rentalObject.displayPhoto.photo) { this.images[i] = null; continue; }\r\n      axios.get(\"/Photos/\", {\r\n        headers: {\r\n          Authorization: \"Bearer \" + this.$store.getters.access_token,\r\n        },\r\n        params: {\r\n          path: this.reservations[i].rentalObject.displayPhoto.photo,\r\n        },\r\n        responseType: \"blob\"\r\n      })\r\n      .then(response => {\r\n        this.images[i] = URL.createObjectURL(response.data);\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\nhr {\r\n  flex-grow: 1;\r\n}\r\n.cut-text {\r\n  width: 100%;\r\n  display: -webkit-box;\r\n  -webkit-line-clamp: 1;\r\n  -webkit-box-orient: vertical;\r\n  overflow: hidden;\r\n}\r\ndiv.rentalObjectName {\r\n  display: flex;\r\n}\r\ndiv.reservation {\r\n  box-shadow: 0.1rem 0.1rem 0.4rem rgb(0 0 0 / 15%);\r\n  background-color: #ffffff;\r\n}\r\ndiv.reservation:hover {\r\n  padding: 3px;\r\n}\r\nimg.rentalPhoto {\r\n  height: 20vh;\r\n  width: 100%;\r\n  border-radius: 1rem;\r\n  object-fit: cover;\r\n  object-position: center;\r\n}\r\n.card {\r\n  position: relative;\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: fit-content;\r\n  min-width: 0;\r\n  word-wrap: break-word;\r\n  background-color: #fff;\r\n  background-clip: border-box;\r\n  border: none;\r\n  box-shadow: 0 0.5rem 1rem rgb(0 0 0 / 15%);\r\n  border-radius: 1rem;\r\n}\r\n.card-header:first-child {\r\n  border-radius: calc(1rem - 1px) calc(1rem - 1px) 0 0;\r\n}\r\n.card-header {\r\n  position: relative;\r\n  padding: 2rem 2rem;\r\n  border-bottom: none;\r\n  background-color: inherit;\r\n  box-shadow: 0 0.125rem 0.25rem rgb(0 0 0 / 8%);\r\n  z-index: 2;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}