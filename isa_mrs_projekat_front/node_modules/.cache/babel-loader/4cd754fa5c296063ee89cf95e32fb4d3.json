{"ast":null,"code":"import { FontAwesomeIcon } from \"@fortawesome/vue-fontawesome\";\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\nimport { faFilter, faX, faCheck, faBan } from \"@fortawesome/free-solid-svg-icons\";\nimport axios from \"axios\";\nimport { useStore } from \"vuex\";\nimport { toggleProcessing } from \"@/components/state\";\nlibrary.add(faFilter, faX, faCheck, faBan);\nexport default {\n  name: \"AdminReviewsView\",\n  components: {\n    FontAwesomeIcon\n  },\n\n  data() {\n    return {\n      reviews: [],\n      currentPage: 0,\n      totalPages: null,\n      pageSize: 10,\n      filterAuthor: null,\n      filterSubject: null,\n      filterActive: false\n    };\n  },\n\n  mounted() {\n    const store = useStore();\n    axios.get(\"/Reviews/getReviewsPage\", {\n      headers: {\n        Authorization: \"Bearer \" + store.getters.access_token\n      },\n      params: {\n        page: this.currentPage,\n        pageSize: this.pageSize\n      }\n    }).then(response => {\n      this.reviews = response.data.content;\n      this.currentPage = response.data.currentPage;\n      this.totalPages = response.data.pages;\n    }).catch(() => {\n      this.$notify({\n        title: \"Server error\",\n        text: \"Server is currently off. Please try again later...\",\n        type: \"error\"\n      });\n    });\n  },\n\n  methods: {\n    manageReview(reviewId, accepted) {\n      toggleProcessing();\n      axios.put(\"/Reviews/manageReview\", null, {\n        headers: {\n          Authorization: \"Bearer \" + this.$store.getters.access_token\n        },\n        params: {\n          id: reviewId,\n          accepted: accepted\n        }\n      }).then(response => {\n        this.$notify({\n          title: \"Successfully managed\",\n          text: \"You have successfully\" + (accepted ? \"accepted\" : \"rejected\") + \" the review with id \" + response.data.id + \".\",\n          position: \"bottom right\",\n          type: \"success\"\n        });\n        this.refreshPage();\n        toggleProcessing();\n      }).catch(error => {\n        if (!error.response) {\n          this.$notify({\n            title: \"Server error\",\n            text: \"Server is currently off. Please try again later...\",\n            type: \"error\"\n          });\n        } else if (error.response.status === 500) {\n          this.$notify({\n            title: \"Internal Server Error\",\n            text: \"Something went wrong on the server! Please try again later...\",\n            position: \"bottom right\",\n            type: \"error\"\n          });\n        } else if (error.response.status === 409) {\n          this.$notify({\n            title: \"Conflict\",\n            text: \"We are sorry, but another administrator has already managed the review.\",\n            position: \"bottom right\",\n            type: \"warn\"\n          });\n          this.refreshPage();\n        }\n\n        toggleProcessing();\n      });\n    },\n\n    filterButtonClicked() {\n      if (this.filterActive) {\n        this.filterSubject = null;\n        this.filterAuthor = null;\n        this.filterActive = !this.filterActive;\n        this.refreshPage();\n      } else if (this.filterSubject !== null && this.filterAuthor !== null) {\n        this.filterActive = !this.filterActive;\n        this.refreshPage();\n      }\n    },\n\n    userRole(user) {\n      if (user.userType === \"Instructor\") {\n        return \"Fishing Instructor\";\n      } else if (user.userType === \"VacationRentalOwner\") {\n        return \"House Owner\";\n      } else if (user.userType === \"BoatOwner\") {\n        return \"Boat Owner\";\n      } else if (user.userType === \"SuperAdmin\") {\n        return \"Supreme Admin\";\n      } else {\n        return user.userType;\n      }\n    },\n\n    previousPage() {\n      this.currentPage -= 1;\n      this.refreshPage();\n    },\n\n    nextPage() {\n      this.currentPage += 1;\n      this.refreshPage();\n    },\n\n    numberedPage(buttonNumber) {\n      if (buttonNumber === 1) {\n        this.currentPage = this.button1Content - 1;\n      } else if (buttonNumber === 2) {\n        this.currentPage = this.button2Content - 1;\n      } else if (buttonNumber === 3) {\n        this.currentPage = this.button3Content - 1;\n      }\n\n      this.refreshPage();\n    },\n\n    refreshPage() {\n      let params;\n      let url;\n\n      if (this.filterSubject !== null && this.filterAuthor !== null) {\n        params = {\n          page: this.currentPage,\n          pageSize: this.pageSize,\n          author: this.filterAuthor,\n          subject: this.filterSubject\n        };\n        url = \"/Reviews/getReviewsFilterPage\";\n      } else {\n        params = {\n          page: this.currentPage,\n          pageSize: this.pageSize\n        };\n        url = \"/Reviews/getReviewsPage\";\n      }\n\n      axios.get(url, {\n        headers: {\n          Authorization: \"Bearer \" + this.$store.getters.access_token\n        },\n        params\n      }).then(response => {\n        this.reviews = response.data.content;\n        this.currentPage = response.data.currentPage;\n        this.totalPages = response.data.pages;\n      }).catch(() => {\n        this.$notify({\n          title: \"Server error\",\n          text: \"Server is currently off. Please try again later...\",\n          type: \"error\"\n        });\n      });\n    }\n\n  },\n  computed: {\n    button1Content() {\n      return this.currentPage === 0 ? this.currentPage + 1 : this.totalPages - this.currentPage === 1 ? this.currentPage - 1 : this.currentPage;\n    },\n\n    button2Content() {\n      return this.currentPage === 0 ? this.currentPage + 2 : this.totalPages - this.currentPage === 1 ? this.currentPage : this.currentPage + 1;\n    },\n\n    button3Content() {\n      return this.currentPage === 0 ? this.currentPage + 3 : this.totalPages - this.currentPage === 1 ? this.currentPage + 1 : this.currentPage + 2;\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["FontAwesomeIcon","library","faFilter","faX","faCheck","faBan","axios","useStore","toggleProcessing","add","name","components","data","reviews","currentPage","totalPages","pageSize","filterAuthor","filterSubject","filterActive","mounted","store","get","headers","Authorization","getters","access_token","params","page","then","response","content","pages","catch","$notify","title","text","type","methods","manageReview","reviewId","accepted","put","$store","id","position","refreshPage","error","status","filterButtonClicked","userRole","user","userType","previousPage","nextPage","numberedPage","buttonNumber","button1Content","button2Content","button3Content","url","author","subject","computed"],"sourceRoot":"","sources":["C:\\Users\\Saška\\Downloads\\MRS_ISA\\isa_mrs_projekat_front\\src\\components\\Administrator\\AdminPage\\components\\AdminMainViews\\AdminReviewsView.vue"],"sourcesContent":["<template>\r\n  <div class=\"row\">\r\n    <div class=\"col-1\"></div>\r\n    <div class=\"col-10 pt-5 mb-5\">\r\n      <div class=\"container-fluid pe-0 ps-0 me-0 ms-0\">\r\n        <div class=\"align-items-center\">\r\n          <div class=\"row main-col mb-1\">\r\n            <div class=\"d-flex justify-content-start p-0 m-0\">\r\n              <div class=\"me-2\">\r\n                <label for=\"UserType\">Author type</label>\r\n                <select class=\"form-control me-1\" id=\"UserType\" v-model=\"filterAuthor\" style=\"max-width: 400px; min-width: fit-content; width: 25vh\" @change=\"filterActive=false\">\r\n                  <option value=\"RentalObjectOwner\" id=\"authorOwner\">Owner</option>\r\n                  <option value=\"Client\" id=\"authorClient\">Client</option>\r\n                </select>\r\n              </div>\r\n              <div class=\"me-1\">\r\n                <label for=\"SubjectType\">Subject type</label>\r\n                <select class=\"form-control me-1\" id=\"SubjectType\" v-model=\"filterSubject\" style=\"max-width: 400px; min-width: fit-content; width: 25vh\" @change=\"filterActive=false\">\r\n                  <option v-if=\"filterAuthor!=='Client'\" value=\"Client\" id=\"subjectClient\">Client</option>\r\n                  <option v-if=\"filterAuthor!=='RentalObjectOwner'\" value=\"RentalObjectOwner\" id=\"subjectOwner\">Owner</option>\r\n                  <option v-if=\"filterAuthor!=='RentalObjectOwner'\" value=\"RentalObject\">Rental Object</option>\r\n                </select>\r\n              </div>\r\n              <div class=\"mt-auto p-0\">\r\n                <button @click=\"filterButtonClicked\" class=\"btn rounded\" :class=\"filterActive?'btn-red':''\" :disabled=\"filterSubject===null||filterAuthor===null\"><font-awesome-icon :icon=\"filterActive?'x':'filter'\"></font-awesome-icon></button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"row main-col text-center header rounded mb-3\">\r\n            <table>\r\n              <thead>\r\n              <tr>\r\n                <th>Author</th>\r\n                <th>Author type</th>\r\n                <th>Comment</th>\r\n                <th>Grade</th>\r\n                <th>Subject</th>\r\n                <th></th>\r\n                <th></th>\r\n              </tr>\r\n              </thead>\r\n              <tbody>\r\n                <tr class=\"p-1\" v-for=\"(review, index) in this.reviews\" :key=\"index\" :class=\"index%2!==0?'odd':'even'\">\r\n                  <td>\r\n                    {{review.author.name + \" \" + review.author.surname}}\r\n                  </td>\r\n                  <td>\r\n                    {{this.userRole(review.author)}}\r\n                  </td>\r\n                  <td>\r\n                    {{review.comment}}\r\n                  </td>\r\n                  <td>\r\n                    {{review.grade + \" ★\"}}\r\n                  </td>\r\n                  <td>\r\n                    {{review.subjectName}}\r\n                  </td>\r\n                  <td>\r\n                    <button class=\"btn\" data-bs-toggle=\"modal\" data-bs-target=\"#confirmationDialog\">\r\n                      <font-awesome-icon icon=\"check\"></font-awesome-icon>\r\n                    </button>\r\n                    <div class=\"modal fade\" id=\"confirmationDialog\" tabindex=\"-1\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\r\n                      <div class=\"modal-dialog\">\r\n                        <div class=\"modal-content\">\r\n                          <div class=\"modal-header\">\r\n                            <h5 class=\"modal-title\" id=\"exampleModalLabel\">Review Management</h5>\r\n                            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n                          </div>\r\n                          <div class=\"modal-body\">\r\n                            Do you want to accept {{review.author.name + \" \" + review.author.surname}}'s review for {{review.subjectName}}?\r\n                          </div>\r\n                          <div class=\"modal-footer\">\r\n                            <button type=\"button\" class=\"btn btn-red\" style=\"margin-right: 2vh;\" data-bs-dismiss=\"modal\">No</button>\r\n                            <button type=\"button\" class=\"btn\" @click=\"manageReview(review.id, true)\" data-bs-dismiss=\"modal\">Yes</button>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </td>\r\n                  <td>\r\n                    <button class=\"btn btn-red\" data-bs-toggle=\"modal\" data-bs-target=\"#confirmationDialogReject\">\r\n                      <font-awesome-icon icon=\"ban\"></font-awesome-icon>\r\n                    </button>\r\n                    <div class=\"modal fade\" id=\"confirmationDialogReject\" tabindex=\"-1\" aria-labelledby=\"RejectDialog\" aria-hidden=\"true\">\r\n                      <div class=\"modal-dialog\">\r\n                        <div class=\"modal-content\">\r\n                          <div class=\"modal-header\">\r\n                            <h5 class=\"modal-title\" id=\"RejectDialog\">Review Management</h5>\r\n                            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n                          </div>\r\n                          <div class=\"modal-body\">\r\n                            Do you want to reject {{review.author.name + \" \" + review.author.surname}}'s review for {{review.subjectName}}?\r\n                          </div>\r\n                          <div class=\"modal-footer\">\r\n                            <button type=\"button\" class=\"btn btn-red\" style=\"margin-right: 2vh;\" data-bs-dismiss=\"modal\">No</button>\r\n                            <button type=\"button\" class=\"btn\" @click=\"manageReview(review.id, false)\" data-bs-dismiss=\"modal\">Yes</button>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n            <nav aria-label=\"Page navigation\">\r\n              <ul class=\"pagination justify-content-center mt-3\">\r\n                <li class=\"page-item\" v-if=\"totalPages > 1\"><button class=\"page-link\" :disabled=\"currentPage===0\" @click=\"previousPage\">Previous</button></li>\r\n                <li class=\"page-item mt-auto me-1 ms-1\" v-if=\"currentPage > 1 && totalPages > 3\">...</li>\r\n                <li class=\"page-item\"><button class=\"page-link\" :disabled=\"currentPage === 0\" @click=\"numberedPage(1)\">{{button1Content}}</button></li>\r\n                <li class=\"page-item\" v-if=\"totalPages > 1\"><button class=\"page-link\" :disabled=\"currentPage !== 0 && totalPages - currentPage > 1\" @click=\"numberedPage(2)\">{{button2Content}}</button></li>\r\n                <li class=\"page-item\" v-if=\"totalPages > 2\"><button class=\"page-link\" :disabled=\"totalPages - currentPage === 1\" @click=\"numberedPage(3)\">{{button3Content}}</button></li>\r\n                <li class=\"page-item mt-auto me-1 ms-1\" v-if=\"totalPages - currentPage > 1 && totalPages > 3 && button3Content !== totalPages\">...</li>\r\n                <li class=\"page-item\" v-if=\"totalPages > 1\"><button class=\"page-link\" :disabled=\"totalPages - currentPage === 1\" @click=\"nextPage\">Next</button></li>\r\n              </ul>\r\n            </nav>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"col-1\"></div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {FontAwesomeIcon} from \"@fortawesome/vue-fontawesome\";\r\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\r\nimport {faFilter, faX, faCheck, faBan} from \"@fortawesome/free-solid-svg-icons\";\r\nimport axios from \"axios\";\r\nimport {useStore} from \"vuex\";\r\nimport {toggleProcessing} from \"@/components/state\";\r\n\r\nlibrary.add(faFilter, faX, faCheck, faBan);\r\n\r\nexport default {\r\n  name: \"AdminReviewsView\",\r\n  components: {FontAwesomeIcon},\r\n  data() {\r\n    return {\r\n      reviews: [],\r\n      currentPage: 0,\r\n      totalPages: null,\r\n      pageSize: 10,\r\n      filterAuthor: null,\r\n      filterSubject: null,\r\n      filterActive: false,\r\n    }\r\n  },\r\n  mounted() {\r\n    const store = useStore();\r\n    axios.get(\"/Reviews/getReviewsPage\", {headers: {\r\n        Authorization: \"Bearer \" + store.getters.access_token,\r\n      },\r\n      params: {\r\n        page: this.currentPage,\r\n        pageSize: this.pageSize\r\n      }\r\n    })\r\n    .then(response => {\r\n      this.reviews = response.data.content;\r\n      this.currentPage = response.data.currentPage;\r\n      this.totalPages = response.data.pages;\r\n    })\r\n    .catch(() =>{\r\n      this.$notify({\r\n        title: \"Server error\",\r\n        text: \"Server is currently off. Please try again later...\",\r\n        type: \"error\"\r\n      });\r\n    });\r\n  },\r\n  methods: {\r\n    manageReview(reviewId, accepted) {\r\n      toggleProcessing();\r\n      axios.put(\"/Reviews/manageReview\", null,{\r\n        headers: {\r\n          Authorization: \"Bearer \" + this.$store.getters.access_token,\r\n        },\r\n        params: {\r\n         id: reviewId,\r\n         accepted: accepted\r\n        }\r\n      })\r\n      .then((response) => {\r\n        this.$notify( {\r\n          title: \"Successfully managed\",\r\n          text: \"You have successfully\" + (accepted?\"accepted\":\"rejected\") + \" the review with id \" + response.data.id + \".\",\r\n          position: \"bottom right\",\r\n          type: \"success\"\r\n        });\r\n        this.refreshPage();\r\n        toggleProcessing();\r\n      })\r\n      .catch((error) => {\r\n      if (!error.response) {\r\n        this.$notify({\r\n          title: \"Server error\",\r\n          text: \"Server is currently off. Please try again later...\",\r\n          type: \"error\"\r\n        });\r\n      } else if (error.response.status === 500) {\r\n        this.$notify({\r\n          title: \"Internal Server Error\",\r\n          text: \"Something went wrong on the server! Please try again later...\",\r\n          position: \"bottom right\",\r\n          type: \"error\"\r\n        });\r\n      } else if (error.response.status === 409) {\r\n        this.$notify({\r\n          title: \"Conflict\",\r\n          text: \"We are sorry, but another administrator has already managed the review.\",\r\n          position: \"bottom right\",\r\n          type: \"warn\"\r\n        });\r\n        this.refreshPage();\r\n      }\r\n      toggleProcessing();\r\n      })\r\n    },\r\n    filterButtonClicked() {\r\n      if (this.filterActive) {\r\n        this.filterSubject = null;\r\n        this.filterAuthor = null\r\n        this.filterActive = !this.filterActive;\r\n        this.refreshPage();\r\n      } else if (this.filterSubject !== null && this.filterAuthor !== null) {\r\n        this.filterActive = !this.filterActive;\r\n        this.refreshPage();\r\n      }\r\n    },\r\n    userRole(user) {\r\n      if (user.userType === \"Instructor\") {\r\n        return \"Fishing Instructor\";\r\n      } else if (user.userType === \"VacationRentalOwner\") {\r\n        return \"House Owner\";\r\n      } else if (user.userType === \"BoatOwner\") {\r\n        return \"Boat Owner\";\r\n      } else if (user.userType === \"SuperAdmin\") {\r\n        return \"Supreme Admin\";\r\n      } else {\r\n        return user.userType;\r\n      }\r\n    },\r\n    previousPage() {\r\n      this.currentPage -= 1;\r\n      this.refreshPage();\r\n    },\r\n    nextPage() {\r\n      this.currentPage += 1;\r\n      this.refreshPage();\r\n    },\r\n    numberedPage(buttonNumber) {\r\n      if (buttonNumber === 1) {\r\n        this.currentPage = this.button1Content - 1;\r\n      } else if (buttonNumber === 2) {\r\n        this.currentPage = this.button2Content - 1;\r\n      } else if (buttonNumber === 3) {\r\n        this.currentPage = this.button3Content - 1;\r\n      }\r\n      this.refreshPage();\r\n    },\r\n    refreshPage() {\r\n      let params;\r\n      let url;\r\n      if (this.filterSubject !== null && this.filterAuthor !== null) {\r\n        params = {\r\n          page: this.currentPage,\r\n          pageSize: this.pageSize,\r\n          author: this.filterAuthor,\r\n          subject: this.filterSubject\r\n        };\r\n        url = \"/Reviews/getReviewsFilterPage\";\r\n      } else {\r\n        params = {\r\n          page: this.currentPage,\r\n          pageSize: this.pageSize\r\n        };\r\n        url = \"/Reviews/getReviewsPage\";\r\n      }\r\n      axios.get(url, {headers: {\r\n          Authorization: \"Bearer \" + this.$store.getters.access_token,\r\n        },\r\n        params\r\n      })\r\n      .then(response => {\r\n        this.reviews = response.data.content;\r\n        this.currentPage = response.data.currentPage;\r\n        this.totalPages = response.data.pages;\r\n      })\r\n      .catch(() =>{\r\n        this.$notify({\r\n          title: \"Server error\",\r\n          text: \"Server is currently off. Please try again later...\",\r\n          type: \"error\"\r\n        });\r\n      });\r\n    }\r\n  },\r\n  computed: {\r\n    button1Content() {\r\n      return this.currentPage === 0 ? this.currentPage+1: this.totalPages - this.currentPage === 1 ? this.currentPage - 1 : this.currentPage;\r\n    },\r\n    button2Content() {\r\n      return this.currentPage === 0 ? this.currentPage+2: this.totalPages - this.currentPage === 1 ? this.currentPage : this.currentPage+1;\r\n    },\r\n    button3Content() {\r\n      return this.currentPage === 0 ? this.currentPage+3: this.totalPages - this.currentPage === 1 ? this.currentPage + 1 : this.currentPage+2;\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n  label {\r\n    color: #008970;\r\n  }\r\n</style>"]},"metadata":{},"sourceType":"module"}