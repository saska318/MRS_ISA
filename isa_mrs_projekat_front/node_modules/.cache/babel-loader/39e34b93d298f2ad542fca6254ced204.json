{"ast":null,"code":"import { FontAwesomeIcon } from \"@fortawesome/vue-fontawesome\";\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\nimport { faFilter, faX, faCheck, faBan, faPaperPlane } from \"@fortawesome/free-solid-svg-icons\";\nimport axios from \"axios\";\nimport { useStore } from \"vuex\";\nimport { toggleProcessing } from \"@/components/state\";\nlibrary.add(faFilter, faX, faCheck, faBan, faPaperPlane);\nexport default {\n  name: \"AdminReportsView\",\n  components: {\n    FontAwesomeIcon\n  },\n\n  data() {\n    return {\n      reports: [],\n      currentPage: 0,\n      totalPages: null,\n      pageSize: 10,\n      filterAuthor: null,\n      filterActive: false,\n      response: null\n    };\n  },\n\n  mounted() {\n    const store = useStore();\n    axios.get(\"/Reports/getReports\", {\n      headers: {\n        Authorization: \"Bearer \" + store.getters.access_token\n      },\n      params: {\n        page: this.currentPage,\n        pageSize: this.pageSize\n      }\n    }).then(response => {\n      this.reports = response.data.content;\n      this.currentPage = response.data.currentPage;\n      this.totalPages = response.data.pages;\n    }).catch(() => {\n      this.$notify({\n        title: \"Server error\",\n        text: \"Server is currently off. Please try again later...\",\n        type: \"error\"\n      });\n    });\n  },\n\n  methods: {\n    manageReport(reportId, accepted, response) {\n      toggleProcessing();\n      response = response === undefined ? \"\" : response;\n      console.log(\"response: '\" + response + \"'\");\n      axios.put(\"/Reports/manageReport\", null, {\n        headers: {\n          Authorization: \"Bearer \" + this.$store.getters.access_token\n        },\n        params: {\n          id: reportId,\n          accepted: accepted,\n          response: response\n        }\n      }).then(response => {\n        this.$notify({\n          title: \"Successfully managed\",\n          text: \"You have successfully\" + (accepted ? \"accepted\" : \"rejected\") + \" the report with id \" + response.data.id + \".\",\n          position: \"bottom right\",\n          type: \"success\"\n        });\n        this.refreshPage();\n        toggleProcessing();\n      }).catch(error => {\n        if (!error.response) {\n          this.$notify({\n            title: \"Server error\",\n            text: \"Server is currently off. Please try again later...\",\n            type: \"error\"\n          });\n        } else if (error.response.status === 500) {\n          this.$notify({\n            title: \"Internal Server Error\",\n            text: \"Something went wrong on the server! Please try again later...\",\n            position: \"bottom right\",\n            type: \"error\"\n          });\n        } else if (error.response.status === 409) {\n          this.$notify({\n            title: \"Conflict\",\n            text: \"We are sorry, but another administrator has already managed the report.\",\n            position: \"bottom right\",\n            type: \"warn\"\n          });\n          this.refreshPage();\n        }\n\n        toggleProcessing();\n      });\n    },\n\n    filterButtonClicked() {\n      if (this.filterActive) {\n        this.filterAuthor = null;\n        this.filterActive = !this.filterActive;\n        this.refreshPage();\n      } else if (this.filterAuthor !== null) {\n        this.filterActive = !this.filterActive;\n        this.refreshPage();\n      }\n    },\n\n    userRole(user) {\n      if (user.userType === \"Instructor\") {\n        return \"Fishing Instructor\";\n      } else if (user.userType === \"VacationRentalOwner\") {\n        return \"House Owner\";\n      } else if (user.userType === \"BoatOwner\") {\n        return \"Boat Owner\";\n      } else if (user.userType === \"SuperAdmin\") {\n        return \"Supreme Admin\";\n      } else {\n        return user.userType;\n      }\n    },\n\n    previousPage() {\n      this.currentPage -= 1;\n      this.refreshPage();\n    },\n\n    nextPage() {\n      this.currentPage += 1;\n      this.refreshPage();\n    },\n\n    numberedPage(buttonNumber) {\n      if (buttonNumber === 1) {\n        this.currentPage = this.button1Content - 1;\n      } else if (buttonNumber === 2) {\n        this.currentPage = this.button2Content - 1;\n      } else if (buttonNumber === 3) {\n        this.currentPage = this.button3Content - 1;\n      }\n\n      this.refreshPage();\n    },\n\n    refreshPage() {\n      let params;\n      let url;\n\n      if (this.filterAuthor !== null) {\n        params = {\n          page: this.currentPage,\n          pageSize: this.pageSize,\n          userType: this.filterAuthor\n        };\n        url = \"/Reports/getReportsFilter\";\n      } else {\n        params = {\n          page: this.currentPage,\n          pageSize: this.pageSize\n        };\n        url = \"/Reports/getReports\";\n      }\n\n      axios.get(url, {\n        headers: {\n          Authorization: \"Bearer \" + this.$store.getters.access_token\n        },\n        params\n      }).then(response => {\n        this.reports = response.data.content;\n        this.currentPage = response.data.currentPage;\n        this.totalPages = response.data.pages;\n      }).catch(() => {\n        this.$notify({\n          title: \"Server error\",\n          text: \"Server is currently off. Please try again later...\",\n          type: \"error\"\n        });\n      });\n    }\n\n  },\n  computed: {\n    button1Content() {\n      return this.currentPage === 0 ? this.currentPage + 1 : this.totalPages - this.currentPage === 1 ? this.currentPage - 1 : this.currentPage;\n    },\n\n    button2Content() {\n      return this.currentPage === 0 ? this.currentPage + 2 : this.totalPages - this.currentPage === 1 ? this.currentPage : this.currentPage + 1;\n    },\n\n    button3Content() {\n      return this.currentPage === 0 ? this.currentPage + 3 : this.totalPages - this.currentPage === 1 ? this.currentPage + 1 : this.currentPage + 2;\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["FontAwesomeIcon","library","faFilter","faX","faCheck","faBan","faPaperPlane","axios","useStore","toggleProcessing","add","name","components","data","reports","currentPage","totalPages","pageSize","filterAuthor","filterActive","response","mounted","store","get","headers","Authorization","getters","access_token","params","page","then","content","pages","catch","$notify","title","text","type","methods","manageReport","reportId","accepted","undefined","console","log","put","$store","id","position","refreshPage","error","status","filterButtonClicked","userRole","user","userType","previousPage","nextPage","numberedPage","buttonNumber","button1Content","button2Content","button3Content","url","computed"],"sourceRoot":"","sources":["C:\\Users\\Saška\\Downloads\\ISA_MRS\\isa_mrs_projekat_front\\src\\components\\Administrator\\AdminPage\\components\\AdminMainViews\\AdminReportsView.vue"],"sourcesContent":["<template>\r\n  <div class=\"row\">\r\n    <div class=\"col-1\"></div>\r\n    <div class=\"col-10 pt-5 mb-5\">\r\n      <div class=\"container-fluid pe-0 ps-0 me-0 ms-0\">\r\n        <div class=\"align-items-center\">\r\n          <div class=\"row main-col mb-1\">\r\n            <div class=\"d-flex justify-content-start p-0 m-0\">\r\n              <div class=\"me-1\">\r\n                <label for=\"UserType\">Author type</label>\r\n                <select class=\"form-control me-1\" id=\"UserType\" v-model=\"filterAuthor\" style=\"max-width: 400px; min-width: fit-content; width: 25vh\" @change=\"filterActive=false\">\r\n                  <option value=\"RentalObjectOwner\" id=\"authorOwner\">Owner</option>\r\n                  <option value=\"Client\" id=\"authorClient\">Client</option>\r\n                </select>\r\n              </div>\r\n              <div class=\"mt-auto p-0\">\r\n                <button @click=\"filterButtonClicked\" class=\"btn rounded\" :class=\"filterActive?'btn-red':''\" :disabled=\"filterAuthor===null\"><font-awesome-icon :icon=\"filterActive?'x':'filter'\"></font-awesome-icon></button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"row main-col text-center header rounded mb-3\">\r\n            <table>\r\n              <thead>\r\n              <tr>\r\n                <th>Author</th>\r\n                <th>Author type</th>\r\n                <th>Comment</th>\r\n                <th>Subject</th>\r\n                <th></th>\r\n                <th></th>\r\n              </tr>\r\n              </thead>\r\n              <tbody>\r\n              <tr class=\"p-1\" v-for=\"(report, index) in this.reports\" :key=\"index\" :class=\"index%2!==0?'odd':'even'\">\r\n                <td>\r\n                  {{report.author.name + \" \" + report.author.surname}}\r\n                </td>\r\n                <td>\r\n                  {{this.userRole(report.author)}}\r\n                </td>\r\n                <td>\r\n                  {{report.comment}}\r\n                </td>\r\n                <td>\r\n                  {{report.subjectName}}\r\n                </td>\r\n                <td v-if=\"report.author.userType==='Client'\" colspan=\"2\">\r\n                  <div class=\"dropdown d-flex justify-content-start\">\r\n                    <button class=\"btn dropdown\" type=\"button\" id=\"dropdownMenuButton\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\r\n                      <font-awesome-icon icon=\"paper-plane\"></font-awesome-icon>Reply\r\n                    </button>\r\n                    <div class=\"dropdown-menu form\">\r\n                      <div class=\"container-fluid\" style=\"background-color: #f7f7f2\">\r\n                        <div class=\"row\">\r\n                          <p>Please enter the response (50-200 characters):</p>\r\n                        </div>\r\n                        <div class=\"row\">\r\n                          <form>\r\n                            <div class=\"form-group\">\r\n                              <textarea class=\"form-control\" style=\"resize: none\" rows=\"3\" maxlength=\"200\" v-model=\"response\"></textarea>\r\n                            </div>\r\n                            <div class=\"form-group text-center mt-1\">\r\n                              <button class=\"btn\" :class=\"response!==null?null:'disabled'\" @click.prevent=\"manageReport(report.id, true, response)\">Confirm</button>\r\n                            </div>\r\n                          </form>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </td>\r\n                <td v-if=\"report.author.userType!=='Client'\" class=\"text-end\">\r\n                  <button class=\"btn\" data-bs-toggle=\"modal\" data-bs-target=\"#confirmationDialog\">\r\n                    <font-awesome-icon icon=\"check\"></font-awesome-icon>\r\n                  </button>\r\n                  <div class=\"modal fade\" id=\"confirmationDialog\" tabindex=\"-1\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\r\n                    <div class=\"modal-dialog\">\r\n                      <div class=\"modal-content\">\r\n                        <div class=\"modal-header\">\r\n                          <h5 class=\"modal-title\" id=\"exampleModalLabel\">Report Management</h5>\r\n                          <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n                        </div>\r\n                        <div class=\"modal-body\">\r\n                          Do you want to accept {{report.author.name + \" \" + report.author.surname}}'s report for {{report.subjectName}}?\r\n                        </div>\r\n                        <div class=\"modal-footer\">\r\n                          <button type=\"button\" class=\"btn btn-red\" style=\"margin-right: 2vh;\" data-bs-dismiss=\"modal\">No</button>\r\n                          <button type=\"button\" class=\"btn\" @click=\"manageReport(report.id, true)\" data-bs-dismiss=\"modal\">Yes</button>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </td>\r\n                <td v-if=\"report.author.userType!=='Client'\" class=\"text-start\">\r\n                  <button class=\"btn btn-red\" data-bs-toggle=\"modal\" data-bs-target=\"#confirmationDialogReject\">\r\n                    <font-awesome-icon icon=\"ban\"></font-awesome-icon>\r\n                  </button>\r\n                  <div class=\"modal fade\" id=\"confirmationDialogReject\" tabindex=\"-1\" aria-labelledby=\"RejectDialog\" aria-hidden=\"true\">\r\n                    <div class=\"modal-dialog\">\r\n                      <div class=\"modal-content\">\r\n                        <div class=\"modal-header\">\r\n                          <h5 class=\"modal-title\" id=\"RejectDialog\">Report Management</h5>\r\n                          <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n                        </div>\r\n                        <div class=\"modal-body\">\r\n                          Do you want to reject {{report.author.name + \" \" + report.author.surname}}'s report for {{report.subjectName}}?\r\n                        </div>\r\n                        <div class=\"modal-footer\">\r\n                          <button type=\"button\" class=\"btn btn-red\" style=\"margin-right: 2vh;\" data-bs-dismiss=\"modal\">No</button>\r\n                          <button type=\"button\" class=\"btn\" @click=\"manageReport(report.id, false)\" data-bs-dismiss=\"modal\">Yes</button>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n              </tbody>\r\n            </table>\r\n            <nav aria-label=\"Page navigation\">\r\n              <ul class=\"pagination justify-content-center mt-3\">\r\n                <li class=\"page-item\" v-if=\"totalPages > 1\"><button class=\"page-link\" :disabled=\"currentPage===0\" @click=\"previousPage\">Previous</button></li>\r\n                <li class=\"page-item mt-auto me-1 ms-1\" v-if=\"currentPage > 1 && totalPages > 3\">...</li>\r\n                <li class=\"page-item\"><button class=\"page-link\" :disabled=\"currentPage === 0\" @click=\"numberedPage(1)\">{{button1Content}}</button></li>\r\n                <li class=\"page-item\" v-if=\"totalPages > 1\"><button class=\"page-link\" :disabled=\"currentPage !== 0 && totalPages - currentPage > 1\" @click=\"numberedPage(2)\">{{button2Content}}</button></li>\r\n                <li class=\"page-item\" v-if=\"totalPages > 2\"><button class=\"page-link\" :disabled=\"totalPages - currentPage === 1\" @click=\"numberedPage(3)\">{{button3Content}}</button></li>\r\n                <li class=\"page-item mt-auto me-1 ms-1\" v-if=\"totalPages - currentPage > 1 && totalPages > 3 && button3Content !== totalPages\">...</li>\r\n                <li class=\"page-item\" v-if=\"totalPages > 1\"><button class=\"page-link\" :disabled=\"totalPages - currentPage === 1\" @click=\"nextPage\">Next</button></li>\r\n              </ul>\r\n            </nav>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"col-1\"></div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {FontAwesomeIcon} from \"@fortawesome/vue-fontawesome\";\r\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\r\nimport {faFilter, faX, faCheck, faBan, faPaperPlane} from \"@fortawesome/free-solid-svg-icons\";\r\nimport axios from \"axios\";\r\nimport {useStore} from \"vuex\";\r\nimport {toggleProcessing} from \"@/components/state\";\r\n\r\nlibrary.add(faFilter, faX, faCheck, faBan, faPaperPlane);\r\n\r\nexport default {\r\n  name: \"AdminReportsView\",\r\n  components: {FontAwesomeIcon},\r\n  data() {\r\n    return {\r\n      reports: [],\r\n      currentPage: 0,\r\n      totalPages: null,\r\n      pageSize: 10,\r\n      filterAuthor: null,\r\n      filterActive: false,\r\n      response: null\r\n    }\r\n  },\r\n  mounted() {\r\n    const store = useStore();\r\n    axios.get(\"/Reports/getReports\", {headers: {\r\n        Authorization: \"Bearer \" + store.getters.access_token,\r\n      },\r\n      params: {\r\n        page: this.currentPage,\r\n        pageSize: this.pageSize\r\n      }\r\n    })\r\n        .then(response => {\r\n          this.reports = response.data.content;\r\n          this.currentPage = response.data.currentPage;\r\n          this.totalPages = response.data.pages;\r\n        })\r\n        .catch(() =>{\r\n          this.$notify({\r\n            title: \"Server error\",\r\n            text: \"Server is currently off. Please try again later...\",\r\n            type: \"error\"\r\n          });\r\n        });\r\n  },\r\n  methods: {\r\n    manageReport(reportId, accepted, response) {\r\n      toggleProcessing();\r\n      response = response===undefined?\"\":response;\r\n      console.log(\"response: '\" + response +\"'\");\r\n      axios.put(\"/Reports/manageReport\", null,{\r\n        headers: {\r\n          Authorization: \"Bearer \" + this.$store.getters.access_token,\r\n        },\r\n        params: {\r\n          id: reportId,\r\n          accepted: accepted,\r\n          response: response\r\n        }\r\n      })\r\n          .then((response) => {\r\n            this.$notify( {\r\n              title: \"Successfully managed\",\r\n              text: \"You have successfully\" + (accepted?\"accepted\":\"rejected\") + \" the report with id \" + response.data.id + \".\",\r\n              position: \"bottom right\",\r\n              type: \"success\"\r\n            });\r\n            this.refreshPage();\r\n            toggleProcessing();\r\n          })\r\n          .catch((error) => {\r\n            if (!error.response) {\r\n              this.$notify({\r\n                title: \"Server error\",\r\n                text: \"Server is currently off. Please try again later...\",\r\n                type: \"error\"\r\n              });\r\n            } else if (error.response.status === 500) {\r\n              this.$notify({\r\n                title: \"Internal Server Error\",\r\n                text: \"Something went wrong on the server! Please try again later...\",\r\n                position: \"bottom right\",\r\n                type: \"error\"\r\n              });\r\n            } else if (error.response.status === 409) {\r\n              this.$notify({\r\n                title: \"Conflict\",\r\n                text: \"We are sorry, but another administrator has already managed the report.\",\r\n                position: \"bottom right\",\r\n                type: \"warn\"\r\n              });\r\n              this.refreshPage();\r\n            }\r\n            toggleProcessing();\r\n          })\r\n    },\r\n    filterButtonClicked() {\r\n      if (this.filterActive) {\r\n        this.filterAuthor = null\r\n        this.filterActive = !this.filterActive;\r\n        this.refreshPage();\r\n      } else if (this.filterAuthor !== null) {\r\n        this.filterActive = !this.filterActive;\r\n        this.refreshPage();\r\n      }\r\n    },\r\n    userRole(user) {\r\n      if (user.userType === \"Instructor\") {\r\n        return \"Fishing Instructor\";\r\n      } else if (user.userType === \"VacationRentalOwner\") {\r\n        return \"House Owner\";\r\n      } else if (user.userType === \"BoatOwner\") {\r\n        return \"Boat Owner\";\r\n      } else if (user.userType === \"SuperAdmin\") {\r\n        return \"Supreme Admin\";\r\n      } else {\r\n        return user.userType;\r\n      }\r\n    },\r\n    previousPage() {\r\n      this.currentPage -= 1;\r\n      this.refreshPage();\r\n    },\r\n    nextPage() {\r\n      this.currentPage += 1;\r\n      this.refreshPage();\r\n    },\r\n    numberedPage(buttonNumber) {\r\n      if (buttonNumber === 1) {\r\n        this.currentPage = this.button1Content - 1;\r\n      } else if (buttonNumber === 2) {\r\n        this.currentPage = this.button2Content - 1;\r\n      } else if (buttonNumber === 3) {\r\n        this.currentPage = this.button3Content - 1;\r\n      }\r\n      this.refreshPage();\r\n    },\r\n    refreshPage() {\r\n      let params;\r\n      let url;\r\n      if (this.filterAuthor !== null) {\r\n        params = {\r\n          page: this.currentPage,\r\n          pageSize: this.pageSize,\r\n          userType: this.filterAuthor,\r\n        };\r\n        url = \"/Reports/getReportsFilter\";\r\n      } else {\r\n        params = {\r\n          page: this.currentPage,\r\n          pageSize: this.pageSize\r\n        };\r\n        url = \"/Reports/getReports\";\r\n      }\r\n      axios.get(url, {headers: {\r\n          Authorization: \"Bearer \" + this.$store.getters.access_token,\r\n        },\r\n        params\r\n      })\r\n          .then(response => {\r\n            this.reports = response.data.content;\r\n            this.currentPage = response.data.currentPage;\r\n            this.totalPages = response.data.pages;\r\n          })\r\n          .catch(() =>{\r\n            this.$notify({\r\n              title: \"Server error\",\r\n              text: \"Server is currently off. Please try again later...\",\r\n              type: \"error\"\r\n            });\r\n          });\r\n    }\r\n  },\r\n  computed: {\r\n    button1Content() {\r\n      return this.currentPage === 0 ? this.currentPage+1: this.totalPages - this.currentPage === 1 ? this.currentPage - 1 : this.currentPage;\r\n    },\r\n    button2Content() {\r\n      return this.currentPage === 0 ? this.currentPage+2: this.totalPages - this.currentPage === 1 ? this.currentPage : this.currentPage+1;\r\n    },\r\n    button3Content() {\r\n      return this.currentPage === 0 ? this.currentPage+3: this.totalPages - this.currentPage === 1 ? this.currentPage + 1 : this.currentPage+2;\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\nlabel {\r\n  color: #008970;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}