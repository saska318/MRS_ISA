{"ast":null,"code":"import { Calendar } from 'v-calendar';\nimport { useStore } from \"vuex\";\nimport axios from \"axios\";\nexport default {\n  name: \"ReservationsCalendarView\",\n  components: {\n    Calendar\n  },\n\n  data() {\n    return {\n      reservations: null,\n      colors: [\"gray\", \"red\", \"yellow\", \"green\", \"teal\", \"blue\", \"indigo\", \"purple\", \"pink\"],\n      colorsAndRentals: {},\n      colorsLoaded: false,\n      descriptionsAndReservations: {},\n      attributes: [{\n        key: 'today',\n        highlight: {\n          style: {\n            backgroundColor: \"#008970\"\n          },\n          contentStyle: {\n            color: \"#f7f7f2\"\n          }\n        },\n        dates: new Date(),\n        popover: {\n          label: \"Today\"\n        }\n      }],\n      selectedDate: null,\n      reservationsToShow: []\n    };\n  },\n\n  mounted() {\n    const store = useStore();\n    axios.get(\"/Reservations/getReservations\", {\n      headers: {\n        Authorization: \"Bearer \" + store.getters.access_token\n      }\n    }).then(response => {\n      this.reservations = response.data;\n      this.assignColors();\n      this.createDescriptions();\n      this.formAttributes();\n      this.colorsLoaded = true;\n    }).catch(() => {\n      this.$notify({\n        title: \"Server error\",\n        text: \"Server is currently off. Please try again later...\",\n        type: \"error\"\n      });\n    });\n  },\n\n  methods: {\n    viewDay(day) {\n      this.reservationsToShow = [];\n      this.selectedDate = {\n        id: day.id,\n        date: Date.parse(day.id)\n      };\n      this.reservations.forEach(reservation => {\n        if (reservation.initDate.split(\"T\")[0] === day.id) {\n          this.reservationsToShow.push(reservation);\n        }\n      });\n    },\n\n    assignColors() {\n      let rentalObjects = this.rentalObjects;\n      let availableColors = this.colors;\n      rentalObjects.forEach(rentalObject => {\n        if (availableColors.length === 0) {\n          availableColors = this.colors;\n        }\n\n        this.colorsAndRentals[rentalObject.id] = availableColors[0];\n        availableColors.splice(0, 1);\n      });\n    },\n\n    createDescriptions() {\n      this.reservations.forEach(reservation => {\n        let description = \"Client \";\n        description += reservation.client.name + \" \" + reservation.client.surname;\n        description += \" has booked '\" + reservation.rentalObject.name + \"' to \";\n        description += reservation.termDate + \".\";\n        this.descriptionsAndReservations[reservation.id] = description;\n      });\n    },\n\n    formAttributes() {\n      let dates = this.reservationInitDates;\n      this.reservations.forEach(reservation => {\n        this.attributes.push({\n          bar: this.colorsAndRentals[reservation.rentalObject.id],\n          dates: dates[reservation.id],\n          popover: {\n            label: this.descriptionsAndReservations[reservation.id]\n          }\n        });\n      });\n    },\n\n    formatDate(date) {\n      let formatted;\n      const parts = date.split(\"-\");\n      formatted = parts[2] + \".\" + parts[1] + \".\" + parts[0];\n      return formatted;\n    },\n\n    formatDateTime(dateTime) {\n      let formatted;\n      const bigParts = dateTime.split(\"T\");\n      const date = this.formatDate(bigParts[0]);\n      const time = bigParts[1].split(\":\");\n      formatted = date + \" \" + time[0] + \":\" + time[1];\n      return formatted;\n    },\n\n    getRentalObjectName(rentalObjectId) {\n      let reservation;\n\n      for (reservation in this.reservations) {\n        if (this.reservations[reservation].rentalObject.id === rentalObjectId) {\n          return this.reservations[reservation].rentalObject.name;\n        }\n      }\n    }\n\n  },\n  computed: {\n    rentalObjects() {\n      let rentalObjects = [];\n      this.reservations.forEach(reservation => {\n        if (rentalObjects.findIndex(value => {\n          return reservation.rentalObject.id === value.id;\n        }) === -1) {\n          rentalObjects.push(reservation.rentalObject);\n        }\n      });\n      return rentalObjects;\n    },\n\n    reservationInitDates() {\n      let initDates = {};\n      this.reservations.forEach(reservation => {\n        initDates[reservation.id] = Date.parse(reservation.initDate);\n      });\n      return initDates;\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["Calendar","useStore","axios","name","components","data","reservations","colors","colorsAndRentals","colorsLoaded","descriptionsAndReservations","attributes","key","highlight","style","backgroundColor","contentStyle","color","dates","Date","popover","label","selectedDate","reservationsToShow","mounted","store","get","headers","Authorization","getters","access_token","then","response","assignColors","createDescriptions","formAttributes","catch","$notify","title","text","type","methods","viewDay","day","id","date","parse","forEach","reservation","initDate","split","push","rentalObjects","availableColors","rentalObject","length","splice","description","client","surname","termDate","reservationInitDates","bar","formatDate","formatted","parts","formatDateTime","dateTime","bigParts","time","getRentalObjectName","rentalObjectId","computed","findIndex","value","initDates"],"sourceRoot":"","sources":["C:\\Users\\Sa≈°ka\\Downloads\\MRS_ISA\\isa_mrs_projekat_front\\src\\components\\RentalObjectOwner\\ReservationsCalendarView.vue"],"sourcesContent":["<template>\r\n  <div class=\"row\">\r\n    <div class=\"col-1\"></div>\r\n    <div class=\"col-10 pt-5 mb-5\">\r\n      <div class=\"container-fluid pe-0 ps-0 me-0 ms-0\">\r\n        <div class=\"row\">\r\n          <div class=\"col text-center\">\r\n            <calendar :attributes=\"attributes\" :first-day-of-week=\"2\"\r\n                      :columns=\"2\"\r\n                      :rows=\"2\"\r\n            @dayclick=\"viewDay\"/>\r\n            <div v-if=\"colorsLoaded\" class=\"mt-3\">\r\n              <h4>Color chart</h4>\r\n              <div class=\"row\">\r\n                <div class=\"col\"></div>\r\n                <table class=\"col-4 text-center align-content-center rounded\" style=\"border: 1px solid #008970\">\r\n                  <thead>\r\n                  <tr>\r\n                    <th>Color</th>\r\n                    <th>Rental</th>\r\n                  </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                  <tr v-for=\"(rental, index) in rentalObjects\" :key=\"index\">\r\n                    <td><div class=\"rounded-circle shadow m-auto\" :style=\"{'background-color': colorsAndRentals[rental.id]}\" style=\"height: 2vh; width: 2vh\"></div></td>\r\n                    <td>{{rental.name}}</td>\r\n                  </tr>\r\n                  </tbody>\r\n                </table>\r\n                <div class=\"col\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col\">\r\n            <div v-if=\"selectedDate!==null\" class=\"container px-4 py-3 rounded form text-center\">\r\n              <h3>Reservations</h3>\r\n              <div v-for=\"(reservation, index) in reservationsToShow\" :key=\"index\">\r\n                <div class=\"container rounded mb-1 p-0 shadow\" style=\"color: black; background-color: white\" :style=\"{'border-left': '5px solid ' + colorsAndRentals[reservation.rentalObject.id]}\">\r\n                  <div class=\"row\">\r\n                    <div class=\"col text-start mt-3 ms-3\">Rental Object: <router-link class=\"link\" :to=\"'/fishingInstructor/Adventure/' + reservation.rentalObject.id\">{{reservation.rentalObject.name}}</router-link></div>\r\n                    <div class=\"col text-end mt-3 me-3\">{{formatDateTime(reservation.timeStamp)}}</div>\r\n                  </div>\r\n                  <hr>\r\n                  <div class=\"row ms-3\">\r\n                    <div class=\"col text-start m-0 p-0\">Client: {{reservation.client.name + \" \" + reservation.client.surname + \" (\" + reservation.client.email + \")\"}}</div>\r\n                  </div>\r\n                  <div class=\"row ms-3\">\r\n                    Period: {{formatDateTime(reservation.initDate) + \"-\" + formatDateTime(reservation.termDate)}}\r\n                  </div>\r\n                  <div class=\"row ms-3 mb-3\">\r\n                    People: {{reservation.people}}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { Calendar } from 'v-calendar';\r\nimport {useStore} from \"vuex\";\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  name: \"ReservationsCalendarView\",\r\n  components: {\r\n    Calendar\r\n  },\r\n  data() {\r\n    return {\r\n      reservations: null,\r\n      colors: [\"gray\", \"red\", \"yellow\", \"green\", \"teal\", \"blue\", \"indigo\", \"purple\", \"pink\"],\r\n      colorsAndRentals: {},\r\n      colorsLoaded: false,\r\n      descriptionsAndReservations: {},\r\n      attributes: [\r\n        {\r\n          key: 'today',\r\n          highlight: {\r\n            style: {\r\n              backgroundColor: \"#008970\",\r\n            },\r\n            contentStyle: {\r\n              color: \"#f7f7f2\"\r\n            }\r\n          },\r\n          dates: new Date(),\r\n          popover: {\r\n            label: \"Today\"\r\n          }\r\n        }\r\n      ],\r\n      selectedDate: null,\r\n      reservationsToShow: []\r\n    }\r\n  },\r\n  mounted() {\r\n    const store = useStore();\r\n    axios.get(\"/Reservations/getReservations\", {headers: {\r\n        Authorization: \"Bearer \" + store.getters.access_token,\r\n      }\r\n    })\r\n    .then(response => {\r\n      this.reservations = response.data;\r\n      this.assignColors();\r\n      this.createDescriptions();\r\n      this.formAttributes();\r\n      this.colorsLoaded = true;\r\n    })\r\n    .catch(() =>{\r\n      this.$notify({\r\n        title: \"Server error\",\r\n        text: \"Server is currently off. Please try again later...\",\r\n        type: \"error\"\r\n      });\r\n    });\r\n  },\r\n  methods: {\r\n    viewDay(day) {\r\n      this.reservationsToShow = [];\r\n      this.selectedDate = {id:day.id, date:Date.parse(day.id)}\r\n      this.reservations.forEach(reservation => {\r\n        if (reservation.initDate.split(\"T\")[0] === day.id) {\r\n          this.reservationsToShow.push(reservation);\r\n        }\r\n      })\r\n    },\r\n    assignColors() {\r\n      let rentalObjects = this.rentalObjects;\r\n      let availableColors = this.colors;\r\n      rentalObjects.forEach(rentalObject => {\r\n        if (availableColors.length === 0) {\r\n          availableColors = this.colors;\r\n        }\r\n        this.colorsAndRentals[rentalObject.id] = availableColors[0];\r\n        availableColors.splice(0, 1);\r\n      })\r\n    },\r\n    createDescriptions() {\r\n      this.reservations.forEach(reservation => {\r\n        let description = \"Client \";\r\n        description += reservation.client.name + \" \" + reservation.client.surname;\r\n        description += \" has booked '\" + reservation.rentalObject.name + \"' to \";\r\n        description += reservation.termDate + \".\";\r\n        this.descriptionsAndReservations[reservation.id] = description;\r\n      })\r\n    },\r\n    formAttributes() {\r\n      let dates = this.reservationInitDates;\r\n      this.reservations.forEach(reservation => {\r\n        this.attributes.push(\r\n            {\r\n              bar: this.colorsAndRentals[reservation.rentalObject.id],\r\n              dates:dates[reservation.id],\r\n              popover: {\r\n                label: this.descriptionsAndReservations[reservation.id]\r\n              }\r\n            });\r\n      })\r\n    },\r\n    formatDate(date) {\r\n      let formatted;\r\n      const parts = date.split(\"-\");\r\n      formatted = parts[2] + \".\" + parts[1] + \".\" + parts[0];\r\n      return formatted;\r\n    },\r\n    formatDateTime(dateTime) {\r\n      let formatted;\r\n      const bigParts = dateTime.split(\"T\")\r\n      const date = this.formatDate(bigParts[0]);\r\n      const time = bigParts[1].split(\":\");\r\n      formatted = date + \" \" + time[0] + \":\" + time[1];\r\n      return formatted;\r\n    },\r\n    getRentalObjectName(rentalObjectId) {\r\n      let reservation;\r\n      for (reservation in this.reservations) {\r\n        if (this.reservations[reservation].rentalObject.id === rentalObjectId) {\r\n          return this.reservations[reservation].rentalObject.name;\r\n        }\r\n      }\r\n    },\r\n  },\r\n  computed: {\r\n    rentalObjects() {\r\n      let rentalObjects = [];\r\n      this.reservations.forEach(reservation => {\r\n        if (rentalObjects.findIndex( value => {return reservation.rentalObject.id === value.id;}) === -1) {\r\n          rentalObjects.push(reservation.rentalObject);\r\n        }\r\n      });\r\n      return rentalObjects;\r\n    },\r\n    reservationInitDates() {\r\n      let initDates = {};\r\n      this.reservations.forEach(reservation => {\r\n        initDates[reservation.id] = Date.parse(reservation.initDate);\r\n      })\r\n      return initDates;\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n  .link {\r\n    border: none;\r\n    color: #008970;\r\n  }\r\n\r\n  .link:active, .link:hover, .link:focus {\r\n    border: none;\r\n    color: #008970;\r\n  }\r\n</style>"]},"metadata":{},"sourceType":"module"}