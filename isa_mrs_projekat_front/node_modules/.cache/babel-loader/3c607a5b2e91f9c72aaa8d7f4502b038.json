{"ast":null,"code":"import StarRating from \"vue-star-rating\";\nimport store from \"@/store\";\nimport axios from \"axios/index\";\nexport default {\n  name: \"ReservationReview\",\n  props: [\"id\", \"reviews\", \"resId\"],\n  components: {\n    StarRating\n  },\n\n  data() {\n    return {\n      isSaved: false,\n      saveButtonTxt: \"Save\",\n      closeButtonTxt: \"Cancel\",\n      ownerGradeMissing: false,\n      rentalGradeMissing: false,\n      // newPlaceholder: \"No comment.\",\n      newReviews: {\n        reservationId: this.resId,\n        ownerReview: {\n          grade: null,\n          comment: null\n        },\n        rentalReview: {\n          grade: null,\n          comment: null\n        }\n      }\n    };\n  },\n\n  mounted() {\n    this.newReviews.ownerReview.comment = this.getOwnerComment;\n    this.newReviews.rentalReview.comment = this.getRentalComment;\n  },\n\n  methods: {\n    save() {\n      this.newReviews.ownerReview.comment = document.getElementById(\"insertOwnerComment\" + this.resId).value;\n      this.newReviews.rentalReview.comment = document.getElementById(\"insertRentalComment\" + this.resId).value;\n      if (!this.saveChecks()) this.saveReviews();\n    },\n\n    saveChecks() {\n      this.ownerGradeMissing = false;\n      this.rentalGradeMissing = false;\n      if (this.newReviews.ownerReview.grade === null) this.ownerGradeMissing = true;\n      if (this.newReviews.rentalReview.grade === null) this.rentalGradeMissing = true;\n      return this.ownerGradeMissing || this.rentalGradeMissing;\n    },\n\n    saveReviews() {\n      axios.post(\"/Reservations/addReview\", this.newReviews, {\n        headers: {\n          Authorization: \"Bearer \" + this.accessToken\n        }\n      }).then(() => {\n        this.saveButtonTxt = \"Saved!\";\n        this.isSaved = true;\n        this.closeButtonTxt = \"Close\";\n      }).catch(error => {\n        if (error.response.status === 404) {\n          this.$notify({\n            title: \"Invalid Status\",\n            text: \"Something went wrong. Try again later.\",\n            position: \"bottom right\",\n            type: \"warn\"\n          });\n        } else if (error.response.status === 500) {\n          this.$notify({\n            title: \"Internal Server Error\",\n            text: \"Something went wrong on the server! Please try again later...\",\n            position: \"bottom right\",\n            type: \"error\"\n          });\n        }\n      });\n    }\n\n  },\n  computed: {\n    accessToken() {\n      return store.state.access_token;\n    },\n\n    isReviewPresent() {\n      for (let i = 0; i < this.reviews.length; i++) if (this.reviews[i].reviewType === \"OwnerReview\" || this.reviews[i].reviewType === \"RentalReview\") return true;\n\n      return false;\n    },\n\n    getOwnerGrade() {\n      let grade = 0;\n\n      for (let i = 0; i < this.reviews.length; i++) if (this.reviews[i].reviewType === \"OwnerReview\") grade = this.reviews[i].grade;\n\n      return grade;\n    },\n\n    getRentalGrade() {\n      let grade = 0;\n\n      for (let i = 0; i < this.reviews.length; i++) if (this.reviews[i].reviewType === \"RentalReview\") grade = this.reviews[i].grade;\n\n      return grade;\n    },\n\n    getOwnerComment() {\n      let comment = \"\";\n\n      for (let i = 0; i < this.reviews.length; i++) if (this.reviews[i].reviewType === \"OwnerReview\") comment = this.reviews[i].comment;\n\n      return comment;\n    },\n\n    getRentalComment() {\n      let comment = \"\";\n\n      for (let i = 0; i < this.reviews.length; i++) if (this.reviews[i].reviewType === \"RentalReview\") comment = this.reviews[i].comment;\n\n      return comment;\n    },\n\n    ownerCommentExists() {\n      return !(this.getOwnerComment === \"\");\n    },\n\n    rentalCommentExists() {\n      return !(this.getRentalComment === \"\");\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["StarRating","store","axios","name","props","components","data","isSaved","saveButtonTxt","closeButtonTxt","ownerGradeMissing","rentalGradeMissing","newReviews","reservationId","resId","ownerReview","grade","comment","rentalReview","mounted","getOwnerComment","getRentalComment","methods","save","document","getElementById","value","saveChecks","saveReviews","post","headers","Authorization","accessToken","then","catch","error","response","status","$notify","title","text","position","type","computed","state","access_token","isReviewPresent","i","reviews","length","reviewType","getOwnerGrade","getRentalGrade","ownerCommentExists","rentalCommentExists"],"sourceRoot":"","sources":["C:\\Users\\SaÅ¡ka\\Downloads\\MRS_ISA\\isa_mrs_projekat_front\\src\\components\\Client\\ClientPage\\components\\ClientProfile\\ClientReservations\\ReservationReview.vue"],"sourcesContent":["<template>\r\n  <div v-if=\"this.reviews\" class=\"modal fade\" :id=\"'review-'+this.id\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\r\n    <div class=\"modal-dialog modal-dialog-centered modal-dialog-scrollable\">\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header p-0 m-0\" style=\"border-bottom: none\">\r\n        </div>\r\n        <div class=\"modal-body pt-0 mt-0\">\r\n          <div class=\"row text-center pb-0 mb-0\" style=\"border-bottom: 1px solid lightgray;\">\r\n            <h1 class=\"modal-title pb-1\" style=\"color:#ffd055; font-weight: 700;\">Reviews</h1>\r\n          </div>\r\n          <div>\r\n            <p class=\"h5 mt-3\">What did you think about the owner/instructor?</p>\r\n          </div>\r\n          <div class=\"row my-0 py-0 my-3\" >\r\n            <div class=\"col-12 d-flex justify-content-center align-items-center\">\r\n              <star-rating text-class=\"h1 my-0 font-weight-normal\" :round-start-rating=\"false\"\r\n                           :glow=\"5\" glow-color=\"#ffd055\" :star-size=\"50\"\r\n                           :read-only=\"isReviewPresent || isSaved\"\r\n                           :rating=\"getOwnerGrade\"\r\n                           v-model:rating=\"this.newReviews.ownerReview.grade\"></star-rating>\r\n            </div>\r\n            <div v-if=\"ownerGradeMissing\" id=\"missingOwnerGradeMessage\" class=\"row text-center\">\r\n              <p class=\"h6 mt-3\" style=\"color: #e23c52\"><strong>You must select a grade.</strong></p>\r\n            </div>\r\n          </div>\r\n          <textarea id=\"ownerCommentExists\" v-if=\"isReviewPresent\" :hidden=\"!ownerCommentExists\"\r\n                    :value=\"this.newReviews.ownerReview.comment\" disabled\r\n                    rows=\"3\" class=\"w-100 p-2 px-3\"\r\n                    style=\"background-color:#ffd055; border-radius: 20px; resize: none;\" maxlength=\"1000\" ></textarea>\r\n          <textarea :id=\"'insertOwnerComment'+this.resId\" v-if=\"!isReviewPresent\"\r\n                    :content=\"this.newReviews.ownerReview.comment\" :disabled=\"isSaved\"\r\n                    rows=\"3\" placeholder=\"Leave a review here\" class=\"w-100 p-2 px-3\"\r\n                    style=\"background-color:#ffd055; border-radius: 20px; resize: none;\" maxlength=\"1000\" ></textarea>\r\n          <div>\r\n            <p class=\"h5 mt-3\">What was your experience like?</p>\r\n          </div>\r\n          <div class=\"row my-0 py-0  my-3\">\r\n            <div class=\"col-12 d-flex justify-content-center align-items-center\">\r\n              <star-rating text-class=\"h1 my-0 font-weight-normal\" :round-start-rating=\"false\"\r\n                           :glow=\"5\" glow-color=\"#ffd055\" :star-size=\"50\"\r\n                           :read-only=\"isReviewPresent || isSaved\"\r\n                           :rating=\"getRentalGrade\"\r\n                           v-model:rating=\"this.newReviews.rentalReview.grade\"></star-rating>\r\n            </div>\r\n            <div v-if=\"rentalGradeMissing\" id=\"missingRentalGradeMessage\" class=\"row text-center\">\r\n              <p class=\"h6 mt-3\" style=\"color: #e23c52\"><strong>You must select a grade.</strong></p>\r\n            </div>\r\n          </div>\r\n          <textarea id=\"rentalCommentExists\" v-if=\"isReviewPresent\" :hidden=\"!rentalCommentExists\"\r\n                    :value=\"this.newReviews.rentalReview.comment\" disabled\r\n                    rows=\"3\" class=\"w-100 p-2 px-3\"\r\n                    style=\"background-color:#ffd055; border-radius: 20px; resize: none;\" maxlength=\"1000\" ></textarea>\r\n\r\n          <textarea :id=\"'insertRentalComment'+this.resId\" v-if=\"!isReviewPresent\"\r\n                    :content=\"this.newReviews.rentalReview.comment\" :disabled=\"isSaved\"\r\n                    rows=\"3\" placeholder=\"Leave a review here\" class=\"w-100 p-2 px-3\"\r\n                    style=\"background-color:#ffd055; border-radius: 20px; resize: none;\" maxlength=\"1000\" ></textarea>\r\n\r\n        </div>\r\n        <div class=\"modal-footer d-flex\" style=\"border-top: none; justify-content: space-evenly\">\r\n          <button v-if=\"!isReviewPresent\" type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\"\r\n                  style=\"background-color: #e23c52; color: white; width: 40%\">{{ this.closeButtonTxt }}</button>\r\n          <button :disabled=\"this.isSaved\" v-if=\"!isReviewPresent\" type=\"button\" class=\"btn btn-secondary\"\r\n                  style=\"color: white; width: 40%\" @click=\"save\">{{ this.saveButtonTxt }}\r\n          </button>\r\n          <button v-if=\"isReviewPresent\" type=\"button\" class=\"btn btn-secondary w-100\" data-bs-dismiss=\"modal\"\r\n                  style=\"color: white;\">Close</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport StarRating from \"vue-star-rating\";\r\n\r\nimport store from \"@/store\";\r\nimport axios from \"axios/index\";\r\n\r\nexport default {\r\n  name: \"ReservationReview\",\r\n  props: [\"id\", \"reviews\", \"resId\"],\r\n  components: {StarRating},\r\n  data() {\r\n    return {\r\n      isSaved: false,\r\n      saveButtonTxt: \"Save\",\r\n      closeButtonTxt: \"Cancel\",\r\n      ownerGradeMissing: false,\r\n      rentalGradeMissing: false,\r\n      // newPlaceholder: \"No comment.\",\r\n      newReviews: {\r\n        reservationId: this.resId,\r\n        ownerReview: {\r\n          grade: null,\r\n          comment: null,\r\n        },\r\n        rentalReview: {\r\n          grade: null,\r\n          comment: null,\r\n        },\r\n      },\r\n    }\r\n  },\r\n  mounted() {\r\n    this.newReviews.ownerReview.comment = this.getOwnerComment;\r\n    this.newReviews.rentalReview.comment = this.getRentalComment;\r\n  },\r\n  methods: {\r\n    save() {\r\n      this.newReviews.ownerReview.comment = document.getElementById(\"insertOwnerComment\"+this.resId).value;\r\n      this.newReviews.rentalReview.comment = document.getElementById(\"insertRentalComment\"+this.resId).value;\r\n      if(!this.saveChecks()) this.saveReviews();\r\n    },\r\n    saveChecks() {\r\n      this.ownerGradeMissing = false;\r\n      this.rentalGradeMissing = false;\r\n      if(this.newReviews.ownerReview.grade === null) this.ownerGradeMissing = true;\r\n      if(this.newReviews.rentalReview.grade === null) this.rentalGradeMissing = true;\r\n      return this.ownerGradeMissing || this.rentalGradeMissing;\r\n    },\r\n    saveReviews() {\r\n      axios.post(\"/Reservations/addReview\", this.newReviews, {\r\n        headers: {\r\n          Authorization: \"Bearer \" + this.accessToken,\r\n        }\r\n      })\r\n      .then(() => {\r\n        this.saveButtonTxt = \"Saved!\";\r\n        this.isSaved = true;\r\n        this.closeButtonTxt = \"Close\";\r\n      })\r\n      .catch(error => {\r\n        if (error.response.status === 404) {\r\n          this.$notify({\r\n            title: \"Invalid Status\",\r\n            text: \"Something went wrong. Try again later.\",\r\n            position: \"bottom right\",\r\n            type: \"warn\"\r\n          })\r\n        } else if (error.response.status === 500) {\r\n          this.$notify({\r\n            title: \"Internal Server Error\",\r\n            text: \"Something went wrong on the server! Please try again later...\",\r\n            position: \"bottom right\",\r\n            type: \"error\"\r\n          })\r\n        }\r\n      })\r\n    },\r\n  },\r\n  computed: {\r\n    accessToken() {\r\n      return store.state.access_token;\r\n    },\r\n    isReviewPresent() {\r\n      for(let i=0; i<this.reviews.length; i++)\r\n        if(this.reviews[i].reviewType === \"OwnerReview\" || this.reviews[i].reviewType === \"RentalReview\") return true;\r\n      return false;\r\n    },\r\n    getOwnerGrade() {\r\n      let grade = 0;\r\n      for(let i=0; i<this.reviews.length; i++)\r\n        if(this.reviews[i].reviewType === \"OwnerReview\") grade = this.reviews[i].grade;\r\n      return grade;\r\n    },\r\n    getRentalGrade() {\r\n      let grade = 0;\r\n      for(let i=0; i<this.reviews.length; i++)\r\n        if(this.reviews[i].reviewType === \"RentalReview\") grade = this.reviews[i].grade;\r\n      return grade;\r\n    },\r\n    getOwnerComment() {\r\n      let comment = \"\";\r\n      for(let i=0; i<this.reviews.length; i++)\r\n        if(this.reviews[i].reviewType === \"OwnerReview\") comment = this.reviews[i].comment;\r\n      return comment;\r\n    },\r\n    getRentalComment() {\r\n      let comment = \"\";\r\n      for(let i=0; i<this.reviews.length; i++)\r\n        if(this.reviews[i].reviewType === \"RentalReview\") comment = this.reviews[i].comment;\r\n      return comment;\r\n    },\r\n    ownerCommentExists() {\r\n      return !(this.getOwnerComment === \"\");\r\n    },\r\n    rentalCommentExists() {\r\n      return !(this.getRentalComment === \"\");\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\ntextarea {\r\n  color: white;\r\n  font-style: italic;\r\n  font-weight: 500;\r\n  text-align: justify;\r\n}\r\n\r\ntextarea::placeholder {\r\n  color: white;\r\n  font-weight: 400;\r\n}\r\n\r\nbutton:disabled {\r\n  background-color: #008970;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}