{"ast":null,"code":"import { FontAwesomeIcon } from \"@fortawesome/vue-fontawesome\";\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\nimport { faUserPlus, faEye } from \"@fortawesome/free-solid-svg-icons\";\nimport { useStore } from \"vuex\";\nimport axios from \"axios\";\nimport store from \"@/store\";\nimport { toggleLoading, toggleProcessing } from \"@/components/state\";\nlibrary.add(faUserPlus, faEye);\nexport default {\n  name: \"AdminUsersView\",\n  components: {\n    FontAwesomeIcon\n  },\n\n  data() {\n    return {\n      users: [],\n      selectedUser: null,\n      selectedUsersRole: null,\n      changedUsers: [],\n      imageUrls: [],\n      currentPage: 0,\n      totalPages: null,\n      pageSize: 10\n    };\n  },\n\n  methods: {\n    loadImage(name, index) {\n      axios.get(\"/Photos/\", {\n        headers: {\n          Authorization: \"Bearer \" + this.$store.getters.access_token\n        },\n        params: {\n          path: name\n        },\n        responseType: \"blob\"\n      }).then(response => {\n        this.imageUrls[index] = URL.createObjectURL(response.data);\n      }).catch(error => {\n        console.log(error);\n      });\n    },\n\n    saveChanges() {\n      toggleProcessing();\n      let ids = this.changedUsersIds;\n      let lwc = {\n        list: ids\n      };\n      axios.put(\"/Users/multipleUserStatusChange\", lwc, {\n        headers: {\n          Authorization: \"Bearer \" + store.state.access_token\n        }\n      }).then(response => {\n        let message = \"You have successfully changed status for users:\";\n        response.data.forEach(user => {\n          message += \" \" + user.name + \" \" + user.surname + \",\";\n        });\n        message = message.slice(0, -1);\n        message += \".\";\n        this.$notify({\n          title: \"Status Change Successful\",\n          text: message,\n          type: \"success\"\n        });\n        this.changedUsers = [];\n        toggleProcessing();\n      }).catch(() => {\n        this.$notify({\n          title: \"Server error\",\n          text: \"Something went wrong. Please try again later...\",\n          type: \"error\"\n        });\n        toggleProcessing();\n      });\n    },\n\n    changedStatus(user) {\n      let index = this.changedUsers.findIndex(element => element.id === user.id);\n\n      if (index > -1) {\n        this.changedUsers.splice(index, 1);\n      } else {\n        this.changedUsers.push(user);\n      }\n    },\n\n    userRole(user) {\n      if (user.userType === \"Instructor\") {\n        return \"Fishing Instructor\";\n      } else if (user.userType === \"VacationRentalOwner\") {\n        return \"House Owner\";\n      } else if (user.userType === \"BoatOwner\") {\n        return \"Boat Owner\";\n      } else if (user.userType === \"SuperAdmin\") {\n        return \"Supreme Admin\";\n      } else {\n        return user.userType;\n      }\n    },\n\n    userIsChanged(userId) {\n      let index = this.changedUsers.findIndex(element => element.id === userId);\n      return index > -1;\n    },\n\n    nextPage() {\n      this.currentPage += 1;\n      this.refreshPage();\n    },\n\n    previousPage() {\n      this.currentPage -= 1;\n      this.refreshPage();\n    },\n\n    numberedPage(buttonNumber) {\n      if (buttonNumber === 1) {\n        this.currentPage = this.button1Content - 1;\n      } else if (buttonNumber === 2) {\n        this.currentPage = this.button2Content - 1;\n      } else if (buttonNumber === 3) {\n        this.currentPage = this.button3Content - 1;\n      }\n\n      this.refreshPage();\n    },\n\n    refreshPage() {\n      toggleLoading();\n      axios.get(\"/Users/getUsersPage\", {\n        headers: {\n          Authorization: \"Bearer \" + this.$store.getters.access_token\n        },\n        params: {\n          page: this.currentPage,\n          pageSize: this.pageSize\n        }\n      }).then(response => {\n        this.users = response.data.content;\n        this.changedUsers.forEach(user => {\n          this.users.forEach(user1 => {\n            if (user.id === user1.id && user.isActive !== user1.isActive) {\n              user1.isActive = user.isActive;\n            }\n          });\n        });\n        this.currentPage = response.data.currentPage;\n        this.totalPages = response.data.pages;\n        toggleLoading();\n      }).catch(() => {\n        this.$notify({\n          title: \"Server error\",\n          text: \"Server is currently off. Please try again later...\",\n          type: \"error\"\n        });\n        toggleLoading();\n      });\n    }\n\n  },\n\n  mounted() {\n    toggleLoading();\n    const store = useStore();\n    axios.get(\"/Users/getUsersPage\", {\n      headers: {\n        Authorization: \"Bearer \" + store.state.access_token\n      },\n      params: {\n        page: this.currentPage,\n        pageSize: this.pageSize\n      }\n    }).then(response => {\n      this.users = response.data.content;\n      this.currentPage = response.data.currentPage;\n      this.totalPages = response.data.pages;\n      this.users.forEach(user => {\n        if (user.photo) {\n          const index = this.users.indexOf(user);\n          this.loadImage(user.photo, index);\n        }\n      });\n      toggleLoading();\n    }).catch(() => {\n      this.$notify({\n        title: \"Server error\",\n        text: \"Server is currently off. Please try again later...\",\n        type: \"error\"\n      });\n      toggleLoading();\n    });\n  },\n\n  computed: {\n    button1Content() {\n      return this.currentPage === 0 ? this.currentPage + 1 : this.totalPages - this.currentPage === 1 ? this.currentPage - 1 : this.currentPage;\n    },\n\n    button2Content() {\n      return this.currentPage === 0 ? this.currentPage + 2 : this.totalPages - this.currentPage === 1 ? this.currentPage : this.currentPage + 1;\n    },\n\n    button3Content() {\n      return this.currentPage === 0 ? this.currentPage + 3 : this.totalPages - this.currentPage === 1 ? this.currentPage + 1 : this.currentPage + 2;\n    },\n\n    isSuperAdmin() {\n      return store.state.isSuperAdmin;\n    },\n\n    hasChanged() {\n      return this.changedUsers.length > 0;\n    },\n\n    changedUsersIds() {\n      let ids = [];\n      this.changedUsers.forEach(user => {\n        ids.push(user.id);\n      });\n      return ids;\n    },\n\n    modalMessage() {\n      let numberOfDeletedUsers = this.numberOfDeletedUsers;\n      let numberOfActivatedUsers = this.numberOfActivatedUsers;\n      let deleteMessage = \"\";\n      let activateMessage = \"\";\n\n      if (numberOfDeletedUsers > 1) {\n        deleteMessage = \"Do you want to delete users:\";\n      } else if (numberOfDeletedUsers === 1) {\n        deleteMessage = \"Do you want to delete user:\";\n      }\n\n      if (numberOfActivatedUsers > 1) {\n        activateMessage = \"Do you want to activate users:\";\n      } else if (numberOfActivatedUsers === 1) {\n        activateMessage = \"Do you want to activate user:\";\n      }\n\n      this.changedUsers.forEach(user => {\n        if (!user.isActive) {\n          deleteMessage += \" \" + user.name + \" \" + user.surname + \",\\n\";\n        } else {\n          activateMessage += \" \" + user.name + \" \" + user.surname + \",\\n\";\n        }\n      });\n\n      if (numberOfDeletedUsers > 0) {\n        deleteMessage = deleteMessage.slice(0, -2);\n        deleteMessage += \"?\";\n      }\n\n      if (numberOfActivatedUsers > 0) {\n        activateMessage = activateMessage.slice(0, -2);\n        activateMessage += \"?\";\n      }\n\n      return deleteMessage + \"\\n\" + activateMessage;\n    },\n\n    numberOfDeletedUsers() {\n      let counter = 0;\n      this.changedUsers.forEach(user => {\n        if (!user.isActive) {\n          counter += 1;\n        }\n      });\n      return counter;\n    },\n\n    numberOfActivatedUsers() {\n      let counter = 0;\n      this.changedUsers.forEach(user => {\n        if (user.isActive) {\n          counter += 1;\n        }\n      });\n      return counter;\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["FontAwesomeIcon","library","faUserPlus","faEye","useStore","axios","store","toggleLoading","toggleProcessing","add","name","components","data","users","selectedUser","selectedUsersRole","changedUsers","imageUrls","currentPage","totalPages","pageSize","methods","loadImage","index","get","headers","Authorization","$store","getters","access_token","params","path","responseType","then","response","URL","createObjectURL","catch","error","console","log","saveChanges","ids","changedUsersIds","lwc","list","put","state","message","forEach","user","surname","slice","$notify","title","text","type","changedStatus","findIndex","element","id","splice","push","userRole","userType","userIsChanged","userId","nextPage","refreshPage","previousPage","numberedPage","buttonNumber","button1Content","button2Content","button3Content","page","content","user1","isActive","pages","mounted","photo","indexOf","computed","isSuperAdmin","hasChanged","length","modalMessage","numberOfDeletedUsers","numberOfActivatedUsers","deleteMessage","activateMessage","counter"],"sourceRoot":"","sources":["C:\\Users\\Saška\\Downloads\\MRS_ISA\\isa_mrs_projekat_front\\src\\components\\Administrator\\AdminPage\\components\\AdminMainViews\\AdminUsersView.vue"],"sourcesContent":["<template>\r\n  <div class=\"row\">\r\n    <div class=\"col-1\"></div>\r\n    <div class=\"col-10 pt-5 mb-5\">\r\n      <div class=\"container-fluid pe-0 ps-0 me-0 ms-0\">\r\n        <div class=\"align-items-center\">\r\n          <div class=\"row main-col\">\r\n            <div class=\"col d-flex justify-content-end pe-0 me-0\">\r\n              <button v-if=\"hasChanged\" class=\"btn btn-red my-auto mb-1 me-1\" data-bs-toggle=\"modal\" data-bs-target=\"#confirmationDialog\">\r\n                Save Changes\r\n              </button>\r\n              <div class=\"modal fade\" id=\"confirmationDialog\" tabindex=\"-1\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\r\n                <div class=\"modal-dialog\">\r\n                  <div class=\"modal-content\">\r\n                    <div class=\"modal-header\">\r\n                      <h5 class=\"modal-title\" id=\"exampleModalLabel\">Users' Status Change</h5>\r\n                      <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n                    </div>\r\n                    <div class=\"modal-body\">\r\n                      {{modalMessage}}\r\n                    </div>\r\n                    <div class=\"modal-footer\">\r\n                      <button type=\"button\" class=\"btn btn-red\" style=\"margin-right: 2vh;\" data-bs-dismiss=\"modal\">No</button>\r\n                      <button type=\"button\" class=\"btn\" @click=\"saveChanges\" data-bs-dismiss=\"modal\">Yes</button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <router-link to=\"/admin/newUser\" class=\"btn btn-default mb-1 d-flex my-auto\">\r\n                <font-awesome-icon class=\"my-auto pe-2\" icon=\"user-plus\"></font-awesome-icon>\r\n                Create User\r\n              </router-link>\r\n            </div>\r\n          </div>\r\n          <div class=\"row main-col text-center header rounded mb-3\">\r\n            <table>\r\n              <thead>\r\n                <tr>\r\n                  <th></th>\r\n                  <th>Name</th>\r\n                  <th>User Type</th>\r\n                  <th></th>\r\n                  <th>Active</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                <tr v-for=\"(user, index) in this.users\" :key=\"index\" :class=\"index%2!==0?'odd':'even'\">\r\n                  <td>\r\n                    <img v-if=\"user.photo !== null\" :src=\"imageUrls[index]\" style=\"height: calc(3vh + 10px);width: calc(3vh + 10px); object-fit: cover; object-position: center;\" class=\"img-fluid rounded-circle p-0\" alt=\"\">\r\n                    <font-awesome-icon v-else icon=\"user\" class=\"rounded-circle\" style=\"width: 3vh; height: 3vh\"></font-awesome-icon>\r\n                  </td>\r\n                  <td>\r\n                    <router-link class=\"profile-link\" :to=\"'/admin/user/' + user.id\">{{user.name + \" \" + user.surname}}</router-link>\r\n                  </td>\r\n                  <td>\r\n                    {{this.userRole(user)}}\r\n                  </td>\r\n                  <td>\r\n                    <button :id=\"index\" class=\"eye-btn border-0 text-decoration-none\" type=\"button\" data-bs-toggle=\"modal\" :data-bs-target=\"'#profileModal' + index\">\r\n                      <font-awesome-icon class=\"text-decoration-underline\" icon=\"eye\"></font-awesome-icon>\r\n                    </button>\r\n                    <div class=\"modal fade\" :id=\"'profileModal' + index\" tabindex=\"-1\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\r\n                      <div class=\"modal-dialog modal-dialog-centered modal-dialog-scrollable\">\r\n                        <div class=\"modal-content\">\r\n                          <div class=\"modal-header\">\r\n                            <h5 class=\"modal-title\">User Profile</h5>\r\n                            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n                          </div>\r\n                          <div class=\"modal-body\">\r\n                            <div class=\"row justify-content-center\">\r\n                              <div class=\"row\">\r\n                                <div class=\"col me-lg-3 me-md-2\">\r\n                                  <div class=\"row text-center\">\r\n                                    <img v-if=\"user.photo !== null\" :src=\"imageUrls[index]\" class=\"img-fluid rounded p-0\" alt=\"\">\r\n                                    <font-awesome-icon v-else icon=\"user\" class=\"img-fluid rounded p-0\" style=\"background-color: #B0B8B4FF; color: white\"></font-awesome-icon>\r\n                                  </div>\r\n                                </div>\r\n                                <div class=\"col\">\r\n                                  <div class=\"row text-center\">\r\n                                    <div class=\"container-fluid rounded\" style=\"border: 1px solid #008970; color: #008970\" >\r\n                                      <h5>{{user.name + \" \" + user.surname}}</h5>\r\n                                      <hr>\r\n                                      <div class=\"row pb-5\">\r\n                                        <div class=\"col text-start\">\r\n                                          <h6>User Type: <span style=\"color: black\">{{userRole(user)}}</span></h6>\r\n                                          <h6>Activity:\r\n                                            <input v-if=\"(user.isActive && !userIsChanged(user.id)) || (!user.isActive && userIsChanged(user.id))\" class=\"form-check-input\" type=\"checkbox\" checked disabled>\r\n                                            <input v-else class=\"form-check-input\" type=\"checkbox\" disabled></h6>\r\n                                          <h6>Email: <span style=\"color: black\">{{user.email}}</span></h6>\r\n                                          <h6>Phone: <span style=\"color: black\">{{user.phone}}</span></h6>\r\n                                          <h6>Address: <span style=\"color: black\">{{user.address.street + \" \" + (user.address.number?user.address.number:\"\") + \", \" + user.address.city + \", \" + user.address.country}}</span></h6>\r\n                                        </div>\r\n                                      </div>\r\n                                    </div>\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </td>\r\n                  <td>\r\n                    <input class=\"form-check-input\" type=\"checkbox\" :value=\"!user.isActive\" v-model=\"user.isActive\" :disabled=\"!user.isDeletable\" @change=\"changedStatus(user)\">\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n            <nav aria-label=\"Page navigation\">\r\n              <ul class=\"pagination justify-content-center mt-3\">\r\n                <li class=\"page-item\" v-if=\"totalPages > 1\"><button class=\"page-link\" :disabled=\"currentPage===0\" @click=\"previousPage\">Previous</button></li>\r\n                <li class=\"page-item mt-auto me-1 ms-1\" v-if=\"currentPage > 1 && totalPages > 3\">...</li>\r\n                <li class=\"page-item\"><button class=\"page-link\" :disabled=\"currentPage === 0\" @click=\"numberedPage(1)\">{{button1Content}}</button></li>\r\n                <li class=\"page-item\" v-if=\"totalPages > 1\"><button class=\"page-link\" :disabled=\"currentPage !== 0 && totalPages - currentPage > 1\" @click=\"numberedPage(2)\">{{button2Content}}</button></li>\r\n                <li class=\"page-item\" v-if=\"totalPages > 2\"><button class=\"page-link\" :disabled=\"totalPages - currentPage === 1\" @click=\"numberedPage(3)\">{{button3Content}}</button></li>\r\n                <li class=\"page-item mt-auto me-1 ms-1\" v-if=\"totalPages - currentPage > 1 && totalPages > 3 && button3Content !== totalPages\">...</li>\r\n                <li class=\"page-item\" v-if=\"totalPages > 1\"><button class=\"page-link\" :disabled=\"totalPages - currentPage === 1\" @click=\"nextPage\">Next</button></li>\r\n              </ul>\r\n            </nav>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    <div class=\"col-1\"></div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {FontAwesomeIcon} from \"@fortawesome/vue-fontawesome\";\r\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\r\nimport { faUserPlus, faEye } from \"@fortawesome/free-solid-svg-icons\";\r\nimport {useStore} from \"vuex\";\r\nimport axios from \"axios\";\r\nimport store from \"@/store\";\r\nimport {toggleLoading, toggleProcessing} from \"@/components/state\";\r\n\r\nlibrary.add(faUserPlus, faEye);\r\n\r\nexport default {\r\n  name: \"AdminUsersView\",\r\n  components: {FontAwesomeIcon},\r\n  data() {\r\n    return {\r\n      users: [],\r\n      selectedUser: null,\r\n      selectedUsersRole: null,\r\n      changedUsers: [],\r\n      imageUrls: [],\r\n      currentPage: 0,\r\n      totalPages: null,\r\n      pageSize: 10\r\n    }\r\n  },\r\n  methods: {\r\n    loadImage(name, index) {\r\n      axios.get(\"/Photos/\", {headers: {\r\n          Authorization: \"Bearer \" + this.$store.getters.access_token,\r\n        },\r\n        params: {\r\n          path: name,\r\n        },\r\n        responseType: \"blob\"\r\n      })\r\n          .then(response => {\r\n            this.imageUrls[index] = URL.createObjectURL(response.data);\r\n          })\r\n          .catch((error) =>{\r\n            console.log(error);\r\n          });\r\n    },\r\n    saveChanges() {\r\n      toggleProcessing();\r\n      let ids = this.changedUsersIds;\r\n      let lwc = {list: ids};\r\n      axios.put(\"/Users/multipleUserStatusChange\",\r\n          lwc,\r\n          {headers: {\r\n          Authorization: \"Bearer \" + store.state.access_token,\r\n        }\r\n      })\r\n      .then((response) => {\r\n        let message = \"You have successfully changed status for users:\";\r\n        response.data.forEach((user) => {message += \" \" + user.name + \" \" + user.surname + \",\"});\r\n        message = message.slice(0, -1);\r\n        message += \".\";\r\n        this.$notify({\r\n          title: \"Status Change Successful\",\r\n          text: message,\r\n          type: \"success\"\r\n        });\r\n        this.changedUsers = [];\r\n        toggleProcessing();\r\n      })\r\n      .catch(() =>{\r\n        this.$notify({\r\n          title: \"Server error\",\r\n          text: \"Something went wrong. Please try again later...\",\r\n          type: \"error\"\r\n        });\r\n        toggleProcessing();\r\n      })\r\n    },\r\n    changedStatus(user) {\r\n      let index = this.changedUsers.findIndex(element => element.id === user.id);\r\n      if (index > -1) {\r\n        this.changedUsers.splice(index, 1);\r\n      } else {\r\n        this.changedUsers.push(user);\r\n      }\r\n    },\r\n    userRole(user) {\r\n      if (user.userType === \"Instructor\") {\r\n        return \"Fishing Instructor\";\r\n      } else if (user.userType === \"VacationRentalOwner\") {\r\n        return \"House Owner\";\r\n      } else if (user.userType === \"BoatOwner\") {\r\n        return \"Boat Owner\";\r\n      } else if (user.userType === \"SuperAdmin\") {\r\n        return \"Supreme Admin\";\r\n      } else {\r\n        return user.userType;\r\n      }\r\n    },\r\n    userIsChanged(userId) {\r\n      let index = this.changedUsers.findIndex(element => element.id === userId);\r\n      return index > -1;\r\n    },\r\n    nextPage() {\r\n      this.currentPage += 1;\r\n      this.refreshPage();\r\n    },\r\n    previousPage() {\r\n      this.currentPage -= 1;\r\n      this.refreshPage();\r\n    },\r\n    numberedPage(buttonNumber) {\r\n      if (buttonNumber === 1) {\r\n        this.currentPage = this.button1Content - 1;\r\n      } else if (buttonNumber === 2) {\r\n        this.currentPage = this.button2Content - 1;\r\n      } else if (buttonNumber === 3) {\r\n        this.currentPage = this.button3Content - 1;\r\n      }\r\n      this.refreshPage();\r\n    },\r\n    refreshPage() {\r\n      toggleLoading();\r\n      axios.get(\"/Users/getUsersPage\", {headers: {\r\n          Authorization: \"Bearer \" + this.$store.getters.access_token,\r\n        },\r\n        params: {\r\n          page: this.currentPage,\r\n          pageSize: this.pageSize\r\n        }\r\n      })\r\n          .then(response => {\r\n            this.users = response.data.content;\r\n            this.changedUsers.forEach(user =>\r\n            { this.users.forEach( user1 =>\r\n              { if (user.id === user1.id && user.isActive !== user1.isActive) {\r\n                user1.isActive = user.isActive;\r\n                }\r\n              });\r\n            });\r\n            this.currentPage = response.data.currentPage;\r\n            this.totalPages = response.data.pages;\r\n            toggleLoading();\r\n          })\r\n          .catch(() =>{\r\n            this.$notify({\r\n              title: \"Server error\",\r\n              text: \"Server is currently off. Please try again later...\",\r\n              type: \"error\"\r\n            });\r\n            toggleLoading();\r\n          });\r\n    }\r\n  },\r\n  mounted() {\r\n    toggleLoading();\r\n    const store = useStore();\r\n    axios.get(\"/Users/getUsersPage\", {headers: {\r\n        Authorization: \"Bearer \" + store.state.access_token,\r\n        },\r\n        params: {\r\n          page: this.currentPage,\r\n          pageSize: this.pageSize\r\n        }\r\n      })\r\n    .then(response => {\r\n      this.users = response.data.content;\r\n      this.currentPage = response.data.currentPage;\r\n      this.totalPages = response.data.pages;\r\n      this.users.forEach(user => {\r\n        if (user.photo) {\r\n          const index = this.users.indexOf(user);\r\n          this.loadImage(user.photo, index);\r\n        }\r\n      });\r\n      toggleLoading();\r\n    })\r\n    .catch(() =>{\r\n      this.$notify({\r\n        title: \"Server error\",\r\n        text: \"Server is currently off. Please try again later...\",\r\n        type: \"error\"\r\n      });\r\n      toggleLoading();\r\n    });\r\n  },\r\n  computed: {\r\n    button1Content() {\r\n      return this.currentPage === 0 ? this.currentPage+1: this.totalPages - this.currentPage === 1 ? this.currentPage - 1 : this.currentPage;\r\n    },\r\n    button2Content() {\r\n      return this.currentPage === 0 ? this.currentPage+2: this.totalPages - this.currentPage === 1 ? this.currentPage : this.currentPage+1;\r\n    },\r\n    button3Content() {\r\n      return this.currentPage === 0 ? this.currentPage+3: this.totalPages - this.currentPage === 1 ? this.currentPage + 1 : this.currentPage+2;\r\n    },\r\n    isSuperAdmin() {\r\n      return store.state.isSuperAdmin;\r\n    },\r\n    hasChanged() {\r\n      return this.changedUsers.length > 0;\r\n    },\r\n    changedUsersIds() {\r\n      let ids = [];\r\n      this.changedUsers.forEach(user => {ids.push(user.id)});\r\n      return ids;\r\n    },\r\n    modalMessage() {\r\n      let numberOfDeletedUsers = this.numberOfDeletedUsers;\r\n      let numberOfActivatedUsers = this.numberOfActivatedUsers;\r\n      let deleteMessage = \"\";\r\n      let activateMessage = \"\";\r\n      if (numberOfDeletedUsers > 1) {\r\n        deleteMessage = \"Do you want to delete users:\";\r\n      } else if (numberOfDeletedUsers === 1) {\r\n        deleteMessage = \"Do you want to delete user:\";\r\n      }\r\n      if (numberOfActivatedUsers > 1) {\r\n        activateMessage = \"Do you want to activate users:\";\r\n      } else if (numberOfActivatedUsers === 1) {\r\n        activateMessage = \"Do you want to activate user:\";\r\n      }\r\n      this.changedUsers.forEach(user => {\r\n        if (!user.isActive) {\r\n          deleteMessage += \" \" + user.name + \" \" + user.surname + \",\\n\";\r\n        } else {\r\n          activateMessage += \" \" + user.name + \" \" + user.surname + \",\\n\";\r\n        }\r\n      });\r\n      if (numberOfDeletedUsers > 0) {\r\n        deleteMessage = deleteMessage.slice(0, -2);\r\n        deleteMessage += \"?\";\r\n      }\r\n      if (numberOfActivatedUsers > 0) {\r\n        activateMessage = activateMessage.slice(0, -2);\r\n        activateMessage += \"?\";\r\n      }\r\n      return deleteMessage + \"\\n\" + activateMessage;\r\n    },\r\n    numberOfDeletedUsers() {\r\n      let counter = 0;\r\n      this.changedUsers.forEach(user => {\r\n        if (!user.isActive) {\r\n          counter += 1;\r\n        }\r\n      });\r\n      return counter;\r\n    },\r\n    numberOfActivatedUsers() {\r\n      let counter = 0;\r\n      this.changedUsers.forEach(user => {\r\n        if (user.isActive) {\r\n          counter += 1;\r\n        }\r\n      });\r\n      return counter;\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.rounded-circle {\r\n  background-color:  rgba(176, 184, 180);\r\n  color: white;\r\n  padding: 10px;\r\n}\r\n\r\n.profile-link {\r\n  color: #008970;\r\n}\r\n\r\n.modal-title {\r\n  color: #008970;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}