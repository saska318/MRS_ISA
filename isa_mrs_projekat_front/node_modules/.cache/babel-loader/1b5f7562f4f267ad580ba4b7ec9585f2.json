{"ast":null,"code":"import axios from \"axios\";\nimport store from \"@/store\";\nexport default {\n  name: \"ClientSubscription\",\n  props: [\"subscriptions\"],\n\n  data() {\n    return {\n      images: [],\n      isSubscriptionCancelled: [],\n      btnText: \"Cancel Subscription\"\n    };\n  },\n\n  computed: {\n    getAccessToken() {\n      return store.state.access_token;\n    }\n\n  },\n  methods: {\n    cancelSubscription(i, subscription) {\n      axios.post(\"/RentalObjects/cancelSubscription\", {\n        rentalId: subscription.id\n      }, {\n        headers: {\n          Authorization: \"Bearer \" + this.getAccessToken\n        }\n      }).then(() => {\n        this.isSubscriptionCancelled[i] = true;\n      }).catch(error => {\n        if (error.response.status === 404) {\n          this.$notify({\n            title: \"Invalid Status\",\n            text: \"Something went wrong. Try again later.\",\n            position: \"bottom right\",\n            type: \"warn\"\n          });\n        } else if (error.response.status === 500) {\n          this.$notify({\n            title: \"Internal Server Error\",\n            text: \"Something went wrong on the server! Please try again later...\",\n            position: \"bottom right\",\n            type: \"error\"\n          });\n        }\n      });\n    },\n\n    setRentalIdAndType(subscription) {\n      this.$store.dispatch(\"rentalId\", subscription.id);\n      this.$store.dispatch(\"rentalType\", subscription.rentalObjectType);\n    },\n\n    getPath(subscription) {\n      return \"/client/RentalProfile/\" + subscription.rentalObjectType + \"-\" + subscription.id;\n    }\n\n  },\n\n  mounted() {\n    for (let i = 0; i < this.subscriptions.length; i++) {\n      this.isSubscriptionCancelled[i] = false;\n\n      if (!this.subscriptions[i].photos[0].photo) {\n        this.images[i] = null;\n        continue;\n      }\n\n      axios.get(\"/Photos/\", {\n        headers: {\n          Authorization: \"Bearer \" + this.$store.getters.access_token\n        },\n        params: {\n          path: this.subscriptions[i].photos[0].photo\n        },\n        responseType: \"blob\"\n      }).then(response => {\n        this.images[i] = URL.createObjectURL(response.data);\n      }).catch(error => {\n        console.log(error);\n      });\n    }\n  }\n\n};","map":{"version":3,"mappings":"AA0BA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AAEA,eAAe;AACbC,MAAI,EAAE,oBADO;AAEbC,OAAK,EAAE,CAAC,eAAD,CAFM;;AAGbC,MAAI,GAAG;AACL,WAAO;AACLC,YAAM,EAAE,EADH;AAELC,6BAAuB,EAAE,EAFpB;AAGLC,aAAO,EAAE;AAHJ,KAAP;AAKD,GATY;;AAUbC,UAAQ,EAAE;AACRC,kBAAc,GAAG;AACf,aAAOR,KAAK,CAACS,KAAN,CAAYC,YAAnB;AACD;;AAHO,GAVG;AAebC,SAAO,EAAE;AACPC,sBAAkB,CAACC,CAAD,EAAIC,YAAJ,EAAkB;AAClCf,WAAK,CAACgB,IAAN,CAAW,mCAAX,EAAgD;AAAEC,gBAAQ,EAAEF,YAAY,CAACG;AAAzB,OAAhD,EAA+E;AAC7EC,eAAO,EAAE;AACPC,uBAAa,EAAE,YAAY,KAAKX;AADzB;AADoE,OAA/E,EAKCY,IALD,CAKM,MAAM;AACV,aAAKf,uBAAL,CAA6BQ,CAA7B,IAAkC,IAAlC;AACD,OAPD,EAQCQ,KARD,CAQOC,KAAI,IAAK;AACd,YAAIA,KAAK,CAACC,QAAN,CAAeC,MAAf,KAA0B,GAA9B,EAAmC;AACjC,eAAKC,OAAL,CAAa;AACXC,iBAAK,EAAE,gBADI;AAEXC,gBAAI,EAAE,wCAFK;AAGXC,oBAAQ,EAAE,cAHC;AAIXC,gBAAI,EAAE;AAJK,WAAb;AAMF,SAPA,MAOO,IAAIP,KAAK,CAACC,QAAN,CAAeC,MAAf,KAA0B,GAA9B,EAAmC;AACxC,eAAKC,OAAL,CAAa;AACXC,iBAAK,EAAE,uBADI;AAEXC,gBAAI,EAAE,+DAFK;AAGXC,oBAAQ,EAAE,cAHC;AAIXC,gBAAI,EAAE;AAJK,WAAb;AAMF;AACD,OAxBD;AA0BD,KA5BM;;AA6BPC,sBAAkB,CAAChB,YAAD,EAAe;AAC/B,WAAKiB,MAAL,CAAYC,QAAZ,CAAqB,UAArB,EAAiClB,YAAY,CAACG,EAA9C;AACA,WAAKc,MAAL,CAAYC,QAAZ,CAAqB,YAArB,EAAmClB,YAAY,CAACmB,gBAAhD;AACD,KAhCM;;AAiCPC,WAAO,CAACpB,YAAD,EAAe;AACpB,aAAO,2BAA2BA,YAAY,CAACmB,gBAAxC,GAA2D,GAA3D,GACDnB,YAAY,CAACG,EADnB;AAED;;AApCM,GAfI;;AAsDbkB,SAAO,GAAG;AACR,SAAK,IAAItB,CAAC,GAAC,CAAX,EAAcA,IAAI,KAAKuB,aAAL,CAAmBC,MAArC,EAA6CxB,CAAC,EAA9C,EAAkD;AAChD,WAAKR,uBAAL,CAA6BQ,CAA7B,IAAkC,KAAlC;;AACA,UAAG,CAAC,KAAKuB,aAAL,CAAmBvB,CAAnB,EAAsByB,MAAtB,CAA6B,CAA7B,EAAgCC,KAApC,EAA2C;AAAE,aAAKnC,MAAL,CAAYS,CAAZ,IAAiB,IAAjB;AAAuB;AAAU;;AAC9Ed,WAAK,CAACyC,GAAN,CAAU,UAAV,EAAsB;AACpBtB,eAAO,EAAE;AACPC,uBAAa,EAAE,YAAY,KAAKY,MAAL,CAAYU,OAAZ,CAAoB/B;AADxC,SADW;AAIpBgC,cAAM,EAAE;AACNC,cAAI,EAAE,KAAKP,aAAL,CAAmBvB,CAAnB,EAAsByB,MAAtB,CAA6B,CAA7B,EAAgCC;AADhC,SAJY;AAOpBK,oBAAY,EAAE;AAPM,OAAtB,EASKxB,IATL,CASUG,QAAO,IAAK;AAChB,aAAKnB,MAAL,CAAYS,CAAZ,IAAiBgC,GAAG,CAACC,eAAJ,CAAoBvB,QAAQ,CAACpB,IAA7B,CAAjB;AACD,OAXL,EAYKkB,KAZL,CAYYC,KAAD,IAAW;AAChByB,eAAO,CAACC,GAAR,CAAY1B,KAAZ;AACD,OAdL;AAeF;AACD;;AA1EY,CAAf","names":["axios","store","name","props","data","images","isSubscriptionCancelled","btnText","computed","getAccessToken","state","access_token","methods","cancelSubscription","i","subscription","post","rentalId","id","headers","Authorization","then","catch","error","response","status","$notify","title","text","position","type","setRentalIdAndType","$store","dispatch","rentalObjectType","getPath","mounted","subscriptions","length","photos","photo","get","getters","params","path","responseType","URL","createObjectURL","console","log"],"sourceRoot":"","sources":["C:\\Users\\Sa≈°ka\\Downloads\\MRS_ISA\\isa_mrs_projekat_front\\src\\components\\Client\\ClientPage\\components\\ClientProfile\\ClientSubscriptions\\ClientSubscription.vue"],"sourcesContent":["<template>\r\n  <div v-for=\"(subscription, i) in subscriptions\" :key=\"i\" class=\"card col-xl-6 col-lg-6 col-md-6 col-sm-10 col-xs-12 px-3 mb-5\">\r\n    <router-link :to=\"getPath(subscription)\" class=\"link\" @click=\"setRentalIdAndType\">\r\n\r\n      <img v-if=\"subscription.photos[0].photo\" class=\"card-img-top\" alt=\"\" :src=\"images[i]\"/>\r\n    </router-link>\r\n    <div class=\"card-body pt-1 pb-0\">\r\n      <div class=\"align-items-center text-start\" style=\"display: flex;\">\r\n        <div>\r\n          <h1 class=\"card-title cut-text\">{{ subscription.name }}</h1>\r\n        </div>\r\n        <hr class=\"ms-1\">\r\n      </div>\r\n      <div class=\"row d-flex m-0 p-0 justify-content-center\">\r\n        <button :id=\"subscription.id\" :disabled=\"isSubscriptionCancelled[i]\"\r\n                @click=\"cancelSubscription(i, subscription)\"\r\n                class=\"btn m-0 py-1\" :class=\"[isSubscriptionCancelled[i] ? 'cancelled' : 'cancel']\">\r\n          {{ isSubscriptionCancelled[i] ? \"Cancelled\" : this.btnText }}\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport store from \"@/store\";\r\n\r\nexport default {\r\n  name: \"ClientSubscription\",\r\n  props: [\"subscriptions\"],\r\n  data() {\r\n    return {\r\n      images: [],\r\n      isSubscriptionCancelled: [],\r\n      btnText: \"Cancel Subscription\",\r\n    }\r\n  },\r\n  computed: {\r\n    getAccessToken() {\r\n      return store.state.access_token;\r\n    },\r\n  },\r\n  methods: {\r\n    cancelSubscription(i, subscription) {\r\n      axios.post(\"/RentalObjects/cancelSubscription\", { rentalId: subscription.id }, {\r\n        headers: {\r\n          Authorization: \"Bearer \" + this.getAccessToken,\r\n        },\r\n      })\r\n      .then(() => {\r\n        this.isSubscriptionCancelled[i] = true;\r\n      })\r\n      .catch(error => {\r\n        if (error.response.status === 404) {\r\n          this.$notify({\r\n            title: \"Invalid Status\",\r\n            text: \"Something went wrong. Try again later.\",\r\n            position: \"bottom right\",\r\n            type: \"warn\"\r\n          })\r\n        } else if (error.response.status === 500) {\r\n          this.$notify({\r\n            title: \"Internal Server Error\",\r\n            text: \"Something went wrong on the server! Please try again later...\",\r\n            position: \"bottom right\",\r\n            type: \"error\"\r\n          })\r\n        }\r\n      })\r\n\r\n    },\r\n    setRentalIdAndType(subscription) {\r\n      this.$store.dispatch(\"rentalId\", subscription.id);\r\n      this.$store.dispatch(\"rentalType\", subscription.rentalObjectType);\r\n    },\r\n    getPath(subscription) {\r\n      return \"/client/RentalProfile/\" + subscription.rentalObjectType + \"-\"\r\n          + subscription.id;\r\n    },\r\n\r\n  },\r\n  mounted() {\r\n    for (let i=0; i < this.subscriptions.length; i++) {\r\n      this.isSubscriptionCancelled[i] = false;\r\n      if(!this.subscriptions[i].photos[0].photo) { this.images[i] = null; continue; }\r\n      axios.get(\"/Photos/\", {\r\n        headers: {\r\n          Authorization: \"Bearer \" + this.$store.getters.access_token,\r\n        },\r\n        params: {\r\n          path: this.subscriptions[i].photos[0].photo,\r\n        },\r\n        responseType: \"blob\"\r\n      })\r\n          .then(response => {\r\n            this.images[i] = URL.createObjectURL(response.data);\r\n          })\r\n          .catch((error) => {\r\n            console.log(error);\r\n          });\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\nbutton.cancel {\r\n  background-color: #e23c52;\r\n  border: 1px solid #e23c52;\r\n  color: white;\r\n  font-weight: 500;\r\n  border-radius: 40px;\r\n  width: 60%;\r\n}\r\n\r\nbutton.cancelled {\r\n  background-color: lightgray;\r\n  border: 1px solid darkgray;\r\n  color: darkgray;\r\n  font-weight: 500;\r\n  border-radius: 40px;\r\n  width: 60%;\r\n}\r\n/*button.cancel:disabled, button.cancel[disabled] {*/\r\n/*  background-color:lightgray;*/\r\n/*  border: 2px solid darkgray;*/\r\n/*  color: darkgray;*/\r\n/*}*/\r\n.cut-text {\r\n  width: 100%;\r\n  display: -webkit-box;\r\n  -webkit-line-clamp: 1;\r\n  -webkit-box-orient: vertical;\r\n  overflow: hidden;\r\n}\r\ndiv.card img {\r\n  height: 25vh;\r\n  object-fit: cover;\r\n  object-position: center;\r\n  border-top-left-radius: 40px;\r\n  border-top-right-radius: 40px;\r\n  /*border: 1px solid black;*/\r\n  /*border-bottom: none;*/\r\n}\r\n\r\na {\r\n  text-decoration: none;\r\n  color: black;\r\n}\r\n\r\nhr {\r\n  flex-grow: 1;\r\n}\r\n\r\ndiv.card {\r\n  border: none;\r\n}\r\n\r\ndiv.card-body {\r\n  border: 1px solid black;\r\n  border-bottom-left-radius: 40px;\r\n  border-bottom-right-radius: 40px;\r\n  box-shadow: 0 0.3rem 1rem rgb(0 0 0 / 15%);\r\n}\r\n\r\n.card-img-top {\r\n  box-shadow: -0.05em 0 1rem rgb(0 0 0 / 15%);\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}