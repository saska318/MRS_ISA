{"ast":null,"code":"import axios from \"axios\";\nimport { FontAwesomeIcon } from \"@fortawesome/vue-fontawesome\";\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\nimport { faAngleDoubleLeft, faAngleDoubleRight, faAngleLeft, faAngleRight, faFrown, faPlus } from \"@fortawesome/free-solid-svg-icons\";\nimport { useStore } from \"vuex\";\nimport { toggleLoading, toggleProcessing } from \"@/components/state\";\nlibrary.add(faAngleRight, faAngleLeft, faFrown, faAngleDoubleRight, faAngleDoubleLeft, faPlus);\nexport default {\n  name: \"AllBoatsView\",\n  components: {\n    FontAwesomeIcon\n  },\n\n  data() {\n    return {\n      boats: [],\n      totalPages: null,\n      currentPage: 0,\n      pageSize: 10,\n      imageUrls: [],\n      changedRentals: []\n    };\n  },\n\n  mounted() {\n    toggleLoading();\n    const store = useStore();\n    axios.get(\"/RentalObjects/getBoatsOwner\", {\n      headers: {\n        Authorization: \"Bearer \" + store.state.access_token\n      },\n      params: {\n        page: this.currentPage,\n        pageSize: this.pageSize,\n        field: \"name\"\n      }\n    }).then(response => {\n      this.boats = response.data.content;\n      this.currentPage = response.data.currentPage;\n      this.totalPages = response.data.pages;\n      this.boats.forEach(rentalObject => {\n        if (rentalObject.photos.length > 0) {\n          const index = this.boats.indexOf(rentalObject);\n          this.loadImage(rentalObject.photos[0].photo, index);\n        }\n      });\n      toggleLoading();\n    }).catch(() => {\n      this.$notify({\n        title: \"Server error\",\n        text: \"Something went wrong. Please try again later...\",\n        type: \"error\"\n      });\n    });\n  },\n\n  methods: {\n    saveChanges() {\n      toggleProcessing();\n      let ids = this.changedRentalsIds;\n      let lwc = {\n        list: ids\n      };\n      axios.put(\"/RentalObjects/multipleRentalsStatusChange\", lwc, {\n        headers: {\n          Authorization: \"Bearer \" + this.$store.state.access_token\n        }\n      }).then(response => {\n        let message = \"You have successfully changed status for rental objects:\";\n        response.data.forEach(rentalObject => {\n          message += \" \" + rentalObject.name + \",\";\n        });\n        message = message.slice(0, -1);\n        message += \".\";\n        this.$notify({\n          title: \"Status Change Successful\",\n          text: message,\n          type: \"success\"\n        });\n        this.changedRentals = [];\n        toggleProcessing();\n      }).catch(() => {\n        this.$notify({\n          title: \"Server error\",\n          text: \"Something went wrong. Please try again later...\",\n          type: \"error\"\n        });\n        toggleProcessing();\n      });\n    },\n\n    changeStatus(rentalObject) {\n      let index = this.changedRentals.findIndex(element => element.id === rentalObject.id);\n\n      if (index > -1) {\n        this.changedRentals.splice(index, 1);\n      } else {\n        this.changedRentals.push(rentalObject);\n      }\n    },\n\n    previousPage() {\n      this.currentPage -= 1;\n      this.refreshPage();\n    },\n\n    nextPage() {\n      this.currentPage += 1;\n      this.refreshPage();\n    },\n\n    numberedPage(buttonNumber) {\n      if (buttonNumber === 1) {\n        this.currentPage = this.button1Content - 1;\n      } else if (buttonNumber === 2) {\n        this.currentPage = this.button2Content - 1;\n      } else if (buttonNumber === 3) {\n        this.currentPage = this.button3Content - 1;\n      }\n\n      this.refreshPage();\n    },\n\n    refreshPage() {\n      axios.get(\"/RentalObjects/getBoatsOwner\", {\n        headers: {\n          Authorization: \"Bearer \" + this.$store.getters.access_token\n        },\n        params: {\n          page: this.currentPage,\n          pageSize: this.pageSize,\n          field: \"name\"\n        }\n      }).then(response => {\n        this.boats = response.data.content;\n        this.currentPage = response.data.currentPage;\n        this.totalPages = response.data.pages;\n        this.boats.forEach(rentalObject => {\n          if (rentalObject.photos.length > 0) {\n            const index = this.boats.indexOf(rentalObject);\n            this.loadImage(rentalObject.photos[0].photo, index);\n          }\n        });\n        toggleProcessing();\n      }).catch(() => {\n        this.$notify({\n          title: \"Server error\",\n          text: \"Server is currently off. Please try again later...\",\n          type: \"error\"\n        });\n        toggleProcessing();\n      });\n    },\n\n    loadImage(name, index) {\n      axios.get(\"/Photos/\", {\n        headers: {\n          Authorization: \"Bearer \" + this.$store.getters.access_token\n        },\n        params: {\n          path: name\n        },\n        responseType: \"blob\"\n      }).then(response => {\n        this.imageUrls[index] = URL.createObjectURL(response.data);\n      }).catch(error => {\n        console.log(error);\n      });\n    },\n\n    rulesOfConduct(rulesOfConduct) {\n      let pairsOfRules = [];\n      let positiveRules = this.positiveRules(rulesOfConduct);\n      let negativeRules = this.negativeRules(rulesOfConduct);\n      let size = Math.max(positiveRules.length, negativeRules.length);\n\n      for (let i = 0; i < size; i++) {\n        pairsOfRules.push({\n          \"Do\": i + 1 <= positiveRules.length ? positiveRules[i] : \"\",\n          \"DoNot\": i + 1 <= negativeRules.length ? negativeRules[i] : \"\"\n        });\n      }\n\n      return pairsOfRules;\n    },\n\n    positiveRules(rulesOfConduct) {\n      let positiveRules = [];\n      rulesOfConduct.forEach(rule => {\n        if (rule.type === \"Do\") {\n          positiveRules.push(rule.rule);\n        }\n      });\n      return positiveRules;\n    },\n\n    negativeRules(rulesOfConduct) {\n      let negativeRules = [];\n      rulesOfConduct.forEach(rule => {\n        if (rule.type === \"DoNot\") {\n          negativeRules.push(rule.rule);\n        }\n      });\n      return negativeRules;\n    },\n\n    equipment(equipment) {\n      let result = \"\";\n      equipment.forEach(element => {\n        result += \" \" + element.name + \",\";\n      });\n      result = result.slice(0, -1);\n      return result;\n    }\n\n  },\n  computed: {\n    changedRentalsIds() {\n      let ids = [];\n      this.changedRentals.forEach(rentalObject => {\n        ids.push(rentalObject.id);\n      });\n      return ids;\n    },\n\n    hasChanged() {\n      return this.changedRentals.length > 0;\n    },\n\n    button1Content() {\n      return this.currentPage === 0 ? this.currentPage + 1 : this.totalPages - this.currentPage === 1 ? this.currentPage - 1 : this.currentPage;\n    },\n\n    button2Content() {\n      return this.currentPage === 0 ? this.currentPage + 2 : this.totalPages - this.currentPage === 1 ? this.currentPage : this.currentPage + 1;\n    },\n\n    button3Content() {\n      return this.currentPage === 0 ? this.currentPage + 3 : this.totalPages - this.currentPage === 1 ? this.currentPage + 1 : this.currentPage + 2;\n    },\n\n    modalMessage() {\n      let numberOfDeletedRentals = this.numberOfDeletedRentals;\n      let numberOfActivatedRentals = this.numberOfActivatedRentals;\n      let deleteMessage = \"\";\n      let activateMessage = \"\";\n\n      if (numberOfDeletedRentals > 1) {\n        deleteMessage = \"Do you want to delete boats:\";\n      } else if (numberOfDeletedRentals === 1) {\n        deleteMessage = \"Do you want to delete boat:\";\n      }\n\n      if (numberOfActivatedRentals > 1) {\n        activateMessage = \"Do you want to activate boats:\";\n      } else if (numberOfActivatedRentals === 1) {\n        activateMessage = \"Do you want to activate boat:\";\n      }\n\n      this.changedRentals.forEach(rentalObject => {\n        if (!rentalObject.isActive) {\n          deleteMessage += \" \" + rentalObject.name + \",\\n\";\n        } else {\n          activateMessage += \" \" + rentalObject.name + \",\\n\";\n        }\n      });\n\n      if (numberOfDeletedRentals > 0) {\n        deleteMessage = deleteMessage.slice(0, -2);\n        deleteMessage += \"?\";\n      }\n\n      if (numberOfActivatedRentals > 0) {\n        activateMessage = activateMessage.slice(0, -2);\n        activateMessage += \"?\";\n      }\n\n      return deleteMessage + \"\\n\" + activateMessage;\n    },\n\n    numberOfDeletedRentals() {\n      let counter = 0;\n      this.changedRentals.forEach(rentalObject => {\n        if (!rentalObject.isActive) {\n          counter += 1;\n        }\n      });\n      return counter;\n    },\n\n    numberOfActivatedRentals() {\n      let counter = 0;\n      this.changedRentals.forEach(rentalObject => {\n        if (rentalObject.isActive) {\n          counter += 1;\n        }\n      });\n      return counter;\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["axios","FontAwesomeIcon","library","faAngleDoubleLeft","faAngleDoubleRight","faAngleLeft","faAngleRight","faFrown","faPlus","useStore","toggleLoading","toggleProcessing","add","name","components","data","boats","totalPages","currentPage","pageSize","imageUrls","changedRentals","mounted","store","get","headers","Authorization","state","access_token","params","page","field","then","response","content","pages","forEach","rentalObject","photos","length","index","indexOf","loadImage","photo","catch","$notify","title","text","type","methods","saveChanges","ids","changedRentalsIds","lwc","list","put","$store","message","slice","changeStatus","findIndex","element","id","splice","push","previousPage","refreshPage","nextPage","numberedPage","buttonNumber","button1Content","button2Content","button3Content","getters","path","responseType","URL","createObjectURL","error","console","log","rulesOfConduct","pairsOfRules","positiveRules","negativeRules","size","Math","max","i","rule","equipment","result","computed","hasChanged","modalMessage","numberOfDeletedRentals","numberOfActivatedRentals","deleteMessage","activateMessage","isActive","counter"],"sourceRoot":"","sources":["C:\\Users\\Saška\\Downloads\\MRS_ISA\\isa_mrs_projekat_front\\src\\components\\BoatOwner\\BoatOwnerPage\\components\\AllBoatsView\\AllBoatsView.vue"],"sourcesContent":["<template>\r\n  <div class=\"row\">\r\n    <div class=\"col-1\"></div>\r\n    <div class=\"col-10 pt-5 mb-5\">\r\n      <div class=\"container-fluid pe-0 ps-0 me-0 ms-0\">\r\n        <div class=\"align-items-center\">\r\n          <div class=\"row main-col\">\r\n            <div class=\"col d-flex justify-content-start ps-0 ms-0 me-0 pe-0\">\r\n              <div class=\"col mb-1\">\r\n                <div class=\"d-flex flex-row justify-content-end\">\r\n                  <button v-if=\"hasChanged\" class=\"btn btn-red mb-1 me-1\" data-bs-toggle=\"modal\" data-bs-target=\"#confirmationDialog\">\r\n                    Save Changes\r\n                  </button>\r\n                </div>\r\n                <div class=\"modal fade\" id=\"confirmationDialog\" tabindex=\"-1\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\r\n                  <div class=\"modal-dialog\">\r\n                    <div class=\"modal-content\">\r\n                      <div class=\"modal-header\">\r\n                        <h5 class=\"modal-title\" id=\"exampleModalLabel\">Rental Objects' Status Change</h5>\r\n                        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n                      </div>\r\n                      <div class=\"modal-body\">\r\n                        {{modalMessage}}\r\n                      </div>\r\n                      <div class=\"modal-footer\">\r\n                        <button type=\"button\" class=\"btn btn-red\" style=\"margin-right: 2vh;\" data-bs-dismiss=\"modal\">No</button>\r\n                        <button type=\"button\" class=\"btn\" @click=\"saveChanges\" data-bs-dismiss=\"modal\">Yes</button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <router-link to=\"/boatOwner/newBoat\" class=\"btn btn-default mb-1 d-flex my-auto\">\r\n                <font-awesome-icon class=\"my-auto pe-2\" icon=\"plus\"></font-awesome-icon>\r\n                Create new\r\n              </router-link>\r\n            </div>\r\n          </div>\r\n          <div class=\"row main-col text-center header rounded mb-3\">\r\n            <div class=\"card\" v-for=\"(rentalObject, index) in this.boats\" :key=\"index\" style=\"width:275px; margin: 0.5%; border-color: #008970\">\r\n              <img v-if=\"rentalObject.photos.length !== 0\" :src=\"imageUrls[index]\" style=\"width:100%\" class=\"img-fluid rounded border-1\" alt=\"\">\r\n              <div class=\"card-body\">\r\n                <router-link to=\"#\" style=\"color: #008970\">\r\n                  <h4 class=\"card-title\">{{ rentalObject.name }}</h4>\r\n                  <hr class=\"ms-1\">\r\n                </router-link>\r\n                <div class=\"row\">\r\n                  <h5>\r\n                    <font-awesome-icon class=\"my-auto\" icon=\"location-dot\"></font-awesome-icon>:\r\n                    {{rentalObject.address.city + \", \" + rentalObject.address.country}}\r\n                  </h5>\r\n                  <h5>\r\n                    <font-awesome-icon class=\"my-auto\" icon=\"dollar-sign\"></font-awesome-icon>:\r\n                    {{rentalObject.price + \"$\"}}\r\n                  </h5>\r\n                  <h5>\r\n                    Active: <input class=\"form-check-input\" type=\"checkbox\" :value=\"!rentalObject.isActive\" v-model=\"rentalObject.isActive\" @change=\"changeStatus(rentalObject)\" :disabled=\"!rentalObject.isDeletable\">\r\n                  </h5>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <nav aria-label=\"Page navigation\">\r\n              <ul class=\"pagination justify-content-center mt-3\">\r\n                <li class=\"page-item\" v-if=\"totalPages > 1\"><button class=\"page-link\" :disabled=\"currentPage===0\" @click=\"previousPage\">Previous</button></li>\r\n                <li class=\"page-item mt-auto me-1 ms-1\" v-if=\"currentPage > 1 && totalPages > 3\">...</li>\r\n                <li class=\"page-item\"><button class=\"page-link\" :disabled=\"currentPage === 0\" @click=\"numberedPage(1)\">{{button1Content}}</button></li>\r\n                <li class=\"page-item\" v-if=\"totalPages > 1\"><button class=\"page-link\" :disabled=\"currentPage !== 0 && totalPages - currentPage > 1\" @click=\"numberedPage(2)\">{{button2Content}}</button></li>\r\n                <li class=\"page-item\" v-if=\"totalPages > 2\"><button class=\"page-link\" :disabled=\"totalPages - currentPage === 1\" @click=\"numberedPage(3)\">{{button3Content}}</button></li>\r\n                <li class=\"page-item mt-auto me-1 ms-1\" v-if=\"totalPages - currentPage > 1 && totalPages > 3 && button3Content !== totalPages\">...</li>\r\n                <li class=\"page-item\" v-if=\"totalPages > 1\"><button class=\"page-link\" :disabled=\"totalPages - currentPage === 1\" @click=\"nextPage\">Next</button></li>\r\n              </ul>\r\n            </nav>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"col-1\"></div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport axios from \"axios\";\r\nimport {FontAwesomeIcon} from \"@fortawesome/vue-fontawesome\";\r\nimport {library} from \"@fortawesome/fontawesome-svg-core\";\r\nimport {faAngleDoubleLeft, faAngleDoubleRight, faAngleLeft, faAngleRight, faFrown, faPlus}\r\n  from \"@fortawesome/free-solid-svg-icons\";\r\nimport {useStore} from \"vuex\";\r\nimport {toggleLoading, toggleProcessing} from \"@/components/state\";\r\n\r\nlibrary.add(faAngleRight, faAngleLeft, faFrown, faAngleDoubleRight, faAngleDoubleLeft, faPlus);\r\n\r\nexport default {\r\n  name: \"AllBoatsView\",\r\n  components: {\r\n    FontAwesomeIcon\r\n  },\r\n  data() {\r\n    return {\r\n      boats: [],\r\n      totalPages: null,\r\n      currentPage: 0,\r\n      pageSize: 10,\r\n      imageUrls: [],\r\n      changedRentals: []\r\n    }\r\n  },\r\n  mounted() {\r\n    toggleLoading();\r\n    const store = useStore();\r\n    axios.get(\"/RentalObjects/getBoatsOwner\", {headers: {\r\n        Authorization: \"Bearer \" + store.state.access_token,\r\n      },\r\n      params: {\r\n        page: this.currentPage,\r\n        pageSize: this.pageSize,\r\n        field: \"name\",\r\n      }},\r\n    ).then(response => {\r\n      this.boats = response.data.content;\r\n      this.currentPage = response.data.currentPage;\r\n      this.totalPages = response.data.pages;\r\n      this.boats.forEach(rentalObject => {\r\n        if(rentalObject.photos.length > 0){\r\n          const index = this.boats.indexOf(rentalObject);\r\n          this.loadImage(rentalObject.photos[0].photo, index);\r\n        }\r\n      });\r\n      toggleLoading();\r\n    })\r\n        .catch(() =>{\r\n          this.$notify({\r\n            title: \"Server error\",\r\n            text: \"Something went wrong. Please try again later...\",\r\n            type: \"error\"\r\n          });\r\n        })\r\n  },\r\n  methods: {\r\n    saveChanges() {\r\n      toggleProcessing();\r\n      let ids = this.changedRentalsIds;\r\n      let lwc = {list: ids};\r\n      axios.put(\"/RentalObjects/multipleRentalsStatusChange\",\r\n          lwc,\r\n          {headers: {\r\n              Authorization: \"Bearer \" + this.$store.state.access_token,\r\n            }\r\n          })\r\n          .then((response) => {\r\n            let message = \"You have successfully changed status for rental objects:\";\r\n            response.data.forEach((rentalObject) => {message += \" \" + rentalObject.name + \",\"});\r\n            message = message.slice(0, -1);\r\n            message += \".\";\r\n            this.$notify({\r\n              title: \"Status Change Successful\",\r\n              text: message,\r\n              type: \"success\"\r\n            });\r\n            this.changedRentals = [];\r\n            toggleProcessing();\r\n          })\r\n          .catch(() =>{\r\n            this.$notify({\r\n              title: \"Server error\",\r\n              text: \"Something went wrong. Please try again later...\",\r\n              type: \"error\"\r\n            });\r\n            toggleProcessing();\r\n          })\r\n    },\r\n    changeStatus(rentalObject) {\r\n      let index = this.changedRentals.findIndex(element => element.id === rentalObject.id);\r\n      if (index > -1) {\r\n        this.changedRentals.splice(index, 1);\r\n      } else {\r\n        this.changedRentals.push(rentalObject);\r\n      }\r\n    },\r\n    previousPage() {\r\n      this.currentPage -= 1;\r\n      this.refreshPage();\r\n    },\r\n    nextPage() {\r\n      this.currentPage += 1;\r\n      this.refreshPage();\r\n    },\r\n    numberedPage(buttonNumber) {\r\n      if (buttonNumber === 1) {\r\n        this.currentPage = this.button1Content - 1;\r\n      } else if (buttonNumber === 2) {\r\n        this.currentPage = this.button2Content - 1;\r\n      } else if (buttonNumber === 3) {\r\n        this.currentPage = this.button3Content - 1;\r\n      }\r\n      this.refreshPage();\r\n    },\r\n    refreshPage() {\r\n      axios.get(\"/RentalObjects/getBoatsOwner\", {headers: {\r\n          Authorization: \"Bearer \" + this.$store.getters.access_token,\r\n        },\r\n        params: {\r\n          page: this.currentPage,\r\n          pageSize: this.pageSize,\r\n          field: \"name\"\r\n        }\r\n      })\r\n          .then(response => {\r\n            this.boats = response.data.content;\r\n            this.currentPage = response.data.currentPage;\r\n            this.totalPages = response.data.pages;\r\n            this.boats.forEach(rentalObject => {\r\n              if (rentalObject.photos.length > 0) {\r\n                const index = this.boats.indexOf(rentalObject);\r\n                this.loadImage(rentalObject.photos[0].photo, index);\r\n              }\r\n            });\r\n            toggleProcessing();\r\n          })\r\n          .catch(() =>{\r\n            this.$notify({\r\n              title: \"Server error\",\r\n              text: \"Server is currently off. Please try again later...\",\r\n              type: \"error\"\r\n            });\r\n            toggleProcessing();\r\n          });\r\n    },\r\n    loadImage(name, index) {\r\n      axios.get(\"/Photos/\", {headers: {\r\n          Authorization: \"Bearer \" + this.$store.getters.access_token,\r\n        },\r\n        params: {\r\n          path: name,\r\n        },\r\n        responseType: \"blob\"\r\n      })\r\n          .then(response => {\r\n            this.imageUrls[index] = URL.createObjectURL(response.data);\r\n          })\r\n          .catch((error) =>{\r\n            console.log(error);\r\n          });\r\n    },\r\n    rulesOfConduct(rulesOfConduct) {\r\n      let pairsOfRules = [];\r\n      let positiveRules = this.positiveRules(rulesOfConduct);\r\n      let negativeRules = this.negativeRules(rulesOfConduct);\r\n      let size = Math.max(positiveRules.length, negativeRules.length);\r\n      for (let i = 0; i < size; i++) {\r\n        pairsOfRules.push({\r\n          \"Do\": i+1<=positiveRules.length?positiveRules[i]:\"\",\r\n          \"DoNot\": i+1<=negativeRules.length?negativeRules[i]:\"\"\r\n        });\r\n      }\r\n      return pairsOfRules;\r\n    },\r\n    positiveRules(rulesOfConduct) {\r\n      let positiveRules = [];\r\n      rulesOfConduct.forEach(rule => {\r\n        if (rule.type === \"Do\") {\r\n          positiveRules.push(rule.rule);\r\n        }\r\n      });\r\n      return positiveRules;\r\n    },\r\n    negativeRules(rulesOfConduct) {\r\n      let negativeRules = [];\r\n      rulesOfConduct.forEach(rule => {\r\n        if (rule.type === \"DoNot\") {\r\n          negativeRules.push(rule.rule);\r\n        }\r\n      });\r\n      return negativeRules;\r\n    },\r\n    equipment(equipment) {\r\n      let result = \"\";\r\n      equipment.forEach(element => {\r\n        result += \" \" + element.name + \",\";\r\n      })\r\n      result = result.slice(0, -1);\r\n      return result;\r\n    }\r\n  },\r\n  computed: {\r\n    changedRentalsIds() {\r\n      let ids = [];\r\n      this.changedRentals.forEach(rentalObject => {ids.push(rentalObject.id)});\r\n      return ids;\r\n    },\r\n    hasChanged() {\r\n      return this.changedRentals.length > 0;\r\n    },\r\n    button1Content() {\r\n      return this.currentPage === 0 ? this.currentPage+1: this.totalPages - this.currentPage === 1 ? this.currentPage - 1 : this.currentPage;\r\n    },\r\n    button2Content() {\r\n      return this.currentPage === 0 ? this.currentPage+2: this.totalPages - this.currentPage === 1 ? this.currentPage : this.currentPage+1;\r\n    },\r\n    button3Content() {\r\n      return this.currentPage === 0 ? this.currentPage+3: this.totalPages - this.currentPage === 1 ? this.currentPage + 1 : this.currentPage+2;\r\n    },\r\n    modalMessage() {\r\n      let numberOfDeletedRentals = this.numberOfDeletedRentals;\r\n      let numberOfActivatedRentals = this.numberOfActivatedRentals;\r\n      let deleteMessage = \"\";\r\n      let activateMessage = \"\";\r\n      if (numberOfDeletedRentals > 1) {\r\n        deleteMessage = \"Do you want to delete boats:\";\r\n      } else if (numberOfDeletedRentals === 1) {\r\n        deleteMessage = \"Do you want to delete boat:\";\r\n      }\r\n      if (numberOfActivatedRentals > 1) {\r\n        activateMessage = \"Do you want to activate boats:\";\r\n      } else if (numberOfActivatedRentals === 1) {\r\n        activateMessage = \"Do you want to activate boat:\";\r\n      }\r\n      this.changedRentals.forEach(rentalObject => {\r\n        if (!rentalObject.isActive) {\r\n          deleteMessage += \" \" + rentalObject.name + \",\\n\";\r\n        } else {\r\n          activateMessage += \" \" + rentalObject.name + \",\\n\";\r\n        }\r\n      });\r\n      if (numberOfDeletedRentals > 0) {\r\n        deleteMessage = deleteMessage.slice(0, -2);\r\n        deleteMessage += \"?\";\r\n      }\r\n      if (numberOfActivatedRentals > 0) {\r\n        activateMessage = activateMessage.slice(0, -2);\r\n        activateMessage += \"?\";\r\n      }\r\n      return deleteMessage + \"\\n\" + activateMessage;\r\n    },\r\n    numberOfDeletedRentals() {\r\n      let counter = 0;\r\n      this.changedRentals.forEach(rentalObject => {\r\n        if (!rentalObject.isActive) {\r\n          counter += 1;\r\n        }\r\n      });\r\n      return counter;\r\n    },\r\n    numberOfActivatedRentals() {\r\n      let counter = 0;\r\n      this.changedRentals.forEach(rentalObject => {\r\n        if (rentalObject.isActive) {\r\n          counter += 1;\r\n        }\r\n      });\r\n      return counter;\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\ndiv.card {\r\n  border-radius: 20px;\r\n  box-shadow:  0 0.3rem 1rem rgb(0 0 0 / 30%);\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}