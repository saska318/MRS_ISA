{"ast":null,"code":"import { FontAwesomeIcon } from \"@fortawesome/vue-fontawesome\";\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\nimport { faPercent, faClock, faUser } from \"@fortawesome/free-solid-svg-icons\";\nimport axios from \"axios\";\nlibrary.add(faPercent, faClock, faUser);\nexport default {\n  name: \"RentalSpecialOffers\",\n  props: [\"specialOffers\", \"rentalType\", \"price\", \"clientCantReserve\", \"isOwner\", \"isVacationRentalOwner\", \"isBoatOwner\"],\n  components: {\n    FontAwesomeIcon\n  },\n\n  data() {\n    return {\n      bookBtn: \"Book\",\n      sortedServices: []\n    };\n  },\n\n  mounted() {\n    this.sortedServices = this.specialOffers;\n    this.sortedServices = this.sortedServices.sort((a, b) => new Date(b.initDate) < new Date(a.initDate) ? 1 : -1);\n  },\n\n  computed: {\n    rentalHasSpecialOffers() {\n      return this.specialOffers.length > 0;\n    }\n\n  },\n  methods: {\n    book(offer) {\n      let offerId = offer.id;\n      let total = this.getOfferPrice(offer);\n      console.log(offerId);\n      console.log(total);\n      axios.post(\"/Reservations/bookSpecialOffer\", {\n        offerId: offerId,\n        total: total\n      }, {\n        headers: {\n          Authorization: \"Bearer \" + this.$store.getters.access_token\n        }\n      }).then(() => {\n        let button = document.getElementById(\"button-\" + offerId);\n        button.disabled = true;\n        button.textContent = \"Booked!\";\n      }).catch(error => {\n        if (error.response.status === 404) {\n          this.$notify({\n            title: \"Invalid Status\",\n            text: \"Something went wrong. Try again later.\",\n            position: \"bottom right\",\n            type: \"warn\"\n          });\n        } else if (error.response.status === 500) {\n          this.$notify({\n            title: \"Internal Server Error\",\n            text: \"Something went wrong on the server! Please try again later...\",\n            position: \"bottom right\",\n            type: \"error\"\n          });\n        }\n      });\n    },\n\n    getOfferPrice(offer) {\n      let days = this.getNumberOfDays(offer);\n      return this.price * days / 100 * (100 - offer.discount);\n    },\n\n    getNumberOfDays(offer) {\n      let initDate = offer.initDate,\n          termDate = offer.termDate;\n      let date1 = new Date(initDate),\n          date2 = new Date(termDate);\n      date1.setHours(0, 0, 0);\n      date2.setHours(0, 0, 0);\n      let timeDiff = date2.getTime() - date1.getTime();\n      let daysDiff = timeDiff / (1000 * 3600 * 24);\n      return daysDiff + 1;\n    },\n\n    offerHasServices(offer) {\n      return offer.includedServices.length > 0;\n    },\n\n    getDateSpan(offer) {\n      let initDate = offer.initDate,\n          termDate = offer.termDate;\n      let date1 = new Date(initDate),\n          date2 = new Date(termDate); // date1.setHours(0, 0, 0);\n      // date2.setHours(0, 0, 0);\n\n      let dateDisplay = date1.getDate() + '.' + (date1.getMonth() + 1) + '.' + date1.getFullYear() + '.';\n      if (this.rentalType === \"Adventure\") dateDisplay += \"  from \" + date1.getHours() + \":\" + (date1.getMinutes() < 10 ? '0' : '') + date1.getMinutes() + \" to \" + date2.getHours() + \":\" + (date2.getMinutes() < 10 ? '0' : '') + date2.getMinutes();else {\n        if (date1.getFullYear() !== date2.getFullYear() || date1.getMonth() !== date2.getMonth() || date1.getDate() !== date2.getDate()) dateDisplay += ' - ' + date2.getDate() + '.' + (date2.getMonth() + 1) + '.' + date2.getFullYear() + '.';\n      }\n      return dateDisplay;\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["FontAwesomeIcon","library","faPercent","faClock","faUser","axios","add","name","props","components","data","bookBtn","sortedServices","mounted","specialOffers","sort","a","b","Date","initDate","computed","rentalHasSpecialOffers","length","methods","book","offer","offerId","id","total","getOfferPrice","console","log","post","headers","Authorization","$store","getters","access_token","then","button","document","getElementById","disabled","textContent","catch","error","response","status","$notify","title","text","position","type","days","getNumberOfDays","price","discount","termDate","date1","date2","setHours","timeDiff","getTime","daysDiff","offerHasServices","includedServices","getDateSpan","dateDisplay","getDate","getMonth","getFullYear","rentalType","getHours","getMinutes"],"sourceRoot":"","sources":["C:\\Users\\Saška\\Downloads\\ISA_MRS\\isa_mrs_projekat_front\\src\\components\\UnregisteredUser\\components\\Rental\\RentalSpecialOffers.vue"],"sourcesContent":["<template>\r\n  <div class=\"row main\">\r\n    <div class=\"accordion accordion-flush\" id=\"accordionFlushExample\">\r\n      <div class=\"accordion-item\">\r\n        <h2 class=\"accordion-header\" id=\"flush-headingThree\" style=\"border: 1px solid black;\">\r\n          <button class=\"accordion-button collapsed\" type=\"button\" data-bs-toggle=\"collapse\"\r\n                  data-bs-target=\"#flush-collapseThree\" aria-expanded=\"false\" aria-controls=\"flush-collapseThree\">\r\n            <p class=\"h3\"><strong>Special Offers</strong></p>\r\n          </button>\r\n        </h2>\r\n        <div id=\"flush-collapseThree\" class=\"accordion-collapse collapse show\" aria-labelledby=\"flush-headingThree\">\r\n          <div class=\"accordion-body p-2 pb-1\">\r\n\r\n            <div v-if=\"rentalHasSpecialOffers\" class=\"specialOffers\">\r\n              <div v-for=\"(offer, i) in sortedServices\" :key=\"i\" class=\"offer p-3 mb-1\">\r\n                <div class=\"offer-header p-0 m-0\">\r\n                  <div class=\"row text-center\">\r\n                    <p class=\"h4\">\r\n                      <font-awesome-icon class=\"me-2\" icon=\"percent\"></font-awesome-icon>\r\n                      Action\r\n                    </p>\r\n                  </div>\r\n                  <hr>\r\n                  <div class=\"row\">\r\n                    <div class=\"col-6\">\r\n                      <div class=\"row\">\r\n                        <p class=\"h6\">\r\n                          <font-awesome-icon class=\"me-2\" icon=\"clock\"></font-awesome-icon>\r\n                          Time:&emsp;{{ getDateSpan(offer) }}\r\n                        </p>\r\n                      </div>\r\n                      <div class=\"row\">\r\n                        <p class=\"h6\">\r\n                          <font-awesome-icon class=\"me-2\" icon=\"percent\"></font-awesome-icon>\r\n                          Discount:&emsp;{{ offer.discount }}%\r\n                        </p>\r\n                      </div>\r\n                      <div class=\"row\">\r\n                        <p class=\"h6\">\r\n                          <font-awesome-icon class=\"me-2\" icon=\"user\"></font-awesome-icon>\r\n                          Capacity:&emsp;{{ offer.capacity }}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <div class=\"col-6 ps-4\">\r\n                      <div v-if=\"offerHasServices(offer)\" class=\"row\">\r\n                        <p class=\"h6\">\r\n                          <strong><u>Services:</u></strong>\r\n                        </p>\r\n                        <p class=\"h6\" v-for=\"(service, i) in offer.includedServices\" :key=\"i\">\r\n                          ◆ {{ service.name }}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <hr>\r\n                  <div class=\"row\">\r\n                    <p class=\"h4\">\r\n                      Total:&emsp;${{ (getOfferPrice(offer)).toFixed(2) }}\r\n                    </p>\r\n                  </div>\r\n                  <div class=\"row mt-3 d-flex justify-content-center align-items-center\">\r\n                    <button v-if=\"!isOwner && !isVacationRentalOwner || !isBoatOwner\" :id=\"'button-'+offer.id\" :disabled=\"clientCantReserve\" class=\"btn mb-2\"\r\n                            style=\"font-weight: 500; color: white; width: 80%\" @click=\"book(offer)\">\r\n                      Book\r\n                    </button>\r\n                    <button v-else :id=\"'button-'+offer.id\" class=\"btn mb-2\"\r\n                            style=\"font-weight: 500; color: white; width: 80%; background-color: #e23c52\">\r\n                      Delete\r\n                    </button>\r\n                  </div>\r\n\r\n                </div>\r\n                <div class=\"offer-body\" style=\"text-align: justify; color: black;\">\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div v-else class=\"text-center\">\r\n              <label><i>No special offers available.</i></label>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {FontAwesomeIcon} from \"@fortawesome/vue-fontawesome\";\r\nimport {library} from \"@fortawesome/fontawesome-svg-core\";\r\nimport { faPercent, faClock, faUser } from \"@fortawesome/free-solid-svg-icons\";\r\nimport axios from \"axios\";\r\n\r\nlibrary.add(faPercent, faClock, faUser);\r\n\r\n\r\nexport default {\r\n  name: \"RentalSpecialOffers\",\r\n  props: [\"specialOffers\", \"rentalType\", \"price\", \"clientCantReserve\", \"isOwner\", \"isVacationRentalOwner\", \"isBoatOwner\"],\r\n  components: {FontAwesomeIcon},\r\n  data() {\r\n    return {\r\n      bookBtn: \"Book\",\r\n      sortedServices: [],\r\n    }\r\n  },\r\n  mounted() {\r\n    this.sortedServices = this.specialOffers;\r\n    this.sortedServices = this.sortedServices.sort((a, b) => new Date(b.initDate) < new Date(a.initDate) ? 1: -1);\r\n  },\r\n  computed: {\r\n    rentalHasSpecialOffers() {\r\n      return this.specialOffers.length > 0;\r\n    },\r\n  },\r\n  methods: {\r\n    book(offer) {\r\n      let offerId = offer.id;\r\n      let total = this.getOfferPrice(offer);\r\n      console.log(offerId);\r\n      console.log(total);\r\n      axios.post(\"/Reservations/bookSpecialOffer\", { offerId: offerId, total: total }, {\r\n        headers: {\r\n          Authorization: \"Bearer \" + this.$store.getters.access_token\r\n        },\r\n      })\r\n          .then(() => {\r\n            let button = document.getElementById(\"button-\"+offerId);\r\n            button.disabled = true;\r\n            button.textContent = \"Booked!\";\r\n          })\r\n          .catch(error => {\r\n            if (error.response.status === 404) {\r\n              this.$notify({\r\n                title: \"Invalid Status\",\r\n                text: \"Something went wrong. Try again later.\",\r\n                position: \"bottom right\",\r\n                type: \"warn\"\r\n              })\r\n            } else if (error.response.status === 500) {\r\n              this.$notify({\r\n                title: \"Internal Server Error\",\r\n                text: \"Something went wrong on the server! Please try again later...\",\r\n                position: \"bottom right\",\r\n                type: \"error\"\r\n              })\r\n            }\r\n          })\r\n    },\r\n    getOfferPrice(offer) {\r\n      let days = this.getNumberOfDays(offer);\r\n      return (this.price * days)/100 * (100 - offer.discount);\r\n    },\r\n    getNumberOfDays(offer) {\r\n      let initDate = offer.initDate, termDate = offer.termDate;\r\n      let date1 = new Date(initDate), date2 = new Date(termDate);\r\n      date1.setHours(0, 0, 0);\r\n      date2.setHours(0, 0, 0);\r\n      let timeDiff = date2.getTime() - date1.getTime();\r\n      let daysDiff = timeDiff / (1000 * 3600 * 24);\r\n      return daysDiff + 1;\r\n    },\r\n    offerHasServices(offer) {\r\n      return offer.includedServices.length > 0;\r\n    },\r\n    getDateSpan(offer) {\r\n      let initDate = offer.initDate, termDate = offer.termDate;\r\n      let date1 = new Date(initDate), date2 = new Date(termDate);\r\n      // date1.setHours(0, 0, 0);\r\n      // date2.setHours(0, 0, 0);\r\n      let dateDisplay = date1.getDate() + '.' + (date1.getMonth() + 1) + '.' +  date1.getFullYear() + '.';\r\n      if(this.rentalType === \"Adventure\")\r\n        dateDisplay += \"  from \" + date1.getHours() + \":\" + (date1.getMinutes()<10?'0':'') + date1.getMinutes() + \" to \" + date2.getHours() + \":\" + (date2.getMinutes()<10?'0':'') + date2.getMinutes();\r\n      else {\r\n        if(date1.getFullYear() !== date2.getFullYear() || date1.getMonth() !== date2.getMonth() || date1.getDate() !== date2.getDate())\r\n          dateDisplay += ' - ' + date2.getDate() + '.' + (date2.getMonth() + 1) + '.' +  date2.getFullYear() + '.';\r\n      }\r\n      return dateDisplay;\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\ndiv.accordion-body {\r\n  max-height: 70vh;\r\n  overflow-y: auto;\r\n  background-color: lightgray;\r\n  border-bottom: 1px solid lightgrey;\r\n}\r\n\r\n.accordion-button:not(.collapsed) {\r\n  color: #008970;\r\n  background-color: #f7f7f2;\r\n}\r\n\r\ndiv.offer {\r\n  border-radius: 40px;\r\n  border: 2px solid darkgray;\r\n}\r\n\r\ndiv.offer:hover {\r\n  background-color:#008970;\r\n  color: white;\r\n}\r\n\r\ndiv.offer:hover button {\r\n  background-color: black;\r\n  color: white;\r\n}\r\n\r\ndiv.offer button:disabled {\r\n  background-color: darkgray;\r\n  color: black;\r\n}\r\n\r\ndiv.offer {\r\n  background-color: white\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}